;
; File generated by cc65 v 2.13.2
;
	.fopt		compiler,"cc65 v 2.13.2"
	.setcpu		"6502"
	.smart		on
	.autoimport	on
	.case		on
	.debuginfo	off
	.importzp	sp, sreg, regsave, regbank, tmp1, ptr1, ptr2
	.macpack	longbranch
	.forceimport	__STARTUP__
	.import		_pal_bg
	.import		_pal_spr
	.import		_pal_bright
	.import		_ppu_off
	.import		_ppu_on_all
	.import		_ppu_mask
	.import		_ppu_system
	.import		_oam_clear
	.import		_oam_spr
	.import		_oam_meta_spr
	.import		_oam_hide_rest
	.import		_ppu_waitnmi
	.import		_music_play
	.import		_music_stop
	.import		_music_pause
	.import		_sfx_play
	.import		_pad_poll
	.import		_scroll
	.import		_bank_spr
	.import		_bank_bg
	.import		_rand8
	.import		_set_vram_update
	.import		_vram_adr
	.import		_vram_put
	.import		_vram_fill
	.import		_vram_write
	.import		_memfill
	.import		_delay
	.export		_bitmasks
	.export		_monococo_state_times
	.export		_chac_chacs_times
	.export		_chac_chacs_t1
	.export		_chac_chacs_t2
	.export		_chac_chacs_t3
	.export		_bits
	.export		_jitter
	.export		_palts0
	.export		_palss0
	.export		_behs0
	.export		_scr_0_00
	.export		_scr_0_01
	.export		_scr_0_02
	.export		_scr_0_03
	.export		_scr_0_04
	.export		_scr_0_05
	.export		_scr_0_06
	.export		_scr_0_07
	.export		_map_0
	.export		_map_0_locks
	.export		_enems_0
	.export		_hotspots_0
	.export		_sspl_00_a
	.export		_sspl_00_b
	.export		_sspl_01_a
	.export		_sspl_01_b
	.export		_sspl_02_a
	.export		_sspl_02_b
	.export		_sspl_03_a
	.export		_sspl_03_b
	.export		_sspl_04_a
	.export		_sspl_04_b
	.export		_sspl_05_a
	.export		_sspl_05_b
	.export		_sspl_06_a
	.export		_sspl_06_b
	.export		_ssen_00_a
	.export		_ssen_00_b
	.export		_ssen_01_a
	.export		_ssen_01_b
	.export		_ssen_02_a
	.export		_ssen_02_b
	.export		_ssen_03_a
	.export		_ssen_03_b
	.export		_ssen_04_a
	.export		_ssen_04_b
	.export		_ssen_05_a
	.export		_ssen_05_b
	.export		_ssplat_00
	.export		_ssplat_01
	.export		_ssfanty_00_a
	.export		_ssfanty_00_b
	.export		_ssfanty_01_a
	.export		_ssfanty_01_b
	.export		_sspezon_00
	.export		_sspezon_01
	.export		_sssaw_00
	.export		_sssaw_01
	.export		_ssexpl
	.export		_ssmono_00_a
	.export		_ssmono_00_b
	.export		_ssmono_01_a
	.export		_ssmono_01_b
	.export		_ssmono_02_a
	.export		_ssmono_02_b
	.export		_ssmono_03_a
	.export		_ssmono_03_b
	.export		_sseocc
	.export		_ssit_00
	.export		_ssit_01
	.export		_ssit_02
	.export		_ssobjs_00
	.export		_ssobjs_01
	.export		_ssobjs_02
	.export		_ts0_pals
	.export		_ts0_tmaps
	.export		_spr_player
	.export		_spr_enems0
	.export		_spr_hs
	.export		__x
	.export		__y
	.export		__n
	.export		__t
	.export		__z
	.export		_pad0
	.export		_pad_this_frame
	.export		_gpit
	.export		_gpjt
	.export		_gpitu
	.export		_gpaux
	.export		_rds16
	.export		_gpint
	.export		_gp_gen
	.export		_gp_tmap
	.export		_gp_tma2
	.export		_gp_ram
	.export		_gp_ram_aux
	.export		_gp_addr
	.export		_rdx
	.export		_rdy
	.export		_rdt
	.export		_rdit
	.export		_rda
	.export		_rdb
	.export		_rdc
	.export		_rdd
	.export		_rdm
	.export		_rde
	.export		_rds
	.export		_rdct
	.export		_ticker
	.export		_rdaa
	.export		_rdbb
	.export		_en_x_offs
	.export		_ast1
	.export		_at1
	.export		_at2
	.export		_cx1
	.export		_cx2
	.export		_cy1
	.export		_cy2
	.export		_caux
	.export		_oam_index
	.export		_en_initial
	.export		_en_offs
	.export		_en_fr
	.export		_en_collx
	.export		_en_colly
	.export		_en_spr
	.export		_touched
	.export		_en_is_alive
	.export		_pregotten
	.export		__en_t
	.export		__en_s
	.export		__en_x
	.export		__en_y
	.export		__en_x1
	.export		__en_y1
	.export		__en_x2
	.export		__en_y2
	.export		__en_mx
	.export		__en_my
	.export		__en_ct
	.export		__en_facing
	.export		__en_state
	.export		__enf_x
	.export		__enf_y
	.export		__enf_vx
	.export		__enf_vy
	.export		_en_sg_1
	.export		_en_sg_2
	.export		_vertical_engine_type
	.export		_px
	.export		_py
	.export		_pvx
	.export		_pvy
	.export		_prx
	.export		_pry
	.export		_pcx
	.export		_pcy
	.export		_pfacing
	.export		_pfr
	.export		_pctfr
	.export		_psprid
	.export		_a_button
	.export		_b_button
	.export		_pj
	.export		_pctj
	.export		_pgotten
	.export		_ppossee
	.export		_oppossee
	.export		_pflickering
	.export		_pbouncing
	.export		_phit
	.export		_pgtmx
	.export		_pgtmy
	.export		_pinv
	.export		_opinv
	.export		_hitv
	.export		_hith
	.export		_prx_old
	.export		_pry_old
	.export		_pkill
	.export		_pice
	.export		_pnotsafe
	.export		_pcontinues
	.export		_plife
	.export		_pkeys
	.export		_pobjs
	.export		_pammo
	.export		_pkilled
	.export		_pfiring
	.export		_n_pant_safe
	.export		_px_safe
	.export		_py_safe
	.export		_bi
	.export		__bx
	.export		__by
	.export		_bullets_disable
	.export		_coco_it
	.export		_hrx
	.export		_hry
	.export		_hrt
	.export		_do_process_breakable
	.export		_ft
	.export		_c_map_w
	.export		_c_map_h
	.export		_c_map_size
	.export		_c_ts_pals
	.export		_c_ts_tmaps
	.export		_c_behs
	.export		_spr_enems
	.export		_c_pal_bg
	.export		_c_pal_fg
	.export		_c_map
	.export		_c_locks
	.export		_c_enems
	.export		_c_hotspots
	.export		_c_max_bolts
	.export		_w_pant
	.export		_nametable_base
	.export		_buff_offset
	.export		_attr_table_offset
	.export		_buff_ptr
	.export		_attr_ptr
	.export		_scroll_x
	.export		_on_screen
	.export		_ntsc
	.export		_ntsc_frame
	.export		_update_index
	.export		_update_list
	.export		_attr_table
	.export		_fader
	.export		_fade_delay
	.export		_map_attr
	.export		_map_buff
	.export		_first_game
	.export		_level
	.export		_c_max_enems
	.export		_n_pant
	.export		_on_pant
	.export		_half_life
	.export		_frame_counter
	.export		_paused
	.export		_win_level
	.export		_game_over
	.export		_warp_to_level
	.export		_level_reset
	.export		_flick_override
	.export		_olife
	.export		_okeys
	.export		_oobjs
	.export		_oammo
	.export		_okilled
	.export		_oam_index_player
	.export		_b_slots
	.export		_b_slots_i
	.export		_bx
	.export		_b_cy1
	.export		_by
	.export		_bmx
	.export		_bmy
	.export		_coco_slots
	.export		_coco_slots_i
	.export		_coco_on
	.export		_coco_x
	.export		_coco_y
	.export		_coco_vx
	.export		_coco_vy
	.export		_brkf
	.export		_brkx
	.export		_brky
	.export		_pmayneedrelocation
	.export		_hyx
	.export		_ht
	.export		_hact
	.export		_d_hrx
	.export		_d_hry
	.export		_d_hrt
	.export		_lkact
	.export		_flags
	.export		_en_t
	.export		_en_x
	.export		_en_y
	.export		_en_x1
	.export		_en_y1
	.export		_en_x2
	.export		_en_y2
	.export		_en_mx
	.export		_en_my
	.export		_en_s
	.export		_en_facing
	.export		_en_state
	.export		_en_flags
	.export		_en_cttouched
	.export		_en_life
	.export		_en_status
	.export		_en_ct
	.export		_en_spr_x_mod
	.export		_enf_x
	.export		_enf_vx
	.export		_enf_y
	.export		_enf_vy
	.export		_en_spr_id
	.export		_cfx
	.export		_shaker_ct
	.export		_player_render
	.export		_fade_out
	.export		_fade_in
	.export		_clear_update_list
	.export		_cls
	.export		_ul_putc
	.export		_p_t
	.export		_upd_attr_table
	.export		_draw_tile
	.export		_update_list_tile
	.export		_map_set
	.export		_get_byte
	.export		_add_tile
	.export		_draw_half_scr
	.export		_draw_scr
	.export		_pr_str
	.export		_get_hex_digit
	.export		_debug_print_hex_16_dl
	.export		_cm_two_points
	.export		_collide
	.export		_add_sign
	.export		_saturate
	.export		_pad_read
	.export		_distance
	.export		_jump_start
	.export		_update_cycle
	.export		_calc_scroll_pos
	.export		_calc_en_x_absolute
	.export		_breakable_do_anim
	.export		_breakable_break
	.export		_hotspots_load
	.export		_hotspots_paint
	.export		_hotspots_create
	.export		_cocos_init
	.export		_cocos_shoot_aimed
	.export		_cocos_destroy
	.export		_cocos_do
	.export		_player_register_safe_spot
	.export		_player_stop
	.export		_player_init
	.export		_player_to_pixels
	.export		_player_kill
	.export		_player_process_tile
	.export		_fire_bullet
	.export		_bullets_destroy
	.export		_bullets_move
	.export		_player_move
	.export		_enems_draw_chac_chac
	.export		_enems_update_unsigned_char_arrays
	.export		_enems_facing
	.export		_enems_init_fp
	.export		_enems_boioiong_init
	.export		_enems_load
	.export		_enems_kill
	.export		_enems_hit
	.export		_enems_move
	.export		_draw_game_frame
	.export		_hud_update
	.export		_flickscreen_do_horizontal
	.export		_flickscreen_do_vertical
	.export		_game_init
	.export		_prepare_scr
	.export		_game_loop
	.export		_main

.segment	"DATA"

.segment	"ZEROPAGE"
.segment	"BSS"

.segment	"RODATA"

_bitmasks:
	.byte	$FC
	.byte	$F3
	.byte	$CF
	.byte	$3F
_monococo_state_times:
	.byte	$96
	.byte	$32
	.byte	$32
	.byte	$32
_chac_chacs_times:
	.byte	$00
	.byte	$10
	.byte	$01
	.byte	$32
	.byte	$01
	.byte	$01
_chac_chacs_t1:
	.byte	$16
	.byte	$10
	.byte	$12
	.byte	$15
	.byte	$12
	.byte	$10
_chac_chacs_t2:
	.byte	$16
	.byte	$16
	.byte	$16
	.byte	$14
	.byte	$16
	.byte	$16
_chac_chacs_t3:
	.byte	$16
	.byte	$11
	.byte	$13
	.byte	$15
	.byte	$13
	.byte	$11
_bits:
	.byte	$01
	.byte	$02
	.byte	$04
	.byte	$08
	.byte	$10
	.byte	$20
	.byte	$40
	.byte	$80
_jitter:
	.byte	$00
	.byte	$01
	.byte	$01
	.byte	$00
	.byte	$00
	.byte	$01
	.byte	$00
	.byte	$01
	.byte	$01
	.byte	$00
	.byte	$00
	.byte	$00
	.byte	$01
	.byte	$00
	.byte	$01
	.byte	$01
_palts0:
	.byte	$0F
	.byte	$0C
	.byte	$00
	.byte	$38
	.byte	$0F
	.byte	$18
	.byte	$17
	.byte	$27
	.byte	$0F
	.byte	$1C
	.byte	$21
	.byte	$37
	.byte	$0F
	.byte	$0C
	.byte	$15
	.byte	$27
_palss0:
	.byte	$0F
	.byte	$04
	.byte	$24
	.byte	$27
	.byte	$0F
	.byte	$06
	.byte	$1A
	.byte	$29
	.byte	$0F
	.byte	$15
	.byte	$24
	.byte	$3D
	.byte	$0F
	.byte	$1D
	.byte	$18
	.byte	$3D
_behs0:
	.byte	$00
	.byte	$08
	.byte	$08
	.byte	$01
	.byte	$44
	.byte	$02
	.byte	$04
	.byte	$18
	.byte	$09
	.byte	$28
	.byte	$29
	.byte	$01
	.byte	$08
	.byte	$08
	.byte	$0B
	.byte	$0A
	.byte	$00
	.byte	$00
	.byte	$01
	.byte	$01
	.byte	$01
	.byte	$01
	.byte	$00
_scr_0_00:
	.byte	$44
	.byte	$00
	.byte	$20
	.byte	$F0
	.byte	$20
	.byte	$00
	.byte	$0E
	.byte	$F0
	.byte	$20
	.byte	$00
	.byte	$0E
	.byte	$F0
	.byte	$20
	.byte	$F0
	.byte	$00
	.byte	$F0
	.byte	$AA
	.byte	$07
	.byte	$07
	.byte	$F1
	.byte	$21
	.byte	$02
	.byte	$00
	.byte	$0F
	.byte	$F0
	.byte	$20
	.byte	$F0
	.byte	$99
	.byte	$00
	.byte	$04
	.byte	$F0
	.byte	$10
	.byte	$00
	.byte	$06
	.byte	$F0
	.byte	$20
	.byte	$00
	.byte	$0E
	.byte	$F0
	.byte	$22
	.byte	$00
	.byte	$07
	.byte	$F0
	.byte	$44
	.byte	$00
	.byte	$05
	.byte	$F0
	.byte	$22
	.byte	$00
	.byte	$09
	.byte	$F0
	.byte	$10
	.byte	$F1
	.byte	$00
	.byte	$02
	.byte	$F0
	.byte	$22
	.byte	$F0
	.byte	$33
	.byte	$00
	.byte	$0B
	.byte	$02
	.byte	$05
	.byte	$04
	.byte	$05
	.byte	$02
	.byte	$04
	.byte	$F0
	.byte	$52
_scr_0_01:
	.byte	$48
	.byte	$00
	.byte	$0F
	.byte	$F0
	.byte	$10
	.byte	$00
	.byte	$0E
	.byte	$F0
	.byte	$10
	.byte	$00
	.byte	$06
	.byte	$F0
	.byte	$E0
	.byte	$00
	.byte	$06
	.byte	$F0
	.byte	$10
	.byte	$00
	.byte	$06
	.byte	$F0
	.byte	$E0
	.byte	$00
	.byte	$06
	.byte	$F0
	.byte	$10
	.byte	$00
	.byte	$06
	.byte	$F0
	.byte	$E0
	.byte	$00
	.byte	$06
	.byte	$F0
	.byte	$10
	.byte	$00
	.byte	$04
	.byte	$06
	.byte	$06
	.byte	$00
	.byte	$04
	.byte	$F0
	.byte	$10
	.byte	$00
	.byte	$0E
	.byte	$F0
	.byte	$10
	.byte	$00
	.byte	$0E
	.byte	$F0
	.byte	$10
	.byte	$00
	.byte	$0E
	.byte	$F0
	.byte	$10
	.byte	$F1
	.byte	$00
	.byte	$15
	.byte	$05
	.byte	$07
	.byte	$F0
	.byte	$10
	.byte	$F0
	.byte	$01
	.byte	$F1
	.byte	$00
	.byte	$01
	.byte	$05
	.byte	$08
	.byte	$F0
	.byte	$10
	.byte	$F0
	.byte	$0F
	.byte	$02
	.byte	$10
_scr_0_02:
	.byte	$41
	.byte	$F0
	.byte	$10
	.byte	$00
	.byte	$0E
	.byte	$F0
	.byte	$10
	.byte	$00
	.byte	$0E
	.byte	$F0
	.byte	$10
	.byte	$00
	.byte	$0E
	.byte	$F0
	.byte	$10
	.byte	$00
	.byte	$0E
	.byte	$F0
	.byte	$10
	.byte	$00
	.byte	$0E
	.byte	$F0
	.byte	$10
	.byte	$00
	.byte	$0E
	.byte	$F0
	.byte	$10
	.byte	$00
	.byte	$0E
	.byte	$01
	.byte	$04
	.byte	$07
	.byte	$07
	.byte	$00
	.byte	$05
	.byte	$F0
	.byte	$10
	.byte	$F0
	.byte	$00
	.byte	$07
	.byte	$07
	.byte	$00
	.byte	$05
	.byte	$F0
	.byte	$10
	.byte	$F0
	.byte	$00
	.byte	$07
	.byte	$07
	.byte	$F0
	.byte	$00
	.byte	$F1
	.byte	$22
	.byte	$20
	.byte	$F1
	.byte	$00
	.byte	$07
	.byte	$F1
	.byte	$77
	.byte	$07
	.byte	$F0
	.byte	$77
	.byte	$F0
	.byte	$00
	.byte	$02
	.byte	$13
_scr_0_03:
	.byte	$18
	.byte	$00
	.byte	$5F
	.byte	$F0
	.byte	$20
	.byte	$00
	.byte	$0E
	.byte	$F0
	.byte	$20
	.byte	$00
	.byte	$0E
	.byte	$F0
	.byte	$20
	.byte	$00
	.byte	$0E
	.byte	$F0
	.byte	$22
	.byte	$00
	.byte	$0D
	.byte	$02
	.byte	$06
	.byte	$00
	.byte	$07
	.byte	$02
	.byte	$15
_scr_0_04:
	.byte	$3C
	.byte	$02
	.byte	$0E
	.byte	$F0
	.byte	$52
	.byte	$F0
	.byte	$20
	.byte	$00
	.byte	$0C
	.byte	$F1
	.byte	$50
	.byte	$20
	.byte	$00
	.byte	$0C
	.byte	$F1
	.byte	$50
	.byte	$20
	.byte	$00
	.byte	$0C
	.byte	$F1
	.byte	$50
	.byte	$20
	.byte	$00
	.byte	$0C
	.byte	$F1
	.byte	$50
	.byte	$20
	.byte	$00
	.byte	$0C
	.byte	$F1
	.byte	$50
	.byte	$20
	.byte	$00
	.byte	$0C
	.byte	$F1
	.byte	$50
	.byte	$20
	.byte	$00
	.byte	$0C
	.byte	$F1
	.byte	$50
	.byte	$20
	.byte	$00
	.byte	$0C
	.byte	$F1
	.byte	$50
	.byte	$20
	.byte	$00
	.byte	$0C
	.byte	$F1
	.byte	$50
	.byte	$20
	.byte	$00
	.byte	$04
	.byte	$F1
	.byte	$2C
	.byte	$25
	.byte	$05
	.byte	$06
	.byte	$02
	.byte	$10
_scr_0_05:
	.byte	$0D
	.byte	$02
	.byte	$10
	.byte	$00
	.byte	$90
	.byte	$05
	.byte	$06
	.byte	$F1
	.byte	$2D
	.byte	$20
	.byte	$00
	.byte	$06
	.byte	$02
	.byte	$10
_scr_0_06:
	.byte	$2A
	.byte	$02
	.byte	$10
	.byte	$00
	.byte	$55
	.byte	$07
	.byte	$07
	.byte	$00
	.byte	$09
	.byte	$07
	.byte	$07
	.byte	$00
	.byte	$09
	.byte	$F0
	.byte	$77
	.byte	$F1
	.byte	$00
	.byte	$07
	.byte	$F0
	.byte	$70
	.byte	$00
	.byte	$08
	.byte	$F0
	.byte	$77
	.byte	$F1
	.byte	$00
	.byte	$07
	.byte	$F0
	.byte	$70
	.byte	$00
	.byte	$08
	.byte	$F0
	.byte	$77
	.byte	$F1
	.byte	$22
	.byte	$27
	.byte	$F0
	.byte	$70
	.byte	$F1
	.byte	$00
	.byte	$02
	.byte	$02
	.byte	$0F
_scr_0_07:
	.byte	$2A
	.byte	$02
	.byte	$10
	.byte	$00
	.byte	$0F
	.byte	$F0
	.byte	$20
	.byte	$00
	.byte	$0E
	.byte	$F0
	.byte	$20
	.byte	$00
	.byte	$0E
	.byte	$F0
	.byte	$20
	.byte	$00
	.byte	$0E
	.byte	$F0
	.byte	$20
	.byte	$00
	.byte	$0E
	.byte	$F0
	.byte	$20
	.byte	$00
	.byte	$0E
	.byte	$F0
	.byte	$20
	.byte	$00
	.byte	$0E
	.byte	$F0
	.byte	$20
	.byte	$00
	.byte	$0E
	.byte	$F0
	.byte	$20
	.byte	$00
	.byte	$0E
	.byte	$F0
	.byte	$20
	.byte	$00
	.byte	$0E
	.byte	$02
	.byte	$11
_map_0:
	.addr	_scr_0_00
	.addr	_scr_0_01
	.addr	_scr_0_02
	.addr	_scr_0_03
	.addr	_scr_0_04
	.addr	_scr_0_05
	.addr	_scr_0_06
	.addr	_scr_0_07
_map_0_locks:
	.byte	$01
	.byte	$AF
_enems_0:
	.byte	$03
	.byte	$BD
	.byte	$B5
	.byte	$01
	.byte	$06
	.byte	$3D
	.byte	$3C
	.byte	$00
	.byte	$00
	.byte	$10
	.byte	$10
	.byte	$00
	.byte	$04
	.byte	$6B
	.byte	$9B
	.byte	$01
	.byte	$0B
	.byte	$3D
	.byte	$3C
	.byte	$00
	.byte	$00
	.byte	$10
	.byte	$10
	.byte	$00
	.byte	$08
	.byte	$CB
	.byte	$C3
	.byte	$00
	.byte	$09
	.byte	$9E
	.byte	$8E
	.byte	$04
	.byte	$0A
	.byte	$92
	.byte	$A2
	.byte	$02
	.byte	$0A
	.byte	$96
	.byte	$B6
	.byte	$02
	.byte	$0A
	.byte	$99
	.byte	$B9
	.byte	$01
	.byte	$00
	.byte	$10
	.byte	$10
	.byte	$00
	.byte	$01
	.byte	$B5
	.byte	$B1
	.byte	$02
	.byte	$01
	.byte	$B1
	.byte	$B5
	.byte	$01
	.byte	$00
	.byte	$10
	.byte	$10
	.byte	$00
	.byte	$02
	.byte	$B9
	.byte	$BD
	.byte	$01
	.byte	$00
	.byte	$10
	.byte	$10
	.byte	$00
	.byte	$00
	.byte	$10
	.byte	$10
	.byte	$00
	.byte	$01
	.byte	$65
	.byte	$6B
	.byte	$02
	.byte	$00
	.byte	$10
	.byte	$10
	.byte	$00
	.byte	$00
	.byte	$10
	.byte	$10
	.byte	$00
	.byte	$00
	.byte	$10
	.byte	$10
	.byte	$00
	.byte	$00
	.byte	$10
	.byte	$10
	.byte	$00
	.byte	$00
	.byte	$10
	.byte	$10
	.byte	$00
_hotspots_0:
	.byte	$03
	.byte	$4E
	.byte	$02
	.byte	$25
	.byte	$05
	.byte	$B7
	.byte	$00
	.byte	$10
	.byte	$07
	.byte	$A7
	.byte	$08
	.byte	$A7
	.byte	$06
	.byte	$A8
	.byte	$00
	.byte	$10
_sspl_00_a:
	.byte	$FC
	.byte	$F8
	.byte	$01
	.byte	$00
	.byte	$04
	.byte	$F8
	.byte	$02
	.byte	$00
	.byte	$FC
	.byte	$00
	.byte	$03
	.byte	$00
	.byte	$04
	.byte	$00
	.byte	$04
	.byte	$00
	.byte	$FC
	.byte	$08
	.byte	$05
	.byte	$00
	.byte	$04
	.byte	$08
	.byte	$06
	.byte	$00
	.byte	$80
_sspl_00_b:
	.byte	$FC
	.byte	$F8
	.byte	$02
	.byte	$40
	.byte	$04
	.byte	$F8
	.byte	$01
	.byte	$40
	.byte	$FC
	.byte	$00
	.byte	$04
	.byte	$40
	.byte	$04
	.byte	$00
	.byte	$03
	.byte	$40
	.byte	$FC
	.byte	$08
	.byte	$06
	.byte	$40
	.byte	$04
	.byte	$08
	.byte	$05
	.byte	$40
	.byte	$80
_sspl_01_a:
	.byte	$FC
	.byte	$F8
	.byte	$07
	.byte	$00
	.byte	$04
	.byte	$F8
	.byte	$08
	.byte	$00
	.byte	$FC
	.byte	$00
	.byte	$09
	.byte	$00
	.byte	$04
	.byte	$00
	.byte	$0A
	.byte	$00
	.byte	$FC
	.byte	$08
	.byte	$0B
	.byte	$00
	.byte	$04
	.byte	$08
	.byte	$0C
	.byte	$00
	.byte	$80
_sspl_01_b:
	.byte	$FC
	.byte	$F8
	.byte	$08
	.byte	$40
	.byte	$04
	.byte	$F8
	.byte	$07
	.byte	$40
	.byte	$FC
	.byte	$00
	.byte	$0A
	.byte	$40
	.byte	$04
	.byte	$00
	.byte	$09
	.byte	$40
	.byte	$FC
	.byte	$08
	.byte	$0C
	.byte	$40
	.byte	$04
	.byte	$08
	.byte	$0B
	.byte	$40
	.byte	$80
_sspl_02_a:
	.byte	$FC
	.byte	$F8
	.byte	$0D
	.byte	$00
	.byte	$04
	.byte	$F8
	.byte	$0E
	.byte	$00
	.byte	$FC
	.byte	$00
	.byte	$0F
	.byte	$00
	.byte	$04
	.byte	$00
	.byte	$10
	.byte	$00
	.byte	$FC
	.byte	$08
	.byte	$11
	.byte	$00
	.byte	$04
	.byte	$08
	.byte	$12
	.byte	$00
	.byte	$80
_sspl_02_b:
	.byte	$FC
	.byte	$F8
	.byte	$0E
	.byte	$40
	.byte	$04
	.byte	$F8
	.byte	$0D
	.byte	$40
	.byte	$FC
	.byte	$00
	.byte	$10
	.byte	$40
	.byte	$04
	.byte	$00
	.byte	$0F
	.byte	$40
	.byte	$FC
	.byte	$08
	.byte	$12
	.byte	$40
	.byte	$04
	.byte	$08
	.byte	$11
	.byte	$40
	.byte	$80
_sspl_03_a:
	.byte	$FC
	.byte	$F8
	.byte	$07
	.byte	$00
	.byte	$04
	.byte	$F8
	.byte	$08
	.byte	$00
	.byte	$FC
	.byte	$00
	.byte	$13
	.byte	$00
	.byte	$04
	.byte	$00
	.byte	$14
	.byte	$00
	.byte	$FC
	.byte	$08
	.byte	$15
	.byte	$00
	.byte	$04
	.byte	$08
	.byte	$16
	.byte	$00
	.byte	$80
_sspl_03_b:
	.byte	$FC
	.byte	$F8
	.byte	$08
	.byte	$40
	.byte	$04
	.byte	$F8
	.byte	$07
	.byte	$40
	.byte	$FC
	.byte	$00
	.byte	$14
	.byte	$40
	.byte	$04
	.byte	$00
	.byte	$13
	.byte	$40
	.byte	$FC
	.byte	$08
	.byte	$16
	.byte	$40
	.byte	$04
	.byte	$08
	.byte	$15
	.byte	$40
	.byte	$80
_sspl_04_a:
	.byte	$FC
	.byte	$F8
	.byte	$0D
	.byte	$00
	.byte	$04
	.byte	$F8
	.byte	$0E
	.byte	$00
	.byte	$FC
	.byte	$00
	.byte	$17
	.byte	$00
	.byte	$04
	.byte	$00
	.byte	$18
	.byte	$00
	.byte	$FC
	.byte	$08
	.byte	$19
	.byte	$00
	.byte	$04
	.byte	$08
	.byte	$1A
	.byte	$00
	.byte	$80
_sspl_04_b:
	.byte	$FC
	.byte	$F8
	.byte	$0E
	.byte	$40
	.byte	$04
	.byte	$F8
	.byte	$0D
	.byte	$40
	.byte	$FC
	.byte	$00
	.byte	$18
	.byte	$40
	.byte	$04
	.byte	$00
	.byte	$17
	.byte	$40
	.byte	$FC
	.byte	$08
	.byte	$1A
	.byte	$40
	.byte	$04
	.byte	$08
	.byte	$19
	.byte	$40
	.byte	$80
_sspl_05_a:
	.byte	$FC
	.byte	$F8
	.byte	$1B
	.byte	$00
	.byte	$04
	.byte	$F8
	.byte	$0E
	.byte	$00
	.byte	$FC
	.byte	$00
	.byte	$1C
	.byte	$00
	.byte	$04
	.byte	$00
	.byte	$1D
	.byte	$00
	.byte	$FC
	.byte	$08
	.byte	$1E
	.byte	$00
	.byte	$04
	.byte	$08
	.byte	$1F
	.byte	$00
	.byte	$80
_sspl_05_b:
	.byte	$FC
	.byte	$F8
	.byte	$0E
	.byte	$40
	.byte	$04
	.byte	$F8
	.byte	$1B
	.byte	$40
	.byte	$FC
	.byte	$00
	.byte	$1D
	.byte	$40
	.byte	$04
	.byte	$00
	.byte	$1C
	.byte	$40
	.byte	$FC
	.byte	$08
	.byte	$1F
	.byte	$40
	.byte	$04
	.byte	$08
	.byte	$1E
	.byte	$40
	.byte	$80
_sspl_06_a:
	.byte	$FC
	.byte	$F8
	.byte	$20
	.byte	$00
	.byte	$04
	.byte	$F8
	.byte	$21
	.byte	$00
	.byte	$FC
	.byte	$00
	.byte	$22
	.byte	$00
	.byte	$04
	.byte	$00
	.byte	$23
	.byte	$00
	.byte	$FC
	.byte	$08
	.byte	$24
	.byte	$00
	.byte	$04
	.byte	$08
	.byte	$25
	.byte	$00
	.byte	$80
_sspl_06_b:
	.byte	$FC
	.byte	$F8
	.byte	$21
	.byte	$40
	.byte	$04
	.byte	$F8
	.byte	$20
	.byte	$40
	.byte	$FC
	.byte	$00
	.byte	$23
	.byte	$40
	.byte	$04
	.byte	$00
	.byte	$22
	.byte	$40
	.byte	$FC
	.byte	$08
	.byte	$25
	.byte	$40
	.byte	$04
	.byte	$08
	.byte	$24
	.byte	$40
	.byte	$80
_ssen_00_a:
	.byte	$00
	.byte	$F8
	.byte	$26
	.byte	$02
	.byte	$08
	.byte	$F8
	.byte	$27
	.byte	$02
	.byte	$00
	.byte	$00
	.byte	$28
	.byte	$02
	.byte	$08
	.byte	$00
	.byte	$29
	.byte	$02
	.byte	$00
	.byte	$08
	.byte	$2A
	.byte	$02
	.byte	$08
	.byte	$08
	.byte	$2B
	.byte	$00
	.byte	$80
_ssen_00_b:
	.byte	$00
	.byte	$F8
	.byte	$27
	.byte	$42
	.byte	$08
	.byte	$F8
	.byte	$26
	.byte	$42
	.byte	$00
	.byte	$00
	.byte	$29
	.byte	$42
	.byte	$08
	.byte	$00
	.byte	$28
	.byte	$42
	.byte	$00
	.byte	$08
	.byte	$2B
	.byte	$40
	.byte	$08
	.byte	$08
	.byte	$2A
	.byte	$42
	.byte	$80
_ssen_01_a:
	.byte	$00
	.byte	$F8
	.byte	$26
	.byte	$02
	.byte	$08
	.byte	$F8
	.byte	$27
	.byte	$02
	.byte	$00
	.byte	$00
	.byte	$2C
	.byte	$02
	.byte	$08
	.byte	$00
	.byte	$2D
	.byte	$02
	.byte	$00
	.byte	$08
	.byte	$2E
	.byte	$02
	.byte	$08
	.byte	$08
	.byte	$2F
	.byte	$02
	.byte	$80
_ssen_01_b:
	.byte	$00
	.byte	$F8
	.byte	$27
	.byte	$42
	.byte	$08
	.byte	$F8
	.byte	$26
	.byte	$42
	.byte	$00
	.byte	$00
	.byte	$2D
	.byte	$42
	.byte	$08
	.byte	$00
	.byte	$2C
	.byte	$42
	.byte	$00
	.byte	$08
	.byte	$2F
	.byte	$42
	.byte	$08
	.byte	$08
	.byte	$2E
	.byte	$42
	.byte	$80
_ssen_02_a:
	.byte	$00
	.byte	$F8
	.byte	$30
	.byte	$02
	.byte	$08
	.byte	$F8
	.byte	$31
	.byte	$02
	.byte	$00
	.byte	$00
	.byte	$32
	.byte	$02
	.byte	$08
	.byte	$00
	.byte	$33
	.byte	$02
	.byte	$00
	.byte	$08
	.byte	$34
	.byte	$02
	.byte	$08
	.byte	$08
	.byte	$35
	.byte	$02
	.byte	$80
_ssen_02_b:
	.byte	$00
	.byte	$F8
	.byte	$31
	.byte	$42
	.byte	$08
	.byte	$F8
	.byte	$30
	.byte	$42
	.byte	$00
	.byte	$00
	.byte	$33
	.byte	$42
	.byte	$08
	.byte	$00
	.byte	$32
	.byte	$42
	.byte	$00
	.byte	$08
	.byte	$35
	.byte	$42
	.byte	$08
	.byte	$08
	.byte	$34
	.byte	$42
	.byte	$80
_ssen_03_a:
	.byte	$00
	.byte	$F8
	.byte	$36
	.byte	$02
	.byte	$08
	.byte	$F8
	.byte	$37
	.byte	$02
	.byte	$00
	.byte	$00
	.byte	$38
	.byte	$02
	.byte	$08
	.byte	$00
	.byte	$39
	.byte	$02
	.byte	$00
	.byte	$08
	.byte	$3A
	.byte	$02
	.byte	$08
	.byte	$08
	.byte	$3B
	.byte	$02
	.byte	$80
_ssen_03_b:
	.byte	$00
	.byte	$F8
	.byte	$37
	.byte	$42
	.byte	$08
	.byte	$F8
	.byte	$36
	.byte	$42
	.byte	$00
	.byte	$00
	.byte	$39
	.byte	$42
	.byte	$08
	.byte	$00
	.byte	$38
	.byte	$42
	.byte	$00
	.byte	$08
	.byte	$3B
	.byte	$42
	.byte	$08
	.byte	$08
	.byte	$3A
	.byte	$42
	.byte	$80
_ssen_04_a:
	.byte	$00
	.byte	$F8
	.byte	$3C
	.byte	$02
	.byte	$08
	.byte	$F8
	.byte	$3D
	.byte	$02
	.byte	$00
	.byte	$00
	.byte	$3E
	.byte	$02
	.byte	$08
	.byte	$00
	.byte	$3F
	.byte	$02
	.byte	$00
	.byte	$08
	.byte	$40
	.byte	$02
	.byte	$08
	.byte	$08
	.byte	$41
	.byte	$02
	.byte	$80
_ssen_04_b:
	.byte	$00
	.byte	$F8
	.byte	$3D
	.byte	$42
	.byte	$08
	.byte	$F8
	.byte	$3C
	.byte	$42
	.byte	$00
	.byte	$00
	.byte	$3F
	.byte	$42
	.byte	$08
	.byte	$00
	.byte	$3E
	.byte	$42
	.byte	$00
	.byte	$08
	.byte	$41
	.byte	$42
	.byte	$08
	.byte	$08
	.byte	$40
	.byte	$42
	.byte	$80
_ssen_05_a:
	.byte	$00
	.byte	$F8
	.byte	$42
	.byte	$02
	.byte	$08
	.byte	$F8
	.byte	$43
	.byte	$02
	.byte	$00
	.byte	$00
	.byte	$44
	.byte	$02
	.byte	$08
	.byte	$00
	.byte	$45
	.byte	$02
	.byte	$00
	.byte	$08
	.byte	$46
	.byte	$02
	.byte	$08
	.byte	$08
	.byte	$47
	.byte	$02
	.byte	$80
_ssen_05_b:
	.byte	$00
	.byte	$F8
	.byte	$43
	.byte	$42
	.byte	$08
	.byte	$F8
	.byte	$42
	.byte	$42
	.byte	$00
	.byte	$00
	.byte	$45
	.byte	$42
	.byte	$08
	.byte	$00
	.byte	$44
	.byte	$42
	.byte	$00
	.byte	$08
	.byte	$47
	.byte	$42
	.byte	$08
	.byte	$08
	.byte	$46
	.byte	$42
	.byte	$80
_ssplat_00:
	.byte	$00
	.byte	$00
	.byte	$48
	.byte	$02
	.byte	$08
	.byte	$00
	.byte	$48
	.byte	$42
	.byte	$00
	.byte	$08
	.byte	$49
	.byte	$02
	.byte	$08
	.byte	$08
	.byte	$4A
	.byte	$02
	.byte	$80
_ssplat_01:
	.byte	$00
	.byte	$00
	.byte	$48
	.byte	$02
	.byte	$08
	.byte	$00
	.byte	$48
	.byte	$42
	.byte	$00
	.byte	$08
	.byte	$4B
	.byte	$02
	.byte	$08
	.byte	$08
	.byte	$4C
	.byte	$02
	.byte	$80
_ssfanty_00_a:
	.byte	$00
	.byte	$00
	.byte	$4D
	.byte	$02
	.byte	$08
	.byte	$00
	.byte	$4E
	.byte	$02
	.byte	$00
	.byte	$08
	.byte	$4F
	.byte	$02
	.byte	$08
	.byte	$08
	.byte	$50
	.byte	$02
	.byte	$80
_ssfanty_00_b:
	.byte	$00
	.byte	$00
	.byte	$4E
	.byte	$42
	.byte	$08
	.byte	$00
	.byte	$4D
	.byte	$42
	.byte	$00
	.byte	$08
	.byte	$50
	.byte	$42
	.byte	$08
	.byte	$08
	.byte	$4F
	.byte	$42
	.byte	$80
_ssfanty_01_a:
	.byte	$00
	.byte	$00
	.byte	$4D
	.byte	$02
	.byte	$08
	.byte	$00
	.byte	$4E
	.byte	$02
	.byte	$00
	.byte	$08
	.byte	$4F
	.byte	$02
	.byte	$08
	.byte	$08
	.byte	$51
	.byte	$02
	.byte	$80
_ssfanty_01_b:
	.byte	$00
	.byte	$00
	.byte	$4E
	.byte	$42
	.byte	$08
	.byte	$00
	.byte	$4D
	.byte	$42
	.byte	$00
	.byte	$08
	.byte	$51
	.byte	$42
	.byte	$08
	.byte	$08
	.byte	$4F
	.byte	$42
	.byte	$80
_sspezon_00:
	.byte	$00
	.byte	$00
	.byte	$52
	.byte	$02
	.byte	$08
	.byte	$00
	.byte	$53
	.byte	$02
	.byte	$00
	.byte	$08
	.byte	$54
	.byte	$02
	.byte	$08
	.byte	$08
	.byte	$55
	.byte	$02
	.byte	$80
_sspezon_01:
	.byte	$00
	.byte	$00
	.byte	$56
	.byte	$02
	.byte	$08
	.byte	$00
	.byte	$57
	.byte	$02
	.byte	$00
	.byte	$08
	.byte	$58
	.byte	$02
	.byte	$08
	.byte	$08
	.byte	$59
	.byte	$02
	.byte	$80
_sssaw_00:
	.byte	$00
	.byte	$00
	.byte	$5A
	.byte	$02
	.byte	$08
	.byte	$00
	.byte	$5B
	.byte	$02
	.byte	$00
	.byte	$08
	.byte	$5B
	.byte	$C2
	.byte	$08
	.byte	$08
	.byte	$5A
	.byte	$C2
	.byte	$80
_sssaw_01:
	.byte	$00
	.byte	$00
	.byte	$5C
	.byte	$02
	.byte	$08
	.byte	$00
	.byte	$5D
	.byte	$02
	.byte	$00
	.byte	$08
	.byte	$5D
	.byte	$C2
	.byte	$08
	.byte	$08
	.byte	$5C
	.byte	$C2
	.byte	$80
_ssexpl:
	.byte	$00
	.byte	$00
	.byte	$5E
	.byte	$02
	.byte	$08
	.byte	$00
	.byte	$5F
	.byte	$02
	.byte	$00
	.byte	$08
	.byte	$60
	.byte	$02
	.byte	$08
	.byte	$08
	.byte	$61
	.byte	$02
	.byte	$80
_ssmono_00_a:
	.byte	$00
	.byte	$00
	.byte	$62
	.byte	$01
	.byte	$08
	.byte	$00
	.byte	$63
	.byte	$01
	.byte	$00
	.byte	$08
	.byte	$64
	.byte	$01
	.byte	$08
	.byte	$08
	.byte	$65
	.byte	$01
	.byte	$80
_ssmono_00_b:
	.byte	$00
	.byte	$00
	.byte	$63
	.byte	$41
	.byte	$08
	.byte	$00
	.byte	$62
	.byte	$41
	.byte	$00
	.byte	$08
	.byte	$65
	.byte	$41
	.byte	$08
	.byte	$08
	.byte	$64
	.byte	$41
	.byte	$80
_ssmono_01_a:
	.byte	$00
	.byte	$00
	.byte	$62
	.byte	$01
	.byte	$08
	.byte	$00
	.byte	$66
	.byte	$01
	.byte	$00
	.byte	$08
	.byte	$67
	.byte	$01
	.byte	$08
	.byte	$08
	.byte	$68
	.byte	$01
	.byte	$80
_ssmono_01_b:
	.byte	$00
	.byte	$00
	.byte	$66
	.byte	$41
	.byte	$08
	.byte	$00
	.byte	$62
	.byte	$41
	.byte	$00
	.byte	$08
	.byte	$68
	.byte	$41
	.byte	$08
	.byte	$08
	.byte	$67
	.byte	$41
	.byte	$80
_ssmono_02_a:
	.byte	$00
	.byte	$00
	.byte	$69
	.byte	$01
	.byte	$08
	.byte	$00
	.byte	$6A
	.byte	$01
	.byte	$00
	.byte	$08
	.byte	$6B
	.byte	$01
	.byte	$08
	.byte	$08
	.byte	$6C
	.byte	$01
	.byte	$80
_ssmono_02_b:
	.byte	$00
	.byte	$00
	.byte	$6A
	.byte	$41
	.byte	$08
	.byte	$00
	.byte	$69
	.byte	$41
	.byte	$00
	.byte	$08
	.byte	$6C
	.byte	$41
	.byte	$08
	.byte	$08
	.byte	$6B
	.byte	$41
	.byte	$80
_ssmono_03_a:
	.byte	$00
	.byte	$00
	.byte	$6D
	.byte	$01
	.byte	$08
	.byte	$00
	.byte	$6E
	.byte	$01
	.byte	$00
	.byte	$08
	.byte	$6F
	.byte	$01
	.byte	$08
	.byte	$08
	.byte	$70
	.byte	$01
	.byte	$80
_ssmono_03_b:
	.byte	$00
	.byte	$00
	.byte	$6E
	.byte	$41
	.byte	$08
	.byte	$00
	.byte	$6D
	.byte	$41
	.byte	$00
	.byte	$08
	.byte	$70
	.byte	$41
	.byte	$08
	.byte	$08
	.byte	$6F
	.byte	$41
	.byte	$80
_sseocc:
	.byte	$00
	.byte	$00
	.byte	$71
	.byte	$23
	.byte	$08
	.byte	$00
	.byte	$71
	.byte	$63
	.byte	$00
	.byte	$08
	.byte	$71
	.byte	$A3
	.byte	$08
	.byte	$08
	.byte	$71
	.byte	$E3
	.byte	$80
_ssit_00:
	.byte	$00
	.byte	$00
	.byte	$72
	.byte	$00
	.byte	$08
	.byte	$00
	.byte	$72
	.byte	$40
	.byte	$00
	.byte	$08
	.byte	$73
	.byte	$00
	.byte	$08
	.byte	$08
	.byte	$73
	.byte	$40
	.byte	$80
_ssit_01:
	.byte	$00
	.byte	$00
	.byte	$74
	.byte	$02
	.byte	$08
	.byte	$00
	.byte	$75
	.byte	$02
	.byte	$00
	.byte	$08
	.byte	$76
	.byte	$02
	.byte	$08
	.byte	$08
	.byte	$77
	.byte	$00
	.byte	$80
_ssit_02:
	.byte	$00
	.byte	$00
	.byte	$78
	.byte	$02
	.byte	$08
	.byte	$00
	.byte	$79
	.byte	$02
	.byte	$00
	.byte	$08
	.byte	$7A
	.byte	$02
	.byte	$08
	.byte	$08
	.byte	$7B
	.byte	$02
	.byte	$80
_ssobjs_00:
	.byte	$00
	.byte	$00
	.byte	$7C
	.byte	$02
	.byte	$08
	.byte	$00
	.byte	$7C
	.byte	$42
	.byte	$00
	.byte	$08
	.byte	$7C
	.byte	$82
	.byte	$08
	.byte	$08
	.byte	$7C
	.byte	$C2
	.byte	$80
_ssobjs_01:
	.byte	$00
	.byte	$00
	.byte	$7D
	.byte	$01
	.byte	$08
	.byte	$00
	.byte	$7E
	.byte	$01
	.byte	$00
	.byte	$08
	.byte	$7F
	.byte	$01
	.byte	$08
	.byte	$08
	.byte	$80
	.byte	$01
	.byte	$80
_ssobjs_02:
	.byte	$00
	.byte	$00
	.byte	$81
	.byte	$01
	.byte	$08
	.byte	$00
	.byte	$81
	.byte	$41
	.byte	$00
	.byte	$08
	.byte	$81
	.byte	$81
	.byte	$08
	.byte	$08
	.byte	$81
	.byte	$C1
	.byte	$80
_ts0_pals:
	.byte	$00
	.byte	$00
	.byte	$00
	.byte	$03
	.byte	$02
	.byte	$01
	.byte	$00
	.byte	$02
	.byte	$02
	.byte	$03
	.byte	$03
	.byte	$02
	.byte	$00
	.byte	$00
	.byte	$03
	.byte	$00
	.byte	$00
	.byte	$00
	.byte	$00
	.byte	$00
	.byte	$00
	.byte	$00
	.byte	$00
_ts0_tmaps:
	.byte	$00
	.byte	$00
	.byte	$00
	.byte	$00
	.byte	$40
	.byte	$41
	.byte	$42
	.byte	$43
	.byte	$44
	.byte	$45
	.byte	$46
	.byte	$47
	.byte	$48
	.byte	$49
	.byte	$4A
	.byte	$4B
	.byte	$4C
	.byte	$4D
	.byte	$4E
	.byte	$4F
	.byte	$50
	.byte	$50
	.byte	$51
	.byte	$51
	.byte	$52
	.byte	$53
	.byte	$00
	.byte	$00
	.byte	$54
	.byte	$55
	.byte	$56
	.byte	$57
	.byte	$58
	.byte	$59
	.byte	$5A
	.byte	$5B
	.byte	$5C
	.byte	$5D
	.byte	$5E
	.byte	$5F
	.byte	$60
	.byte	$61
	.byte	$5E
	.byte	$5F
	.byte	$62
	.byte	$63
	.byte	$64
	.byte	$65
	.byte	$66
	.byte	$67
	.byte	$68
	.byte	$69
	.byte	$6A
	.byte	$6B
	.byte	$6C
	.byte	$6D
	.byte	$6E
	.byte	$6F
	.byte	$70
	.byte	$71
	.byte	$72
	.byte	$73
	.byte	$74
	.byte	$75
	.byte	$76
	.byte	$76
	.byte	$00
	.byte	$00
	.byte	$00
	.byte	$00
	.byte	$77
	.byte	$77
	.byte	$78
	.byte	$79
	.byte	$76
	.byte	$76
	.byte	$77
	.byte	$77
	.byte	$7A
	.byte	$78
	.byte	$7B
	.byte	$7B
	.byte	$7C
	.byte	$7C
	.byte	$78
	.byte	$79
	.byte	$7A
	.byte	$78
	.byte	$00
	.byte	$00
	.byte	$00
	.byte	$00
_spr_player:
	.addr	_sspl_00_a
	.addr	_sspl_01_a
	.addr	_sspl_02_a
	.addr	_sspl_03_a
	.addr	_sspl_04_a
	.addr	_sspl_05_a
	.addr	_sspl_06_a
	.word	$0000
	.addr	_sspl_00_b
	.addr	_sspl_01_b
	.addr	_sspl_02_b
	.addr	_sspl_03_b
	.addr	_sspl_04_b
	.addr	_sspl_05_b
	.addr	_sspl_06_b
	.word	$0000
_spr_enems0:
	.addr	_ssen_00_a
	.addr	_ssen_01_a
	.word	$0000
	.word	$0000
	.addr	_ssen_00_b
	.addr	_ssen_01_b
	.word	$0000
	.word	$0000
	.addr	_ssen_02_a
	.addr	_ssen_03_a
	.word	$0000
	.word	$0000
	.addr	_ssen_02_b
	.addr	_ssen_03_b
	.word	$0000
	.word	$0000
	.addr	_ssen_04_a
	.addr	_ssen_05_a
	.word	$0000
	.word	$0000
	.addr	_ssen_04_b
	.addr	_ssen_05_b
	.word	$0000
	.word	$0000
	.addr	_ssplat_00
	.addr	_ssplat_01
	.word	$0000
	.word	$0000
	.addr	_ssplat_00
	.addr	_ssplat_01
	.word	$0000
	.word	$0000
	.addr	_ssfanty_00_a
	.addr	_ssfanty_01_a
	.word	$0000
	.word	$0000
	.addr	_ssfanty_00_b
	.addr	_ssfanty_01_b
	.word	$0000
	.word	$0000
	.addr	_sspezon_00
	.addr	_sspezon_01
	.word	$0000
	.word	$0000
	.word	$0000
	.word	$0000
	.word	$0000
	.word	$0000
	.addr	_sssaw_00
	.addr	_sssaw_01
	.word	$0000
	.word	$0000
	.word	$0000
	.word	$0000
	.word	$0000
	.word	$0000
	.addr	_ssmono_00_a
	.addr	_ssmono_01_a
	.word	$0000
	.word	$0000
	.addr	_ssmono_00_b
	.addr	_ssmono_01_b
	.word	$0000
	.word	$0000
	.addr	_ssmono_02_a
	.addr	_ssmono_03_a
	.word	$0000
	.word	$0000
	.addr	_ssmono_02_b
	.addr	_ssmono_03_b
	.word	$0000
	.word	$0000
	.addr	_sseocc
	.addr	_ssexpl
_spr_hs:
	.word	$0000
	.addr	_ssit_00
	.addr	_ssit_01
	.addr	_ssit_02
	.addr	_ssobjs_00
	.addr	_ssobjs_01
	.addr	_ssobjs_02
L0001:
	.byte	$4C,$49,$46,$45,$3A,$30,$30,$20,$20,$20,$49,$54,$45,$4D,$3A,$20
	.byte	$20,$20,$20,$20,$20,$4B,$45,$59,$53,$3A,$30,$30,$00,$53,$55,$50
	.byte	$50,$41,$54,$45,$53,$54,$52,$20,$2D,$20,$54,$48,$45,$20,$4D,$4F
	.byte	$4A,$4F,$4E,$20,$54,$57,$49,$4E,$53,$00

.segment	"BSS"

.segment	"ZEROPAGE"
__x:
	.res	1,$00
__y:
	.res	1,$00
__n:
	.res	1,$00
__t:
	.res	1,$00
__z:
	.res	1,$00
_pad0:
	.res	1,$00
_pad_this_frame:
	.res	1,$00
_gpit:
	.res	1,$00
_gpjt:
	.res	1,$00
_gpitu:
	.res	1,$00
_gpaux:
	.res	1,$00
_rds16:
	.res	2,$00
_gpint:
	.res	2,$00
_gp_gen:
	.res	2,$00
_gp_tmap:
	.res	2,$00
_gp_tma2:
	.res	2,$00
_gp_ram:
	.res	2,$00
_gp_ram_aux:
	.res	2,$00
_gp_addr:
	.res	2,$00
_rdx:
	.res	1,$00
_rdy:
	.res	1,$00
_rdt:
	.res	1,$00
_rdit:
	.res	1,$00
_rda:
	.res	1,$00
_rdb:
	.res	1,$00
_rdc:
	.res	1,$00
_rdd:
	.res	1,$00
_rdm:
	.res	1,$00
_rde:
	.res	1,$00
_rds:
	.res	1,$00
_rdct:
	.res	1,$00
_ticker:
	.res	1,$00
_rdaa:
	.res	2,$00
_rdbb:
	.res	2,$00
_en_x_offs:
	.res	2,$00
_ast1:
	.res	1,$00
_at1:
	.res	1,$00
_at2:
	.res	1,$00
_cx1:
	.res	1,$00
_cx2:
	.res	1,$00
_cy1:
	.res	1,$00
_cy2:
	.res	1,$00
_caux:
	.res	1,$00
_oam_index:
	.res	1,$00
_en_initial:
	.res	1,$00
_en_offs:
	.res	1,$00
_en_fr:
	.res	1,$00
_en_collx:
	.res	1,$00
_en_colly:
	.res	1,$00
_en_spr:
	.res	1,$00
_touched:
	.res	1,$00
_en_is_alive:
	.res	1,$00
_pregotten:
	.res	1,$00
__en_t:
	.res	1,$00
__en_s:
	.res	1,$00
__en_x:
	.res	1,$00
__en_y:
	.res	1,$00
__en_x1:
	.res	1,$00
__en_y1:
	.res	1,$00
__en_x2:
	.res	1,$00
__en_y2:
	.res	1,$00
__en_mx:
	.res	1,$00
__en_my:
	.res	1,$00
__en_ct:
	.res	1,$00
__en_facing:
	.res	1,$00
__en_state:
	.res	1,$00
__enf_x:
	.res	2,$00
__enf_y:
	.res	2,$00
__enf_vx:
	.res	2,$00
__enf_vy:
	.res	2,$00
_en_sg_1:
	.res	1,$00
_en_sg_2:
	.res	1,$00
_vertical_engine_type:
	.res	1,$00
_px:
	.res	2,$00
_py:
	.res	2,$00
_pvx:
	.res	2,$00
_pvy:
	.res	2,$00
_prx:
	.res	2,$00
_pry:
	.res	1,$00
_pcx:
	.res	2,$00
_pcy:
	.res	1,$00
_pfacing:
	.res	1,$00
_pfr:
	.res	1,$00
_pctfr:
	.res	1,$00
_psprid:
	.res	1,$00
_a_button:
	.res	1,$00
_b_button:
	.res	1,$00
_pj:
	.res	1,$00
_pctj:
	.res	1,$00
_pgotten:
	.res	1,$00
_ppossee:
	.res	1,$00
_oppossee:
	.res	1,$00
_pflickering:
	.res	1,$00
_pbouncing:
	.res	1,$00
_phit:
	.res	1,$00
_pgtmx:
	.res	2,$00
_pgtmy:
	.res	2,$00
_pinv:
	.res	1,$00
_opinv:
	.res	1,$00
_hitv:
	.res	1,$00
_hith:
	.res	1,$00
_prx_old:
	.res	1,$00
_pry_old:
	.res	1,$00
_pkill:
	.res	1,$00
_pice:
	.res	1,$00
_pnotsafe:
	.res	1,$00
_pcontinues:
	.res	1,$00
_plife:
	.res	1,$00
_pkeys:
	.res	1,$00
_pobjs:
	.res	1,$00
_pammo:
	.res	1,$00
_pkilled:
	.res	1,$00
_pfiring:
	.res	1,$00
_n_pant_safe:
	.res	1,$00
_px_safe:
	.res	2,$00
_py_safe:
	.res	2,$00
_bi:
	.res	1,$00
__bx:
	.res	2,$00
__by:
	.res	1,$00
_bullets_disable:
	.res	1,$00
_coco_it:
	.res	1,$00
_hrx:
	.res	2,$00
_hry:
	.res	1,$00
_hrt:
	.res	1,$00
_do_process_breakable:
	.res	1,$00
_ft:
	.res	1,$00
_c_map_w:
	.res	1,$00
_c_map_h:
	.res	1,$00
_c_map_size:
	.res	1,$00
_c_ts_pals:
	.res	2,$00
_c_ts_tmaps:
	.res	2,$00
_c_behs:
	.res	2,$00
_spr_enems:
	.res	2,$00
_c_pal_bg:
	.res	2,$00
_c_pal_fg:
	.res	2,$00
_c_map:
	.res	2,$00
_c_locks:
	.res	2,$00
_c_enems:
	.res	2,$00
_c_hotspots:
	.res	2,$00
_c_max_bolts:
	.res	1,$00
_w_pant:
	.res	1,$00
_nametable_base:
	.res	2,$00
_buff_offset:
	.res	2,$00
_attr_table_offset:
	.res	1,$00
_buff_ptr:
	.res	2,$00
_attr_ptr:
	.res	2,$00
_scroll_x:
	.res	2,$00
_on_screen:
	.res	1,$00
.segment	"BSS"
_ntsc:
	.res	1,$00
_ntsc_frame:
	.res	1,$00
_update_index:
	.res	1,$00
_update_list:
	.res	96,$00
_attr_table:
	.res	128,$00
_fader:
	.res	1,$00
_fade_delay:
	.res	1,$00
_map_attr:
	.res	384,$00
_map_buff:
	.res	384,$00
_first_game:
	.res	1,$00
_level:
	.res	1,$00
_c_max_enems:
	.res	1,$00
_n_pant:
	.res	1,$00
_on_pant:
	.res	1,$00
_half_life:
	.res	1,$00
_frame_counter:
	.res	1,$00
_paused:
	.res	1,$00
_win_level:
	.res	1,$00
_game_over:
	.res	1,$00
_warp_to_level:
	.res	1,$00
_level_reset:
	.res	1,$00
_flick_override:
	.res	1,$00
_olife:
	.res	1,$00
_okeys:
	.res	1,$00
_oobjs:
	.res	1,$00
_oammo:
	.res	1,$00
_okilled:
	.res	1,$00
_oam_index_player:
	.res	1,$00
_b_slots:
	.res	4,$00
_b_slots_i:
	.res	1,$00
_bx:
	.res	8,$00
_b_cy1:
	.res	4,$00
_by:
	.res	4,$00
_bmx:
	.res	4,$00
_bmy:
	.res	4,$00
_coco_slots:
	.res	1,$00
_coco_slots_i:
	.res	1,$00
_coco_on:
	.res	1,$00
_coco_x:
	.res	2,$00
_coco_y:
	.res	2,$00
_coco_vx:
	.res	2,$00
_coco_vy:
	.res	2,$00
_brkf:
	.res	4,$00
_brkx:
	.res	4,$00
_brky:
	.res	4,$00
_pmayneedrelocation:
	.res	1,$00
_hyx:
	.res	8,$00
_ht:
	.res	8,$00
_hact:
	.res	8,$00
_d_hrx:
	.res	4,$00
_d_hry:
	.res	2,$00
_d_hrt:
	.res	2,$00
_lkact:
	.res	16,$00
_flags:
	.res	2,$00
_en_t:
	.res	6,$00
_en_x:
	.res	6,$00
_en_y:
	.res	6,$00
_en_x1:
	.res	6,$00
_en_y1:
	.res	6,$00
_en_x2:
	.res	6,$00
_en_y2:
	.res	6,$00
_en_mx:
	.res	6,$00
_en_my:
	.res	6,$00
_en_s:
	.res	6,$00
_en_facing:
	.res	6,$00
_en_state:
	.res	6,$00
_en_flags:
	.res	6,$00
_en_cttouched:
	.res	6,$00
_en_life:
	.res	6,$00
_en_status:
	.res	6,$00
_en_ct:
	.res	6,$00
_en_spr_x_mod:
	.res	1,$00
_enf_x:
	.res	12,$00
_enf_vx:
	.res	12,$00
_enf_y:
	.res	12,$00
_enf_vy:
	.res	12,$00
_en_spr_id:
	.res	6,$00
_cfx:
	.res	1,$00
_shaker_ct:
	.res	1,$00

; ---------------------------------------------------------------
; void __near__ player_render (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_player_render: near

.segment	"CODE"

;
; if (0 == pflickering || half_life) 
;
	lda     _pflickering
	beq     L0BF5
	lda     _half_life
	bne     L0BF5
	rts
;
; prx - scroll_x, 
;
L0BF5:	jsr     decsp3
	lda     _prx
	sec
	sbc     _scroll_x
	pha
	lda     _prx+1
	sbc     _scroll_x+1
	pla
	ldy     #$02
	sta     (sp),y
;
; pry + SPRITE_ADJUST, 
;
	lda     _pry
	clc
	adc     #$20
	sec
	sbc     #$08
	bcs     L1758
	sec
L1758:	sbc     #$10
	bcs     L1759
	sec
L1759:	sbc     #$01
	dey
	sta     (sp),y
;
; oam_index, 
;
	lda     _oam_index
	dey
	sta     (sp),y
;
; spr_player [psprid]
;
	ldx     #$00
	lda     _psprid
	asl     a
	bcc     L175A
	inx
	clc
L175A:	adc     #<(_spr_player)
;
; );
;
	sta     ptr1
;
; spr_player [psprid]
;
	txa
	adc     #>(_spr_player)
;
; );
;
	sta     ptr1+1
	iny
	lda     (ptr1),y
	tax
	dey
	lda     (ptr1),y
	jsr     _oam_meta_spr
	sta     _oam_index
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ fade_out (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_fade_out: near

.segment	"CODE"

;
; for (fader = 4; fader > -1; fader --) {
;
	lda     #$04
L175B:	sta     _fader
	tax
	bmi     L07C0
;
; pal_bright (fader);
;
	lda     _fader
	jsr     _pal_bright
;
; delay (fade_delay);
;
	lda     _fade_delay
	jsr     _delay
;
; for (fader = 4; fader > -1; fader --) {
;
	lda     _fader
	sec
	sbc     #$01
	jmp     L175B
;
; }
;
L07C0:	rts

.endproc

; ---------------------------------------------------------------
; void __near__ fade_in (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_fade_in: near

.segment	"CODE"

;
; for (fader = 0; fader < 5; fader ++) {
;
	lda     #$00
L175C:	sta     _fader
	sec
	sbc     #$05
	bvc     L07D6
	eor     #$80
L07D6:	bpl     L07CF
;
; pal_bright (fader);
;
	lda     _fader
	jsr     _pal_bright
;
; delay (fade_delay);
;
	lda     _fade_delay
	jsr     _delay
;
; for (fader = 0; fader < 5; fader ++) {
;
	lda     _fader
	clc
	adc     #$01
	jmp     L175C
;
; }
;
L07CF:	rts

.endproc

; ---------------------------------------------------------------
; void __near__ clear_update_list (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_clear_update_list: near

.segment	"CODE"

;
; memfill (update_list, 0, UPDATE_LIST_SIZE*3);
;
	jsr     decsp3
	lda     #<(_update_list)
	ldy     #$01
	sta     (sp),y
	iny
	lda     #>(_update_list)
	sta     (sp),y
	lda     #$00
	tay
	sta     (sp),y
	tax
	lda     #$60
	jsr     _memfill
;
; update_index = 0;
;
	lda     #$00
	sta     _update_index
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ cls (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_cls: near

.segment	"CODE"

;
; vram_adr (0x2000); vram_fill(0x00, 
;
	ldx     #$20
	lda     #$00
	jsr     _vram_adr
	lda     #$00
	jsr     pusha
;
; );
;
	ldx     #$08
	jmp     _vram_fill

.endproc

; ---------------------------------------------------------------
; void __near__ ul_putc (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_ul_putc: near

.segment	"CODE"

;
; __asm__ ("ldx %v", update_index);
;
	ldx     _update_index
;
; __asm__ ("lda %v + 1", gp_addr);
;
	lda     _gp_addr + 1
;
; __asm__ ("sta %v, x", update_list);
;
	sta     _update_list,x
;
; __asm__ ("inx");
;
	inx
;
; __asm__ ("lda %v", gp_addr);
;
	lda     _gp_addr
;
; __asm__ ("sta %v, x", update_list);
;
	sta     _update_list,x
;
; __asm__ ("inx");
;
	inx
;
; __asm__ ("lda %v", _n);
;
	lda     __n
;
; __asm__ ("sta %v, x", update_list);
;
	sta     _update_list,x
;
; __asm__ ("inc %v", gp_addr);
;
	inc     _gp_addr
;
; __asm__ ("bne %g", ul_putc_inc16_0);
;
	bne     L07F6
;
; __asm__ ("inc %v + 1", gp_addr);
;
	inc     _gp_addr + 1
;
; __asm__ ("inc %v", update_index);
;
L07F6:	inc     _update_index
;
; __asm__ ("inc %v", update_index);
;
	inc     _update_index
;
; __asm__ ("inc %v", update_index);
;
	inc     _update_index
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ p_t (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_p_t: near

.segment	"CODE"

;
; gp_addr = (_y << 5) + _x + 0x2000;
;
	ldx     #$00
	lda     __y
	jsr     aslax4
	stx     tmp1
	asl     a
	rol     tmp1
	ldx     tmp1
	clc
	adc     __x
	bcc     L175D
	inx
L175D:	sta     _gp_addr
	txa
	clc
	adc     #$20
	sta     _gp_addr+1
;
; __asm__ ("lda %v", _n);
;
	lda     __n
;
; __asm__ ("ldx #$ff");
;
	ldx     #$ff
;
; __asm__ ("sec");
;
	sec
;
; __asm__ ("inx");
;
L0802:	inx
;
; __asm__ ("sbc #10");
;
	sbc     #10
;
; __asm__ ("bcs %g", p_t_loop_0);
;
	bcs     L0802
;
; __asm__ ("adc #10");
;
	adc     #10
;
; __asm__ ("sta %v", rda);
;
	sta     _rda
;
; __asm__ ("stx %v", _n);
;
	stx     __n
;
; _n += 16;      ul_putc ();
;
	lda     #$10
	clc
	adc     __n
	sta     __n
	jsr     _ul_putc
;
; _n = rda + 16; ul_putc ();
;
	lda     _rda
	clc
	adc     #$10
	sta     __n
	jmp     _ul_putc

.endproc

; ---------------------------------------------------------------
; void __near__ upd_attr_table (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_upd_attr_table: near

.segment	"CODE"

;
; __asm__ ("lda %v", _x);
;
	lda     __x
;
; __asm__ ("lsr a");
;
	lsr     a
;
; __asm__ ("lsr a");
;
	lsr     a
;
; __asm__ ("sta %v", rdc); // rdc = (_x >> 2)
;
	sta     _rdc
;
; __asm__ ("lda %v", _y);
;
	lda     __y
;
; __asm__ ("asl a");
;
	asl     a
;
; __asm__ ("and #$f8");  // A = (_y << 1) & 0xf8
;
	and     #$f8
;
; __asm__ ("clc");
;
	clc
;
; __asm__ ("adc %v", rdc);
;
	adc     _rdc
;
; __asm__ ("sta %v", rdc); // Result
;
	sta     _rdc
;
; __asm__ ("clc");
;
	clc
;
; __asm__ ("adc %v", attr_table_offset);
;
	adc     _attr_table_offset
;
; __asm__ ("sta %v", rde);
;
	sta     _rde
;
; __asm__ ("tax");
;
	tax
;
; __asm__ ("lda %v, x", attr_table);
;
	lda     _attr_table,x
;
; __asm__ ("sta %v", rda);
;
	sta     _rda
;
; __asm__ ("lda %v", _x);
;
	lda     __x
;
; __asm__ ("lsr a");
;
	lsr     a
;
; __asm__ ("and #1");
;
	and     #1
;
; __asm__ ("sta %v", rdb); // rdb = ((_x >> 1) & 1)
;
	sta     _rdb
;
; __asm__ ("lda %v", _y);
;
	lda     __y
;
; __asm__ ("lsr a");
;
	lsr     a
;
; __asm__ ("and #1");
;
	and     #1
;
; __asm__ ("asl a");   // A = (((_y >> 1) & 1) << 1)
;
	asl     a
;
; __asm__ ("clc");
;
	clc
;
; __asm__ ("adc %v", rdb);
;
	adc     _rdb
;
; __asm__ ("sta %v", rdb); // Result
;
	sta     _rdb
;
; __asm__ ("lda %v", c_ts_pals);
;
	lda     _c_ts_pals
;
; __asm__ ("ldx %v + 1", c_ts_pals);
;
	ldx     _c_ts_pals + 1
;
; __asm__ ("ldy %v", _t);
;
	ldy     __t
;
; __asm__ ("sta ptr1");
;
	sta     ptr1
;
; __asm__ ("stx ptr1+1");
;
	stx     ptr1+1
;
; __asm__ ("lda (ptr1), y");
;
	lda     (ptr1),y
;
; __asm__ ("ldx %v", rdb); 
;
	ldx     _rdb
;
; __asm__ ("beq %g", upd_attr_table_loop_0_skip);
;
	beq     L0834
;
; __asm__ ("asl a");
;
L0835:	asl     a
;
; __asm__ ("asl a");
;
	asl     a
;
; __asm__ ("dex");
;
	dex
;
; __asm__ ("bne %g", upd_attr_table_loop_0);
;
	bne     L0835
;
; __asm__ ("sta %v", ast1); // ast1 = (c_ts_pals [_t] << (rdb << 1));
;
L0834:	sta     _ast1
;
; __asm__ ("lda %v", rda);
;
	lda     _rda
;
; __asm__ ("ldx %v", rdb);
;
	ldx     _rdb
;
; __asm__ ("and %v, x", bitmasks);
;
	and     _bitmasks,x
;
; __asm__ ("ora %v", ast1);
;
	ora     _ast1
;
; __asm__ ("sta %v", rda); // Result
;
	sta     _rda
;
; __asm__ ("ldx %v", rde);
;
	ldx     _rde
;
; __asm__ ("sta %v, x", attr_table);
;
	sta     _attr_table,x
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ draw_tile (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_draw_tile: near

.segment	"CODE"

;
; upd_attr_table ();
;
	jsr     _upd_attr_table
;
; gp_tmap = c_ts_tmaps + (_t << 2);
;
	ldx     #$00
	lda     __t
	jsr     aslax2
	clc
	adc     _c_ts_tmaps
	sta     _gp_tmap
	txa
	adc     _c_ts_tmaps+1
	sta     _gp_tmap+1
;
; gp_addr = ((_y << 5) + _x + NAMETABLE_BASE);
;
	ldx     #$00
	lda     __y
	jsr     aslax4
	stx     tmp1
	asl     a
	rol     tmp1
	ldx     tmp1
	clc
	adc     __x
	bcc     L175F
	inx
	clc
L175F:	adc     _nametable_base
	pha
	txa
	adc     _nametable_base+1
	tax
	pla
	sta     _gp_addr
	stx     _gp_addr+1
;
; vram_adr (gp_addr++);
;
	sta     regsave
	stx     regsave+1
	clc
	adc     #$01
	bcc     L084D
	inx
L084D:	sta     _gp_addr
	stx     _gp_addr+1
	lda     regsave
	ldx     regsave+1
	jsr     _vram_adr
;
; SET_FROM_PTR (_z, gp_tmap); gp_tmap ++; vram_put (_z);
;
	ldy     #0
	lda     (_gp_tmap),y
	sta     __z
	lda     _gp_tmap
	ldx     _gp_tmap+1
	clc
	adc     #$01
	bcc     L0852
	inx
L0852:	sta     _gp_tmap
	stx     _gp_tmap+1
	lda     __z
	jsr     _vram_put
;
; SET_FROM_PTR (_z, gp_tmap); gp_tmap ++; vram_put (_z);
;
	ldy     #0
	lda     (_gp_tmap),y
	sta     __z
	lda     _gp_tmap
	ldx     _gp_tmap+1
	clc
	adc     #$01
	bcc     L0859
	inx
L0859:	sta     _gp_tmap
	stx     _gp_tmap+1
	lda     __z
	jsr     _vram_put
;
; gp_addr += 31;
;
	lda     #$1F
	clc
	adc     _gp_addr
	sta     _gp_addr
	bcc     L085E
	inc     _gp_addr+1
;
; vram_adr (gp_addr++);
;
L085E:	lda     _gp_addr
	ldx     _gp_addr+1
	sta     regsave
	stx     regsave+1
	clc
	adc     #$01
	bcc     L0861
	inx
L0861:	sta     _gp_addr
	stx     _gp_addr+1
	lda     regsave
	ldx     regsave+1
	jsr     _vram_adr
;
; SET_FROM_PTR (_z, gp_tmap); gp_tmap ++; vram_put (_z);
;
	ldy     #0
	lda     (_gp_tmap),y
	sta     __z
	lda     _gp_tmap
	ldx     _gp_tmap+1
	clc
	adc     #$01
	bcc     L0866
	inx
L0866:	sta     _gp_tmap
	stx     _gp_tmap+1
	lda     __z
	jsr     _vram_put
;
; SET_FROM_PTR (_z, gp_tmap);             vram_put (_z);
;
	ldy     #0
	lda     (_gp_tmap),y
	sta     __z
	jmp     _vram_put

.endproc

; ---------------------------------------------------------------
; void __near__ update_list_tile (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_update_list_tile: near

.segment	"CODE"

;
; if (_x > 31) {
;
	lda     __x
	cmp     #$20
	bcc     L086F
;
; _x -= 32;
;
	lda     __x
	sec
	sbc     #$20
	sta     __x
;
; NAMETABLE_BASE = 0x2400;
;
	ldx     #$24
	lda     #$00
	sta     _nametable_base
	stx     _nametable_base+1
;
; attr_table_offset = 64;
;
	lda     #$40
;
; } else {
;
	jmp     L1762
;
; NAMETABLE_BASE = 0x2000;
;
L086F:	ldx     #$20
	lda     #$00
	sta     _nametable_base
	stx     _nametable_base+1
;
; attr_table_offset = 0;
;
L1762:	sta     _attr_table_offset
;
; upd_attr_table ();
;
	jsr     _upd_attr_table
;
; gp_addr = (NAMETABLE_BASE + 0x03c0) + rdc;
;
	lda     _nametable_base
	clc
	adc     #$C0
	pha
	lda     _nametable_base+1
	adc     #$03
	tax
	pla
	clc
	adc     _rdc
	bcc     L1760
	inx
L1760:	sta     _gp_addr
	stx     _gp_addr+1
;
; _n = rda; ul_putc ();
;
	lda     _rda
	sta     __n
	jsr     _ul_putc
;
; gp_tmap = c_ts_tmaps + (_t << 2);
;
	ldx     #$00
	lda     __t
	jsr     aslax2
	clc
	adc     _c_ts_tmaps
	sta     _gp_tmap
	txa
	adc     _c_ts_tmaps+1
	sta     _gp_tmap+1
;
; gp_addr = ((_y << 5) + _x + NAMETABLE_BASE);
;
	ldx     #$00
	lda     __y
	jsr     aslax4
	stx     tmp1
	asl     a
	rol     tmp1
	ldx     tmp1
	clc
	adc     __x
	bcc     L1763
	inx
	clc
L1763:	adc     _nametable_base
	sta     _gp_addr
	txa
	adc     _nametable_base+1
	sta     _gp_addr+1
;
; SET_FROM_PTR (_n, gp_tmap); gp_tmap ++; ul_putc ();
;
	ldy     #0
	lda     (_gp_tmap),y
	sta     __n
	lda     _gp_tmap
	ldx     _gp_tmap+1
	clc
	adc     #$01
	bcc     L088E
	inx
L088E:	sta     _gp_tmap
	stx     _gp_tmap+1
	jsr     _ul_putc
;
; SET_FROM_PTR (_n, gp_tmap); gp_tmap ++; ul_putc ();
;
	ldy     #0
	lda     (_gp_tmap),y
	sta     __n
	lda     _gp_tmap
	ldx     _gp_tmap+1
	clc
	adc     #$01
	bcc     L0894
	inx
L0894:	sta     _gp_tmap
	stx     _gp_tmap+1
	jsr     _ul_putc
;
; gp_addr += 30;
;
	lda     #$1E
	clc
	adc     _gp_addr
	sta     _gp_addr
	bcc     L0898
	inc     _gp_addr+1
;
; SET_FROM_PTR (_n, gp_tmap); gp_tmap ++; ul_putc ();
;
L0898:	ldy     #0
	lda     (_gp_tmap),y
	sta     __n
	lda     _gp_tmap
	ldx     _gp_tmap+1
	clc
	adc     #$01
	bcc     L089D
	inx
L089D:	sta     _gp_tmap
	stx     _gp_tmap+1
	jsr     _ul_putc
;
; SET_FROM_PTR (_n, gp_tmap);             ul_putc ();
;
	ldy     #0
	lda     (_gp_tmap),y
	sta     __n
	jmp     _ul_putc

.endproc

; ---------------------------------------------------------------
; void __near__ map_set (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_map_set: near

.segment	"CODE"

;
; map_buff [COORDS (_x, _y)] = _t;
;
	lda     __x
	cmp     #$10
	bcc     L08A7
	lda     __x
	and     #$0F
	sta     ptr1
	ldx     #$00
	lda     __y
	jsr     aslax4
	ora     ptr1
	clc
	adc     #$C0
	bcc     L1766
	inx
	jmp     L08B0
L08A7:	ldx     #$00
	lda     __y
	jsr     aslax4
	ora     __x
L08B0:	clc
L1766:	adc     #<(_map_buff)
	sta     ptr1
	txa
	adc     #>(_map_buff)
	sta     ptr1+1
	lda     __t
	ldy     #$00
	sta     (ptr1),y
;
; map_attr [COORDS (_x, _y)] = c_behs [_t];
;
	lda     __x
	cmp     #$10
	bcc     L08BA
	lda     __x
	and     #$0F
	sta     ptr1
	ldx     #$00
	lda     __y
	jsr     aslax4
	ora     ptr1
	clc
	adc     #$C0
	bcc     L1767
	inx
	jmp     L08C3
L08BA:	ldx     #$00
	lda     __y
	jsr     aslax4
	ora     __x
L08C3:	clc
L1767:	adc     #<(_map_attr)
	tay
	txa
	adc     #>(_map_attr)
	tax
	tya
	jsr     pushax
	lda     _c_behs
	ldx     _c_behs+1
	ldy     __t
	sta     ptr1
	stx     ptr1+1
	lda     (ptr1),y
	ldy     #$00
	jsr     staspidx
;
; _x = _x << 1; _y = TOP_ADJUST + (_y << 1);
;
	lda     __x
	asl     a
	sta     __x
	lda     __y
	asl     a
	bcc     L1768
	clc
L1768:	adc     #$04
	sta     __y
;
; update_list_tile (); 
;
	jmp     _update_list_tile

.endproc

; ---------------------------------------------------------------
; unsigned char __near__ get_byte (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_get_byte: near

.segment	"CODE"

;
; -- rdit; return *gp_gen ++;
;
	dec     _rdit
	lda     _gp_gen
	ldx     _gp_gen+1
	sta     regsave
	stx     regsave+1
	clc
	adc     #$01
	bcc     L08D5
	inx
L08D5:	sta     _gp_gen
	stx     _gp_gen+1
	ldx     #$00
	lda     (regsave,x)
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ add_tile (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_add_tile: near

.segment	"CODE"

;
; buff_ptr [rdm] = rda;
;
	lda     _buff_ptr
	ldx     _buff_ptr+1
	clc
	adc     _rdm
	bcc     L1769
	inx
L1769:	sta     ptr1
	stx     ptr1+1
	lda     _rda
	ldy     #$00
	sta     (ptr1),y
;
; ++ rdm;
;
	inc     _rdm
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ draw_half_scr (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_draw_half_scr: near

.segment	"CODE"

;
; buff_ptr = map_buff + buff_offset;
;
	lda     _buff_offset
	clc
	adc     #<(_map_buff)
	sta     _buff_ptr
	lda     _buff_offset+1
	adc     #>(_map_buff)
	sta     _buff_ptr+1
;
; attr_ptr = map_attr + buff_offset;
;
	lda     _buff_offset
	clc
	adc     #<(_map_attr)
	sta     _attr_ptr
	lda     _buff_offset+1
	adc     #>(_map_attr)
	sta     _attr_ptr+1
;
; rdm = 0;
;
	lda     #$00
	sta     _rdm
;
; rdx = rdy = 0;
;
	sta     _rdy
	sta     _rdx
;
; gp_gen = c_map [n_pant];
;
	tax
	lda     _n_pant
	asl     a
	bcc     L176E
	inx
	clc
L176E:	adc     _c_map
	sta     ptr1
	txa
	adc     _c_map+1
	sta     ptr1+1
	ldy     #$01
	lda     (ptr1),y
	tax
	dey
	lda     (ptr1),y
	sta     _gp_gen
	stx     _gp_gen+1
;
; if (rdit = *gp_gen ++) {
;
	sta     regsave
	stx     regsave+1
	clc
	adc     #$01
	bcc     L08EB
	inx
L08EB:	sta     _gp_gen
	stx     _gp_gen+1
	lda     (regsave),y
	sta     _rdit
	tax
	beq     L08E8
;
; while (rdit) {
;
L08EC:	lda     _rdit
	jeq     L0911
;
; rdct = get_byte ();
;
	jsr     _get_byte
	sta     _rdct
;
; if (rdct & 0xf0) {
;
	and     #$F0
	beq     L08F1
;
; rdct = 1 + (rdct & 0x0f);
;
	lda     _rdct
	and     #$0F
	clc
	adc     #$01
	sta     _rdct
;
; while (rdct --) {
;
L08F7:	lda     _rdct
	pha
	sec
	sbc     #$01
	sta     _rdct
	pla
	tax
	beq     L08EC
;
; rdt = get_byte ();
;
	jsr     _get_byte
	sta     _rdt
;
; rda = rdt >> 4; add_tile ();
;
	ldx     #$00
	lda     _rdt
	jsr     asrax4
	sta     _rda
	jsr     _add_tile
;
; if (rdy < 12) { rda = rdt & 15;  add_tile (); }
;
	lda     _rdy
	cmp     #$0C
	bcs     L08F7
	lda     _rdt
	and     #$0F
	sta     _rda
	jsr     _add_tile
;
; }
;
	jmp     L08F7
;
; rda = rdct & 0x0f;
;
L08F1:	lda     _rdct
	and     #$0F
	sta     _rda
;
; rdct = get_byte ();
;
	jsr     _get_byte
	sta     _rdct
;
; while (rdct --) add_tile ();
;
L0909:	lda     _rdct
	pha
	sec
	sbc     #$01
	sta     _rdct
	pla
	tax
	beq     L08EC
	jsr     _add_tile
	jmp     L0909
;
; rdit = 96; while (rdit --) {
;
L08E8:	lda     #$60
	sta     _rdit
L0910:	lda     _rdit
	pha
	sec
	sbc     #$01
	sta     _rdit
	pla
	tax
	beq     L0911
;
; rdt = *gp_gen ++;
;
	lda     _gp_gen
	ldx     _gp_gen+1
	sta     regsave
	stx     regsave+1
	clc
	adc     #$01
	bcc     L0915
	inx
L0915:	sta     _gp_gen
	stx     _gp_gen+1
	ldy     #$00
	lda     (regsave),y
	sta     _rdt
;
; rda = rdt >> 4; add_tile ();
;
	ldx     #$00
	lda     _rdt
	jsr     asrax4
	sta     _rda
	jsr     _add_tile
;
; rda = rdt & 15; add_tile ();
;
	lda     _rdt
	and     #$0F
	sta     _rda
	jsr     _add_tile
;
; }
;
	jmp     L0910
;
; gp_gen = c_locks; rda = 0;
;
L0911:	lda     _c_locks
	sta     _gp_gen
	lda     _c_locks+1
	sta     _gp_gen+1
	lda     #$00
	sta     _rda
;
; gpit = c_max_bolts; while (gpit --) {
;
	lda     _c_max_bolts
	sta     _gpit
L0922:	lda     _gpit
	pha
	sec
	sbc     #$01
	sta     _gpit
	pla
	tax
	beq     L0923
;
; SET_FROM_PTR (rdb, gp_gen); gp_gen ++;
;
	ldy     #0
	lda     (_gp_gen),y
	sta     _rdb
	lda     _gp_gen
	ldx     _gp_gen+1
	clc
	adc     #$01
	bcc     L0929
	inx
L0929:	sta     _gp_gen
	stx     _gp_gen+1
;
; SET_FROM_PTR (rdm, gp_gen); gp_gen ++;
;
	lda     (_gp_gen),y
	sta     _rdm
	lda     _gp_gen
	ldx     _gp_gen+1
	clc
	adc     #$01
	bcc     L092E
	inx
L092E:	sta     _gp_gen
	stx     _gp_gen+1
;
; if (n_pant == rdb) {
;
	lda     _rdb
	cmp     _n_pant
	bne     L0922
;
; if (!lkact [gpit]) add_tile ();
;
	ldy     _gpit
	lda     _lkact,y
	bne     L0922
	jsr     _add_tile
;
; } 
;
	jmp     L0922
;
; _x = 0; _y = TOP_ADJUST; 
;
L0923:	sta     __x
	lda     #$04
	sta     __y
;
; gp_ram = buff_ptr;
;
	lda     _buff_ptr
	sta     _gp_ram
	lda     _buff_ptr+1
	sta     _gp_ram+1
;
; for (rdm = 0; rdm < 192; rdm ++) {
;
	txa
L176F:	sta     _rdm
	cmp     #$C0
	bcs     L093D
;
; SET_FROM_PTR (rdt, gp_ram); gp_ram ++;
;
	ldy     #0
	lda     (_gp_ram),y
	sta     _rdt
	lda     _gp_ram
	ldx     _gp_ram+1
	clc
	adc     #$01
	bcc     L0948
	inx
L0948:	sta     _gp_ram
	stx     _gp_ram+1
;
; attr_ptr [rdm] = c_behs [rdt];
;
	lda     _attr_ptr
	ldx     _attr_ptr+1
	clc
	adc     _rdm
	bcc     L176A
	inx
L176A:	jsr     pushax
	lda     _c_behs
	ldx     _c_behs+1
	ldy     _rdt
	sta     ptr1
	stx     ptr1+1
	lda     (ptr1),y
	ldy     #$00
	jsr     staspidx
;
; _t = rdt; draw_tile ();
;
	lda     _rdt
	sta     __t
	jsr     _draw_tile
;
; _x = (_x + 2) & 0x1f; if (!_x) _y += 2;
;
	lda     __x
	clc
	adc     #$02
	and     #$1F
	sta     __x
	lda     __x
	bne     L093E
	lda     #$02
	clc
	adc     __y
	sta     __y
;
; for (rdm = 0; rdm < 192; rdm ++) {
;
L093E:	lda     _rdm
	clc
	adc     #$01
	jmp     L176F
;
; vram_write (attr_table + attr_table_offset, NAMETABLE_BASE + 0x3c0, 64);
;
L093D:	jsr     decsp4
	lda     _attr_table_offset
	clc
	adc     #<(_attr_table)
	tay
	lda     #$00
	adc     #>(_attr_table)
	tax
	tya
	ldy     #$02
	sta     (sp),y
	iny
	txa
	sta     (sp),y
	lda     _nametable_base
	clc
	adc     #$C0
	pha
	lda     _nametable_base+1
	adc     #$03
	tax
	pla
	ldy     #$00
	sta     (sp),y
	iny
	txa
	sta     (sp),y
	ldx     #$00
	lda     #$40
	jmp     _vram_write

.endproc

; ---------------------------------------------------------------
; void __near__ draw_scr (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_draw_scr: near

.segment	"CODE"

;
; w_pant = n_pant;
;
	lda     _n_pant
	sta     _w_pant
;
; nametable_base = 0x2000;
;
	ldx     #$20
	lda     #$00
	sta     _nametable_base
	stx     _nametable_base+1
;
; buff_offset = attr_table_offset = 0;
;
	sta     _attr_table_offset
	sta     _buff_offset
	sta     _buff_offset+1
;
; draw_half_scr ();
;
	jsr     _draw_half_scr
;
; n_pant ++;
;
	lda     _n_pant
	clc
	adc     #$01
	sta     _n_pant
;
; nametable_base = 0x2400;
;
	ldx     #$24
	lda     #$00
	sta     _nametable_base
	stx     _nametable_base+1
;
; buff_offset = 192;
;
	sta     _buff_offset+1
	lda     #$C0
	sta     _buff_offset
;
; attr_table_offset = 64;
;
	lda     #$40
	sta     _attr_table_offset
;
; draw_half_scr ();
;
	jsr     _draw_half_scr
;
; n_pant = w_pant; 
;
	lda     _w_pant
	sta     _n_pant
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ pr_str (__near__ unsigned char*)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_pr_str: near

.segment	"CODE"

;
; vram_adr (((_y << 5) | _x) + 0x2000);
;
L177F:	ldx     #$00
	lda     __y
	jsr     aslax4
	stx     tmp1
	asl     a
	rol     tmp1
	sta     ptr1
	lda     __x
	ora     ptr1
	pha
	lda     tmp1
	clc
	adc     #$20
	tax
	pla
	jsr     _vram_adr
;
; while (gpit = *s++) {
;
L0974:	ldy     #$01
	lda     (sp),y
	tax
	dey
	lda     (sp),y
	sta     regsave
	stx     regsave+1
	clc
	adc     #$01
	bcc     L0978
	inx
L0978:	jsr     stax0sp
	ldy     #$00
	lda     (regsave),y
	sta     _gpit
	tax
	jeq     incsp2
;
; if (gpit == '%') {
;
	lda     _gpit
	cmp     #$25
	bne     L0979
;
; ++ _y; vram_adr (((_y << 5) | _x) + 0x2000);
;
	inc     __y
;
; else vram_put (gpit - 32); 
;
	jmp     L177F
L0979:	lda     _gpit
	sec
	sbc     #$20
	jsr     _vram_put
;
; }
;
	jmp     L0974

.endproc

; ---------------------------------------------------------------
; unsigned char __near__ get_hex_digit (unsigned char)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_get_hex_digit: near

.segment	"CODE"

;
; if (n < 10) return n + 16;
;
	ldy     #$00
	lda     (sp),y
	cmp     #$0A
	bcs     L0985
	ldx     #$00
	lda     (sp),y
	clc
	adc     #$10
	jmp     L1781
;
; return n + 23;
;
L0985:	ldx     #$00
	lda     (sp),y
	clc
	adc     #$17
L1781:	jcc     incsp1
	inx
;
; }
;
	jmp     incsp1

.endproc

; ---------------------------------------------------------------
; void __near__ debug_print_hex_16_dl (unsigned char, unsigned char, unsigned int)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_debug_print_hex_16_dl: near

.segment	"CODE"

;
; clear_update_list ();
;
	jsr     _clear_update_list
;
; gp_addr = (y << 5) + x + 0x2000;
;
	ldy     #$02
	ldx     #$00
	lda     (sp),y
	jsr     aslax4
	stx     tmp1
	asl     a
	rol     tmp1
	sta     ptr1
	iny
	lda     (sp),y
	clc
	adc     ptr1
	ldx     tmp1
	bcc     L1782
	inx
L1782:	sta     _gp_addr
	txa
	clc
	adc     #$20
	sta     _gp_addr+1
;
; _n = get_hex_digit (n >> 12);    ul_putc ();
;
	ldy     #$01
	lda     (sp),y
	lsr     a
	lsr     a
	lsr     a
	lsr     a
	jsr     pusha
	jsr     _get_hex_digit
	sta     __n
	jsr     _ul_putc
;
; _n = get_hex_digit ((n >> 8) & 0xf);  ul_putc ();
;
	ldy     #$01
	lda     (sp),y
	and     #$0F
	jsr     pusha
	jsr     _get_hex_digit
	sta     __n
	jsr     _ul_putc
;
; _n = get_hex_digit ((n >> 4) & 0xf);  ul_putc ();
;
	ldy     #$01
	lda     (sp),y
	tax
	dey
	lda     (sp),y
	jsr     shrax4
	and     #$0F
	jsr     pusha
	jsr     _get_hex_digit
	sta     __n
	jsr     _ul_putc
;
; _n = get_hex_digit ((n & 0xf));   ul_putc ();
;
	ldy     #$00
	lda     (sp),y
	and     #$0F
	jsr     pusha
	jsr     _get_hex_digit
	sta     __n
	jsr     _ul_putc
;
; ppu_waitnmi ();
;
	jsr     _ppu_waitnmi
;
; }
;
	jmp     incsp4

.endproc

; ---------------------------------------------------------------
; void __near__ cm_two_points (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_cm_two_points: near

.segment	"CODE"

;
; if (cy1 > 12 || cy2 > 12) { at1 = at2 = 0; return; }
;
	lda     _cy1
	cmp     #$0D
	bcs     L09A6
	lda     _cy2
	cmp     #$0D
	bcc     L09A5
L09A6:	lda     #$00
	sta     _at2
	sta     _at1
	rts
;
; at1 = map_attr [COORDS (cx1, cy1 ? cy1 - 1 : 0)];
;
L09A5:	lda     _cx1
	cmp     #$10
	bcc     L09AF
	lda     _cx1
	and     #$0F
	sta     ptr1
	lda     _cy1
	beq     L09B7
	ldx     #$00
	lda     _cy1
	sec
	sbc     #$01
	bcs     L09BA
	dex
	jmp     L09BA
L09B7:	tax
L09BA:	jsr     shlax4
	ora     ptr1
	clc
	adc     #$C0
	bcc     L09BD
	inx
	jmp     L09BD
L09AF:	lda     _cy1
	beq     L09C3
	ldx     #$00
	lda     _cy1
	sec
	sbc     #$01
	bcs     L09C6
	dex
	jmp     L09C6
L09C3:	tax
L09C6:	jsr     shlax4
	ora     _cx1
L09BD:	sta     ptr1
	txa
	clc
	adc     #>(_map_attr)
	sta     ptr1+1
	ldy     #<(_map_attr)
	lda     (ptr1),y
	sta     _at1
;
; at2 = map_attr [COORDS (cx2, cy2 ? cy2 - 1 : 0)];
;
	lda     _cx2
	cmp     #$10
	bcc     L09CC
	lda     _cx2
	and     #$0F
	sta     ptr1
	lda     _cy2
	beq     L09D4
	ldx     #$00
	lda     _cy2
	sec
	sbc     #$01
	bcs     L09D7
	dex
	jmp     L09D7
L09D4:	tax
L09D7:	jsr     shlax4
	ora     ptr1
	clc
	adc     #$C0
	bcc     L09DA
	inx
	jmp     L09DA
L09CC:	lda     _cy2
	beq     L09E0
	ldx     #$00
	lda     _cy2
	sec
	sbc     #$01
	bcs     L09E3
	dex
	jmp     L09E3
L09E0:	tax
L09E3:	jsr     shlax4
	ora     _cx2
L09DA:	sta     ptr1
	txa
	clc
	adc     #>(_map_attr)
	sta     ptr1+1
	ldy     #<(_map_attr)
	lda     (ptr1),y
	sta     _at2
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; unsigned char __near__ collide (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_collide: near

.segment	"CODE"

;
; prx + 3 >= EN_X_ABSOLUTE && 
;
	lda     _prx
	ldx     _prx+1
	clc
	adc     #$03
	bcc     L09E8
	inx
L09E8:	cmp     _rdaa
	txa
	sbc     _rdaa+1
	bcc     L09E9
;
; prx <= EN_X_ABSOLUTE + 11 && 
;
	lda     _prx
	ldx     _prx+1
	jsr     pushax
	lda     _rdaa
	ldx     _rdaa+1
	clc
	adc     #$0B
	bcc     L09EA
	inx
L09EA:	jsr     tosicmp
	beq     L1784
	bcs     L09E9
;
; pry + 13 + ENEMS_COLLISION_VSTRETCH_FG >= _en_y &&
;
L1784:	ldx     #$00
	lda     _pry
	clc
	adc     #$0D
	bcc     L09EB
	inx
L09EB:	cmp     __en_y
	txa
	sbc     #$00
	bcc     L09E9
;
; pry <= _en_y + 13 + PLAYER_COLLISION_VSTRETCH_FG
;
	lda     _pry
	jsr     pusha0
	lda     __en_y
	clc
	adc     #$0D
	bcc     L1783
	ldx     #$01
;
; );
;
	clc
L1783:	adc     #$04
	bcc     L09ED
	inx
L09ED:	jsr     tosicmp
	bcc     L09E7
	beq     L09E7
L09E9:	ldx     #$00
	txa
	rts
L09E7:	ldx     #$00
	lda     #$01
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; int __near__ add_sign (int, int)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_add_sign: near

.segment	"CODE"

;
; return sign == 0 ? 0 : sign < 0 ? -value : value;
;
	ldy     #$03
	lda     (sp),y
	tax
	dey
	lda     (sp),y
	cpx     #$00
	bne     L09F2
	cmp     #$00
	jeq     incsp4
L09F2:	iny
	lda     (sp),y
	tax
	cpx     #$80
	bcc     L09F6
	ldy     #$01
	lda     (sp),y
	tax
	dey
	lda     (sp),y
	jsr     negax
	jmp     incsp4
L09F6:	ldy     #$01
	lda     (sp),y
	tax
	dey
	lda     (sp),y
;
; }
;
	jmp     incsp4

.endproc

; ---------------------------------------------------------------
; int __near__ saturate (int, int)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_saturate: near

.segment	"CODE"

;
; return v >= 0 ? (v > max ? max : v) : (v < -max ? -max : v);
;
	ldy     #$03
	lda     (sp),y
	bmi     L09FC
	lda     (sp),y
	tax
	dey
	lda     (sp),y
	jsr     pushax
	ldy     #$03
	lda     (sp),y
	tax
	dey
	lda     (sp),y
	jsr     tosicmp
	bmi     L0A06
	beq     L0A06
	ldy     #$01
	jmp     L178B
L09FC:	lda     (sp),y
	tax
	dey
	lda     (sp),y
	jsr     pushax
	ldy     #$03
	lda     (sp),y
	tax
	dey
	lda     (sp),y
	jsr     negax
	jsr     tosicmp
	bpl     L0A06
	ldy     #$01
	lda     (sp),y
	tax
	dey
	lda     (sp),y
	jsr     negax
	jmp     incsp4
L0A06:	ldy     #$03
L178B:	lda     (sp),y
	tax
	dey
	lda     (sp),y
;
; }
;
	jmp     incsp4

.endproc

; ---------------------------------------------------------------
; void __near__ pad_read (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_pad_read: near

.segment	"CODE"

;
; pad_this_frame = pad0;
;
	lda     _pad0
	sta     _pad_this_frame
;
; pad0 = pad_poll (0);   // Read pads here.
;
	lda     #$00
	jsr     _pad_poll
	sta     _pad0
;
; pad_this_frame = (pad_this_frame ^ pad0) & pad0;
;
	eor     _pad_this_frame
	sta     ptr1
	lda     _pad0
	and     ptr1
	sta     _pad_this_frame
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; unsigned char __near__ distance (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_distance: near

.segment	"CODE"

;
; rda = DELTA (prx, rdx); // dx
;
	lda     _prx
	cmp     _rdx
	lda     _prx+1
	sbc     #$00
	bcs     L0A19
	lda     _rdx
	sec
	sbc     _prx
	pha
	lda     #$00
	sbc     _prx+1
	jmp     L178D
L0A19:	lda     _prx
	sec
	sbc     _rdx
	pha
	lda     _prx+1
	sbc     #$00
L178D:	pla
	sta     _rda
;
; rdb = DELTA (pry, rdy); // dy
;
	ldx     #$00
	lda     _pry
	cmp     _rdy
	bcs     L0A26
	lda     _rdy
	sec
	sbc     _pry
	jmp     L1791
L0A26:	lda     _pry
	sec
	sbc     _rdy
L1791:	sta     _rdb
;
; rdc = MIN (rda, rdb);
;
	lda     _rda
	cmp     _rdb
	bcs     L0A33
	lda     _rda
	jmp     L178F
L0A33:	lda     _rdb
L178F:	sta     _rdc
;
; return (rda + rdb - (rdc >> 1) - (rdc >> 2) + (rdc >> 4));
;
	lda     _rda
	clc
	adc     _rdb
	bcc     L178C
	inx
L178C:	jsr     pushax
	ldx     #$00
	lda     _rdc
	jsr     asrax1
	jsr     tossubax
	jsr     pushax
	ldx     #$00
	lda     _rdc
	jsr     asrax2
	jsr     tossubax
	sta     ptr1
	stx     ptr1+1
	ldx     #$00
	lda     _rdc
	jsr     asrax4
	clc
	adc     ptr1
	pha
	txa
	adc     ptr1+1
	tax
	pla
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ jump_start (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_jump_start: near

.segment	"CODE"

;
; pj = 1; pctj = 0; 
;
	lda     #$01
	sta     _pj
	lda     #$00
	sta     _pctj
;
; sfx_play (SFX_JUMP, 0);
;
	lda     #$08
	jsr     pusha
	lda     #$00
	jsr     _sfx_play
;
; pvy = -PLAYER_VY_JUMP_INITIAL;
;
	ldx     #$FF
	lda     #$C0
	sta     _pvy
	stx     _pvy+1
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ update_cycle (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_update_cycle: near

.segment	"CODE"

;
; scroll (scroll_x, SCROLL_Y);
;
	lda     _scroll_x
	ldx     _scroll_x+1
	jsr     pushax
	ldx     #$00
	lda     #$08
	jsr     _scroll
;
; oam_hide_rest (oam_index);
;
	lda     _oam_index
	jsr     _oam_hide_rest
;
; ppu_mask (0x1e);
;
	lda     #$1E
	jsr     _ppu_mask
;
; ppu_waitnmi ();
;
	jsr     _ppu_waitnmi
;
; ppu_mask (0x1f);
;
	lda     #$1F
	jsr     _ppu_mask
;
; clear_update_list ();
;
	jsr     _clear_update_list
;
; oam_index = 4;
;
	lda     #$04
	sta     _oam_index
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ calc_scroll_pos (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_calc_scroll_pos: near

.segment	"CODE"

;
; scroll_x = prx - 124;
;
	lda     _prx
	ldx     _prx+1
	sec
	sbc     #$7C
	bcs     L0A59
	dex
L0A59:	sta     _scroll_x
	stx     _scroll_x+1
;
; if (scroll_x < 0) scroll_x = 0;
;
	cpx     #$80
	bcc     L0A5A
	ldx     #$00
;
; else if (scroll_x > 256) scroll_x = 256; 
;
	jmp     L1794
L0A5A:	lda     _scroll_x
	cmp     #$01
	lda     _scroll_x+1
	sbc     #$01
	bvs     L0A61
	eor     #$80
L0A61:	bpl     L0A5F
	ldx     #$01
L1794:	lda     #$00
	sta     _scroll_x
	stx     _scroll_x+1
;
; }
;
L0A5F:	rts

.endproc

; ---------------------------------------------------------------
; void __near__ calc_en_x_absolute (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_calc_en_x_absolute: near

.segment	"CODE"

;
; if (_en_t == 6 || _en_t == 13) {
;
	lda     __en_t
	cmp     #$06
	beq     L0A66
	lda     __en_t
	cmp     #$0D
	bne     L0A65
;
; EN_X_ABSOLUTE = _enf_x >> FIXBITS;
;
L0A66:	lda     __enf_x
	ldx     __enf_x+1
	jsr     asrax4
	jsr     asrax2
;
; } else 
;
	jmp     L1795
;
; EN_X_ABSOLUTE = en_x_offs + _en_x;
;
L0A65:	lda     _en_x_offs
	ldx     _en_x_offs+1
	clc
	adc     __en_x
	bcc     L1795
	inx
L1795:	sta     _rdaa
	stx     _rdaa+1
;
; on_screen = (EN_X_ABSOLUTE >= scroll_x && EN_X_ABSOLUTE < scroll_x + 240);
;
	lda     _rdaa
	cmp     _scroll_x
	lda     _rdaa+1
	sbc     _scroll_x+1
	bvs     L1796
	eor     #$80
L1796:	bpl     L0A70
	lda     _rdaa
	ldx     _rdaa+1
	jsr     pushax
	lda     _scroll_x
	ldx     _scroll_x+1
	clc
	adc     #$F0
	bcc     L0A71
	inx
L0A71:	jsr     tosicmp
	bmi     L0A6F
L0A70:	lda     #$00
	jmp     L0A72
L0A6F:	lda     #$01
L0A72:	sta     _on_screen
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ breakable_do_anim (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_breakable_do_anim: near

.segment	"CODE"

;
; do_process_breakable = 0;
;
	lda     #$00
	sta     _do_process_breakable
;
; gpit = BREAKABLE_MAX; while (gpit --) {
;
	lda     #$04
	sta     _gpit
L0A78:	lda     _gpit
	pha
	sec
	sbc     #$01
	sta     _gpit
	pla
	tax
	beq     L0A79
;
; if (brkf [gpit]) {
;
	ldy     _gpit
	lda     _brkf,y
	beq     L0A78
;
; ++ brkf [gpit];
;
	lda     #<(_brkf)
	ldx     #>(_brkf)
	clc
	adc     _gpit
	bcc     L0A81
	inx
L0A81:	sta     ptr1
	stx     ptr1+1
	ldy     #$00
	lda     #$01
	clc
	adc     (ptr1),y
	sta     (ptr1),y
;
; if (brkf [gpit] == BREAKABLE_MAX_FRAMES) {
;
	ldy     _gpit
	lda     _brkf,y
	cmp     #$08
	bne     L0A82
;
; brkf [gpit] = 0;
;
	ldy     _gpit
	lda     #$00
	sta     _brkf,y
;
; _x = brkx [gpit]; _y = brky [gpit]; _t = BREAKABLE_ERASE;
;
	ldy     _gpit
	lda     _brkx,y
	sta     __x
	ldy     _gpit
	lda     _brky,y
	sta     __y
	lda     #$00
	sta     __t
;
; map_set ();
;
	jsr     _map_set
;
; } else {
;
	jmp     L0A78
;
; do_process_breakable = 1;
;
L0A82:	lda     #$01
	sta     _do_process_breakable
;
; }
;
	jmp     L0A78
;
; }
;
L0A79:	rts

.endproc

; ---------------------------------------------------------------
; void __near__ breakable_break (unsigned char, unsigned char)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_breakable_break: near

.segment	"CODE"

;
; gpaux = COORDS (x, y);
;
	ldy     #$01
	lda     (sp),y
	cmp     #$10
	bcc     L0A9C
	lda     (sp),y
	and     #$0F
	sta     ptr1
	ldx     #$00
	lda     (sp,x)
	jsr     aslax4
	ora     ptr1
	clc
	adc     #$C0
	jmp     L0AA5
L0A9C:	ldx     #$00
	lda     (sp,x)
	jsr     aslax4
	ldy     #$01
	ora     (sp),y
L0AA5:	sta     _gpaux
;
; sfx_play (SFX_BREAKH, 1);
;
	lda     #$0D
	jsr     pusha
	lda     #$01
	jsr     _sfx_play
;
; gpit = BREAKABLE_MAX; while (gpit --) {
;
	lda     #$04
	sta     _gpit
L0AB0:	lda     _gpit
	pha
	sec
	sbc     #$01
	sta     _gpit
	pla
	tax
	jeq     incsp2
;
; if (!brkf [gpit]) {
;
	ldy     _gpit
	lda     _brkf,y
	bne     L0AB0
;
; do_process_breakable = 1;
;
	lda     #$01
	sta     _do_process_breakable
;
; brkf [gpit] = 1;
;
	ldy     _gpit
	sta     _brkf,y
;
; _x = brkx [gpit] = x;
;
	lda     #<(_brkx)
	ldx     #>(_brkx)
	clc
	adc     _gpit
	bcc     L0AC0
	inx
L0AC0:	sta     ptr1
	stx     ptr1+1
	ldy     #$01
	lda     (sp),y
	dey
	sta     (ptr1),y
	sta     __x
;
; _y = brky [gpit] = y;
;
	lda     #<(_brky)
	ldx     #>(_brky)
	clc
	adc     _gpit
	bcc     L0AC5
	inx
L0AC5:	sta     ptr1
	stx     ptr1+1
	lda     (sp),y
	sta     (ptr1),y
	sta     __y
;
; _t = BREAKABLE_BREAKING;
;
	lda     #$08
	sta     __t
;
; map_set ();     // Break tile!
;
	jsr     _map_set
;
; sfx_play (SFX_BREAKB, 1);
;
	lda     #$11
	jsr     pusha
	lda     #$01
	jsr     _sfx_play
;
; break;      // HA HA HA
;
	jmp     incsp2

.endproc

; ---------------------------------------------------------------
; void __near__ hotspots_load (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_hotspots_load: near

.segment	"CODE"

;
; gp_gen = (unsigned char *) c_hotspots;
;
	lda     _c_hotspots
	sta     _gp_gen
	lda     _c_hotspots+1
	sta     _gp_gen+1
;
; for (gpit = 0; gpit < MAP_SIZE; gpit ++) {
;
	lda     #$00
L1798:	sta     _gpit
	cmp     #$08
	bcs     L0AD1
;
; ht [gpit] = *gp_gen ++;
;
	lda     #<(_ht)
	ldx     #>(_ht)
	clc
	adc     _gpit
	bcc     L0ADA
	inx
L0ADA:	jsr     pushax
	lda     _gp_gen
	ldx     _gp_gen+1
	sta     regsave
	stx     regsave+1
	clc
	adc     #$01
	bcc     L0ADC
	inx
L0ADC:	sta     _gp_gen
	stx     _gp_gen+1
	ldy     #$00
	lda     (regsave),y
	jsr     staspidx
;
; hyx [gpit] = *gp_gen ++;
;
	lda     #<(_hyx)
	ldx     #>(_hyx)
	clc
	adc     _gpit
	bcc     L0ADF
	inx
L0ADF:	jsr     pushax
	lda     _gp_gen
	ldx     _gp_gen+1
	sta     regsave
	stx     regsave+1
	clc
	adc     #$01
	bcc     L0AE1
	inx
L0AE1:	sta     _gp_gen
	stx     _gp_gen+1
	ldy     #$00
	lda     (regsave),y
	jsr     staspidx
;
; hact [gpit] = 1;
;
	ldy     _gpit
	lda     #$01
	sta     _hact,y
;
; for (gpit = 0; gpit < MAP_SIZE; gpit ++) {
;
	lda     _gpit
	clc
	adc     #$01
	jmp     L1798
;
; }
;
L0AD1:	rts

.endproc

; ---------------------------------------------------------------
; void __near__ hotspots_paint (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_hotspots_paint: near

.segment	"CODE"

;
; if (hrt >= HS_OBJ_MIN + 2*HS_USE_OFFS && hrt <= HS_OBJ_MAX + 2*HS_USE_OFFS) 
;
	lda     _hrt
	cmp     #$09
	bcc     L0AE7
	lda     _hrt
	cmp     #$0B
	bcs     L0AE7
;
; rda = hrt - 2*HS_USE_OFFS;
;
	lda     _hrt
	sec
	sbc     #$04
	bcs     L179A
;
; else if (hrt >= HS_OBJ_MIN + HS_USE_OFFS && hrt <= HS_OBJ_MAX + HS_USE_OFFS) 
;
	jmp     L179A
L0AE7:	lda     _hrt
	cmp     #$07
	bcc     L0AEF
	lda     _hrt
	cmp     #$09
	bcs     L0AEF
;
; rda = HS_OBJ_EMPTY;
;
	lda     #$04
;
; else
;
	jmp     L179A
;
; rda = hrt;
;
L0AEF:	lda     _hrt
L179A:	sta     _rda
;
; hrx - scroll_x,
;
	jsr     decsp3
	lda     _hrx
	sec
	sbc     _scroll_x
	pha
	lda     _hrx+1
	sbc     _scroll_x+1
	pla
	ldy     #$02
	sta     (sp),y
;
; hry + SPRITE_ADJUST, 
;
	lda     _hry
	clc
	adc     #$20
	sec
	sbc     #$08
	bcs     L179B
	sec
L179B:	sbc     #$10
	bcs     L179C
	sec
L179C:	sbc     #$01
	dey
	sta     (sp),y
;
; oam_index, 
;
	lda     _oam_index
	dey
	sta     (sp),y
;
; spr_hs [rda]
;
	ldx     #$00
	lda     _rda
	asl     a
	bcc     L179D
	inx
	clc
L179D:	adc     #<(_spr_hs)
;
; );
;
	sta     ptr1
;
; spr_hs [rda]
;
	txa
	adc     #>(_spr_hs)
;
; );
;
	sta     ptr1+1
	iny
	lda     (ptr1),y
	tax
	dey
	lda     (ptr1),y
	jsr     _oam_meta_spr
	sta     _oam_index
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ hotspots_create (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_hotspots_create: near

.segment	"CODE"

;
; if (ht [HS_CUR_PANT] && hact [HS_CUR_PANT]) {
;
	ldx     #$00
	lda     _n_pant
	clc
	adc     _gpit
	bcc     L179E
	inx
L179E:	sta     ptr1
	txa
	clc
	adc     #>(_ht)
	sta     ptr1+1
	ldy     #<(_ht)
	lda     (ptr1),y
	beq     L0B04
	ldx     #$00
	lda     _n_pant
	clc
	adc     _gpit
	bcc     L179F
	inx
L179F:	sta     ptr1
	txa
	clc
	adc     #>(_hact)
	sta     ptr1+1
	ldy     #<(_hact)
	lda     (ptr1),y
	beq     L0B04
;
; hrt = ht [HS_CUR_PANT];
;
	ldx     #$00
	lda     _n_pant
	clc
	adc     _gpit
	bcc     L17A0
	inx
L17A0:	sta     ptr1
	txa
	clc
	adc     #>(_ht)
	sta     ptr1+1
	ldy     #<(_ht)
	lda     (ptr1),y
	sta     _hrt
;
; hrx = hyx [HS_CUR_PANT] << 4;
;
	ldx     #$00
	lda     _n_pant
	clc
	adc     _gpit
	bcc     L17A1
	inx
L17A1:	sta     ptr1
	txa
	clc
	adc     #>(_hyx)
	sta     ptr1+1
	ldy     #<(_hyx)
	ldx     #$00
	lda     (ptr1),y
	jsr     aslax4
	sta     _hrx
	stx     _hrx+1
;
; hry = hyx [HS_CUR_PANT] & 0xf0;
;
	ldx     #$00
	lda     _n_pant
	clc
	adc     _gpit
	bcc     L17A2
	inx
L17A2:	sta     ptr1
	txa
	clc
	adc     #>(_hyx)
	sta     ptr1+1
	ldy     #<(_hyx)
	lda     (ptr1),y
	and     #$F0
	sta     _hry
;
; } else hrt = 0;
;
	rts
L0B04:	lda     #$00
	sta     _hrt
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ cocos_init (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_cocos_init: near

.segment	"CODE"

;
; coco_it = COCOS_MAX; while (coco_it --) {
;
	lda     #$01
	sta     _coco_it
L0B1E:	lda     _coco_it
	pha
	sec
	sbc     #$01
	sta     _coco_it
	pla
	tax
	beq     L0B1F
;
; coco_slots [coco_it] = coco_it;
;
	ldy     _coco_it
	lda     _coco_it
	sta     _coco_slots,y
;
; coco_on [coco_it] = 0;
;
	ldy     _coco_it
	lda     #$00
	sta     _coco_on,y
;
; }
;
	jmp     L0B1E
;
; coco_slots_i = COCOS_MAX;
;
L0B1F:	lda     #$01
	sta     _coco_slots_i
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ cocos_shoot_aimed (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_cocos_shoot_aimed: near

.segment	"CODE"

;
; if (COCO_RDX < scroll_x || COCO_RDX >= scroll_x + 248) return;
;
	lda     _rdbb
	cmp     _scroll_x
	lda     _rdbb+1
	sbc     _scroll_x+1
	bvc     L17AB
	eor     #$80
L17AB:	bmi     L0B2D
	lda     _rdbb
	ldx     _rdbb+1
	jsr     pushax
	lda     _scroll_x
	ldx     _scroll_x+1
	clc
	adc     #$F8
	bcc     L0B2E
	inx
L0B2E:	jsr     tosicmp
	bmi     L0B2C
L0B2D:	rts
;
; rdct = distance ();
;
L0B2C:	jsr     _distance
	sta     _rdct
;
; if (rdct > COCO_FAIR_D && coco_slots_i) 
;
	cmp     #$21
	bcc     L0B34
	lda     _coco_slots_i
	bne     L0B33
L0B34:	rts
;
; -- coco_slots_i; coco_it = coco_slots [coco_slots_i];
;
L0B33:	dec     _coco_slots_i
	ldy     _coco_slots_i
	lda     _coco_slots,y
	sta     _coco_it
;
; coco_x [coco_it] = COCO_RDX << 6;
;
	ldx     #$00
	lda     _coco_it
	asl     a
	bcc     L17AC
	inx
	clc
L17AC:	adc     #<(_coco_x)
	sta     ptr1
	txa
	adc     #>(_coco_x)
	sta     ptr1+1
	lda     _rdbb
	ldx     _rdbb+1
	jsr     aslax4
	jsr     aslax2
	ldy     #$00
	sta     (ptr1),y
	iny
	txa
	sta     (ptr1),y
;
; coco_y [coco_it] = rdy << 6;
;
	ldx     #$00
	lda     _coco_it
	asl     a
	bcc     L17AD
	inx
	clc
L17AD:	adc     #<(_coco_y)
	sta     ptr1
	txa
	adc     #>(_coco_y)
	sta     ptr1+1
	ldx     #$00
	lda     _rdy
	jsr     aslax4
	jsr     aslax2
	dey
	sta     (ptr1),y
	iny
	txa
	sta     (ptr1),y
;
; rds16 = COCO_V * rda / rdct; coco_vx [coco_it] = ADD_SIGN2 (px, coco_x [coco_it], rds16);
;
	lda     #$C0
	jsr     pusha0
	lda     _rda
	jsr     tosumula0
	jsr     pushax
	lda     _rdct
	jsr     tosudiva0
	sta     _rds16
	stx     _rds16+1
	ldx     #$00
	lda     _coco_it
	asl     a
	bcc     L17AE
	inx
	clc
L17AE:	adc     #<(_coco_vx)
	tay
	txa
	adc     #>(_coco_vx)
	tax
	tya
	jsr     pushax
	lda     _px
	ldx     _px+1
	jsr     pushax
	ldx     #$00
	lda     _coco_it
	asl     a
	bcc     L17AF
	inx
	clc
L17AF:	adc     #<(_coco_x)
	sta     ptr1
	txa
	adc     #>(_coco_x)
	sta     ptr1+1
	ldy     #$01
	lda     (ptr1),y
	tax
	dey
	lda     (ptr1),y
	jsr     tosicmp
	bne     L0B4A
	ldx     #$00
	txa
	jmp     L0B57
L0B4A:	lda     _px
	ldx     _px+1
	jsr     pushax
	ldx     #$00
	lda     _coco_it
	asl     a
	bcc     L17B0
	inx
	clc
L17B0:	adc     #<(_coco_x)
	sta     ptr1
	txa
	adc     #>(_coco_x)
	sta     ptr1+1
	ldy     #$01
	lda     (ptr1),y
	tax
	dey
	lda     (ptr1),y
	jsr     tosicmp
	bcc     L0B54
	beq     L0B54
	lda     _rds16
	ldx     _rds16+1
	jmp     L0B57
L0B54:	lda     _rds16
	ldx     _rds16+1
	jsr     negax
L0B57:	ldy     #$00
	jsr     staxspidx
;
; rds16 = COCO_V * rdb / rdct; coco_vy [coco_it] = ADD_SIGN2 (py, coco_y [coco_it], rds16);
;
	lda     #$C0
	jsr     pusha0
	lda     _rdb
	jsr     tosumula0
	jsr     pushax
	lda     _rdct
	jsr     tosudiva0
	sta     _rds16
	stx     _rds16+1
	ldx     #$00
	lda     _coco_it
	asl     a
	bcc     L17B1
	inx
	clc
L17B1:	adc     #<(_coco_vy)
	tay
	txa
	adc     #>(_coco_vy)
	tax
	tya
	jsr     pushax
	lda     _py
	ldx     _py+1
	jsr     pushax
	ldx     #$00
	lda     _coco_it
	asl     a
	bcc     L17B2
	inx
	clc
L17B2:	adc     #<(_coco_y)
	sta     ptr1
	txa
	adc     #>(_coco_y)
	sta     ptr1+1
	ldy     #$01
	lda     (ptr1),y
	tax
	dey
	lda     (ptr1),y
	jsr     tosicmp
	bne     L0B64
	ldx     #$00
	txa
	jmp     L0B71
L0B64:	lda     _py
	ldx     _py+1
	jsr     pushax
	ldx     #$00
	lda     _coco_it
	asl     a
	bcc     L17B3
	inx
	clc
L17B3:	adc     #<(_coco_y)
	sta     ptr1
	txa
	adc     #>(_coco_y)
	sta     ptr1+1
	ldy     #$01
	lda     (ptr1),y
	tax
	dey
	lda     (ptr1),y
	jsr     tosicmp
	bmi     L0B6E
	beq     L0B6E
	lda     _rds16
	ldx     _rds16+1
	jmp     L0B71
L0B6E:	lda     _rds16
	ldx     _rds16+1
	jsr     negax
L0B71:	ldy     #$00
	jsr     staxspidx
;
; coco_on [coco_it] = 1;
;
	ldy     _coco_it
	lda     #$01
	sta     _coco_on,y
;
; sfx_play (SFX_COCO, 2);
;
	lda     #$0A
	jsr     pusha
	lda     #$02
	jmp     _sfx_play

.endproc

; ---------------------------------------------------------------
; void __near__ cocos_destroy (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_cocos_destroy: near

.segment	"CODE"

;
; coco_on [coco_it] = 0;
;
	ldy     _coco_it
	lda     #$00
	sta     _coco_on,y
;
; coco_slots [coco_slots_i] = coco_it; coco_slots_i ++;
;
	ldy     _coco_slots_i
	lda     _coco_it
	sta     _coco_slots,y
	lda     _coco_slots_i
	clc
	adc     #$01
	sta     _coco_slots_i
;
; sfx_play (SFX_DUMMY1, 2);
;
	lda     #$05
	jsr     pusha
	lda     #$02
	jmp     _sfx_play

.endproc

; ---------------------------------------------------------------
; void __near__ cocos_do (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_cocos_do: near

.segment	"CODE"

;
; coco_it = COCOS_MAX; while (coco_it --) if (coco_on [coco_it]) {
;
	lda     #$01
	sta     _coco_it
L0B8C:	lda     _coco_it
	pha
	sec
	sbc     #$01
	sta     _coco_it
	pla
	tax
	bne     L17D0
;
; }
;
	rts
;
; coco_it = COCOS_MAX; while (coco_it --) if (coco_on [coco_it]) {
;
L17D0:	ldy     _coco_it
	lda     _coco_on,y
	beq     L0B8C
;
; COCO_RDX = coco_x [coco_it] >> FIXBITS;
;
	ldx     #$00
	lda     _coco_it
	asl     a
	bcc     L17BF
	inx
	clc
L17BF:	adc     #<(_coco_x)
	sta     ptr1
	txa
	adc     #>(_coco_x)
	sta     ptr1+1
	ldy     #$01
	lda     (ptr1),y
	tax
	dey
	lda     (ptr1),y
	jsr     asrax4
	jsr     asrax2
	sta     _rdbb
	stx     _rdbb+1
;
; COCO_RDX < scroll_x + 8 ||
;
	jsr     pushax
	lda     _scroll_x
	ldx     _scroll_x+1
	clc
	adc     #$08
	bcc     L0B98
	inx
L0B98:	jsr     tosicmp
	jmi     L0B97
;
; COCO_RDX > scroll_x + 248 ||
;
	lda     _rdbb
	ldx     _rdbb+1
	jsr     pushax
	lda     _scroll_x
	ldx     _scroll_x+1
	clc
	adc     #$F8
	bcc     L0B99
	inx
L0B99:	jsr     tosicmp
	beq     L17CD
	jpl     L0B97
;
; coco_y [coco_it] < coco_vy [coco_it] ||
;
L17CD:	ldx     #$00
	lda     _coco_it
	asl     a
	bcc     L17C0
	inx
	clc
L17C0:	adc     #<(_coco_y)
	sta     ptr1
	txa
	adc     #>(_coco_y)
	sta     ptr1+1
	ldy     #$01
	lda     (ptr1),y
	tax
	dey
	lda     (ptr1),y
	jsr     pushax
	ldx     #$00
	lda     _coco_it
	asl     a
	bcc     L17C1
	inx
	clc
L17C1:	adc     #<(_coco_vy)
	sta     ptr1
	txa
	adc     #>(_coco_vy)
	sta     ptr1+1
	ldy     #$01
	lda     (ptr1),y
	tax
	dey
	lda     (ptr1),y
	jsr     tosicmp
	bmi     L0B97
;
; coco_y [coco_it] > (200<<FIXBITS) - coco_vy [coco_it]
;
	ldx     #$00
	lda     _coco_it
	asl     a
	bcc     L17C2
	inx
	clc
L17C2:	adc     #<(_coco_y)
	sta     ptr1
	txa
	adc     #>(_coco_y)
	sta     ptr1+1
	ldy     #$01
	lda     (ptr1),y
	tax
	dey
	lda     (ptr1),y
	jsr     pushax
	ldx     #$32
	lda     #$00
	jsr     pushax
	tax
	lda     _coco_it
	asl     a
	bcc     L17C3
	inx
	clc
L17C3:	adc     #<(_coco_vy)
;
; ) {
;
	sta     ptr1
;
; coco_y [coco_it] > (200<<FIXBITS) - coco_vy [coco_it]
;
	txa
	adc     #>(_coco_vy)
;
; ) {
;
	sta     ptr1+1
	ldy     #$01
	lda     (ptr1),y
	tax
	dey
	lda     (ptr1),y
	jsr     tossubax
	jsr     tosicmp
	beq     L0B96
	bmi     L0B96
;
; cocos_destroy ();
;
L0B97:	jsr     _cocos_destroy
;
; continue;
;
	jmp     L0B8C
;
; coco_x [coco_it] += coco_vx [coco_it];
;
L0B96:	ldx     #$00
	lda     _coco_it
	asl     a
	bcc     L17C4
	inx
	clc
L17C4:	adc     #<(_coco_x)
	tay
	txa
	adc     #>(_coco_x)
	tax
	tya
	jsr     pushax
	sta     ptr1
	stx     ptr1+1
	ldy     #$01
	lda     (ptr1),y
	tax
	dey
	lda     (ptr1),y
	jsr     pushax
	ldx     #$00
	lda     _coco_it
	asl     a
	bcc     L17C5
	inx
	clc
L17C5:	adc     #<(_coco_vx)
	sta     ptr1
	txa
	adc     #>(_coco_vx)
	sta     ptr1+1
	ldy     #$01
	lda     (ptr1),y
	tax
	dey
	lda     (ptr1),y
	jsr     tosaddax
	ldy     #$00
	jsr     staxspidx
;
; coco_y [coco_it] += coco_vy [coco_it];
;
	ldx     #$00
	lda     _coco_it
	asl     a
	bcc     L17C6
	inx
	clc
L17C6:	adc     #<(_coco_y)
	tay
	txa
	adc     #>(_coco_y)
	tax
	tya
	jsr     pushax
	sta     ptr1
	stx     ptr1+1
	ldy     #$01
	lda     (ptr1),y
	tax
	dey
	lda     (ptr1),y
	jsr     pushax
	ldx     #$00
	lda     _coco_it
	asl     a
	bcc     L17C7
	inx
	clc
L17C7:	adc     #<(_coco_vy)
	sta     ptr1
	txa
	adc     #>(_coco_vy)
	sta     ptr1+1
	ldy     #$01
	lda     (ptr1),y
	tax
	dey
	lda     (ptr1),y
	jsr     tosaddax
	ldy     #$00
	jsr     staxspidx
;
; COCO_RDX = coco_x [coco_it] >> FIXBITS;
;
	ldx     #$00
	lda     _coco_it
	asl     a
	bcc     L17C8
	inx
	clc
L17C8:	adc     #<(_coco_x)
	sta     ptr1
	txa
	adc     #>(_coco_x)
	sta     ptr1+1
	iny
	lda     (ptr1),y
	tax
	dey
	lda     (ptr1),y
	jsr     asrax4
	jsr     asrax2
	sta     _rdbb
	stx     _rdbb+1
;
; rdy      = coco_y [coco_it] >> FIXBITS;
;
	ldx     #$00
	lda     _coco_it
	asl     a
	bcc     L17C9
	inx
	clc
L17C9:	adc     #<(_coco_y)
	sta     ptr1
	txa
	adc     #>(_coco_y)
	sta     ptr1+1
	iny
	lda     (ptr1),y
	tax
	dey
	lda     (ptr1),y
	jsr     asrax4
	jsr     asrax2
	sta     _rdy
;
; COCO_RDX - scroll_x,
;
	jsr     decsp4
	lda     _rdbb
	sec
	sbc     _scroll_x
	pha
	lda     _rdbb+1
	sbc     _scroll_x+1
	pla
	ldy     #$03
	sta     (sp),y
;
; rdy + SPRITE_ADJUST, 
;
	lda     _rdy
	clc
	adc     #$20
	sec
	sbc     #$08
	bcs     L17CA
	sec
L17CA:	sbc     #$10
	bcs     L17CB
	sec
L17CB:	sbc     #$01
	dey
	sta     (sp),y
;
; COCO_PATTERN, 
;
	lda     #$00
	dey
	sta     (sp),y
;
; COCO_PALETTE, 
;
	lda     #$03
	dey
	sta     (sp),y
;
; );
;
	lda     _oam_index
	jsr     _oam_spr
	sta     _oam_index
;
; if (pflickering == 0 && 
;
	lda     _pflickering
	jne     L0B8C
;
; COCO_RDX + 7 >= prx && 
;
	lda     _rdbb
	ldx     _rdbb+1
	clc
	adc     #$07
	bcc     L0BBD
	inx
L0BBD:	cmp     _prx
	txa
	sbc     _prx+1
	jcc     L0B8C
;
; COCO_RDX <= prx + 7 && 
;
	lda     _rdbb
	ldx     _rdbb+1
	jsr     pushax
	lda     _prx
	ldx     _prx+1
	clc
	adc     #$07
	bcc     L0BBE
	inx
L0BBE:	jsr     tosicmp
	beq     L17CF
	jcs     L0B8C
;
; rdy + 7 + PLAYER_COLLISION_VSTRETCH_FG >= pry && 
;
L17CF:	ldx     #$00
	lda     _rdy
	clc
	adc     #$07
	bcc     L17CC
	inx
	clc
L17CC:	adc     #$04
	bcc     L0BC0
	inx
L0BC0:	cmp     _pry
	txa
	sbc     #$00
	jcc     L0B8C
;
; rdy <= pry + 12
;
	lda     _rdy
	jsr     pusha0
	lda     _pry
;
; ) {
;
	clc
	adc     #$0C
	bcc     L0BC1
	ldx     #$01
L0BC1:	jsr     tosicmp
	bcc     L0BBB
	jne     L0B8C
;
; en_sg_2 = 1;
;
L0BBB:	lda     #$01
	sta     _en_sg_2
;
; pkill = !!en_sg_2;
;
	jsr     bnega
	jsr     bnega
	sta     _pkill
;
; cocos_destroy ();
;
	jsr     _cocos_destroy
;
; }
;
	jmp     L0B8C

.endproc

; ---------------------------------------------------------------
; void __near__ player_register_safe_spot (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_player_register_safe_spot: near

.segment	"CODE"

;
; px_safe = px;
;
	lda     _px
	sta     _px_safe
	lda     _px+1
	sta     _px_safe+1
;
; py_safe = py;
;
	lda     _py
	sta     _py_safe
	lda     _py+1
	sta     _py_safe+1
;
; n_pant_safe = n_pant;
;
	lda     _n_pant
	sta     _n_pant_safe
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ player_stop (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_player_stop: near

.segment	"CODE"

;
; pvx = pvy = 0;
;
	lda     #$00
	sta     _pvy
	sta     _pvy+1
	sta     _pvx
	sta     _pvx+1
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ player_init (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_player_init: near

.segment	"CODE"

;
; if (!warp_to_level) player_stop ();
;
	lda     _warp_to_level
	bne     L0BD4
	jsr     _player_stop
;
; pfacing = 0;
;
L0BD4:	lda     #$00
	sta     _pfacing
;
; pfr = pctfr = 0;
;
	sta     _pctfr
	sta     _pfr
;
; pj = pctj = 0;
;
	sta     _pctj
	sta     _pj
;
; psprid = 0;
;
	sta     _psprid
;
; pobjs = 0;
;
	sta     _pobjs
;
; pkeys = 0;
;
	sta     _pkeys
;
; pgotten = 0;
;
	sta     _pgotten
;
; pfiring = 0;
;
	sta     _pfiring
;
; pkilled = 0;
;
	sta     _pkilled
;
; pflickering = pbouncing = 0;
;
	sta     _pbouncing
	sta     _pflickering
;
; player_register_safe_spot ();
;
	jsr     _player_register_safe_spot
;
; pinv = HS_OBJ_EMPTY; 
;
	lda     #$04
	sta     _pinv
;
; vertical_engine_type = ENGINE_TYPE_JUMP;
;
	lda     #$00
	sta     _vertical_engine_type
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ player_to_pixels (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_player_to_pixels: near

.segment	"CODE"

;
; prx = px >> FIXBITS;
;
	lda     _px
	ldx     _px+1
	jsr     shrax4
	jsr     shrax2
	sta     _prx
	stx     _prx+1
;
; pry = py >> FIXBITS;
;
	lda     _py
	ldx     _py+1
	jsr     asrax4
	jsr     asrax2
	sta     _pry
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ player_kill (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_player_kill: near

.segment	"CODE"

;
; oam_index = oam_index_player;
;
	lda     _oam_index_player
	sta     _oam_index
;
; player_render ();
;
	jsr     _player_render
;
; ppu_waitnmi ();
;
	jsr     _ppu_waitnmi
;
; pkill = phit = 0;
;
	lda     #$00
	sta     _phit
	sta     _pkill
;
; sfx_play (SFX_PHIT, 0);
;
	lda     #$04
	jsr     pusha
	lda     #$00
	jsr     _sfx_play
;
; if (plife) -- plife; else game_over = 1;
;
	lda     _plife
	beq     L0C12
	dec     _plife
	jmp     L0C15
L0C12:	lda     #$01
	sta     _game_over
;
; pflickering = PLAYER_FLICKERS;
;
L0C15:	lda     #$64
	sta     _pflickering
;
; music_pause (1);
;
	lda     #$01
	jsr     _music_pause
;
; delay (60);
;
	lda     #$3C
	jsr     _delay
;
; px = px_safe; 
;
	lda     _px_safe
	sta     _px
	lda     _px_safe+1
	sta     _px+1
;
; py = py_safe; 
;
	lda     _py_safe
	sta     _py
	lda     _py_safe+1
	sta     _py+1
;
; player_to_pixels ();
;
	jsr     _player_to_pixels
;
; n_pant = n_pant_safe;  
;
	lda     _n_pant_safe
	sta     _n_pant
;
; player_stop ();
;
	jsr     _player_stop
;
; music_pause (0);
;
	lda     #$00
	jsr     _music_pause
;
; pmayneedrelocation = 1;
;
	lda     #$01
	sta     _pmayneedrelocation
;
; on_pant = 0xff;
;
	lda     #$FF
	sta     _on_pant
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ player_process_tile (int, int, int, int, int)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_player_process_tile: near

.segment	"CODE"

;
; if (y0) -- y0;
;
	ldy     #$05
	lda     (sp),y
	dey
	ora     (sp),y
	beq     L0C2D
	ldx     #$00
	lda     #$01
	jsr     subeqysp
;
; if (y1) -- y1;
;
L0C2D:	ldy     #$01
	lda     (sp),y
	dey
	ora     (sp),y
	beq     L0C30
	ldx     #$00
	lda     #$01
	jsr     subeq0sp
;
; at == 11 
;
L0C30:	ldy     #$09
	lda     (sp),y
	tax
	dey
	lda     (sp),y
;
; && b_button
;
	cpx     #$00
	jne     L0C3A
	cmp     #$0B
	jne     L0C3A
;
; ) {
;
	lda     _b_button
	jeq     L0C3A
;
; b_button = 0;
;
	stx     _b_button
;
; x0 > 0 && x0 < MAX_TILE_X && y0 > 0 && y0 < 11 &&
;
	dey
	lda     (sp),y
	tax
	dey
	lda     (sp),y
	cmp     #$01
	txa
	sbc     #$00
	bvs     L0C3C
	eor     #$80
L0C3C:	jpl     L0C3A
	iny
	lda     (sp),y
	tax
	dey
	lda     (sp),y
	cmp     #$1F
	txa
	sbc     #$00
	bvc     L0C3E
	eor     #$80
L0C3E:	jpl     L0C3A
	dey
	lda     (sp),y
	tax
	dey
	lda     (sp),y
	cmp     #$01
	txa
	sbc     #$00
	bvs     L0C3F
	eor     #$80
L0C3F:	jpl     L0C3A
	iny
	lda     (sp),y
	tax
	dey
	lda     (sp),y
	cmp     #$0B
	txa
	sbc     #$00
	bvc     L0C40
	eor     #$80
L0C40:	jpl     L0C3A
;
; ATTR (x1, y1) == 0
;
	dey
	lda     (sp),y
	tax
	dey
	lda     (sp),y
	cmp     #$10
	txa
	sbc     #$00
	bvs     L0C45
	eor     #$80
L0C45:	bpl     L0C46
	lda     (sp),y
	and     #$0F
	sta     ptr1
	dey
	lda     (sp),y
	tax
	dey
	lda     (sp),y
	jsr     aslax4
	ora     ptr1
	clc
	adc     #$C0
	bcc     L0C51
	inx
	jmp     L0C51
L0C46:	dey
	lda     (sp),y
	tax
	dey
	lda     (sp),y
	jsr     aslax4
	ldy     #$02
	ora     (sp),y
	pha
	txa
	iny
	ora     (sp),y
	tax
	pla
L0C51:	sta     ptr1
	txa
	clc
	adc     #>(_map_attr)
	sta     ptr1+1
	ldy     #<(_map_attr)
	lda     (ptr1),y
;
; ) {
;
	bne     L0C3A
;
; sfx_play (SFX_TILE, 1);
;
	lda     #$01
	jsr     pusha
	jsr     _sfx_play
;
; _x = x0; _y = y0; _t = 0;  map_set ();
;
	ldy     #$06
	lda     (sp),y
	sta     __x
	ldy     #$04
	lda     (sp),y
	sta     __y
	lda     #$00
	sta     __t
	jsr     _map_set
;
; _x = x1; _y = y1; _t = 14; map_set ();
;
	ldy     #$02
	lda     (sp),y
	sta     __x
	ldy     #$00
	lda     (sp),y
	sta     __y
	lda     #$0E
	sta     __t
	jsr     _map_set
;
; at == 10 &&
;
L0C3A:	ldy     #$09
	lda     (sp),y
	tax
	dey
	lda     (sp),y
	cpx     #$00
	jne     L0C6B
	cmp     #$0A
	jne     L0C6B
;
; ) {
;
	lda     _pkeys
	jeq     L0C6B
;
; _x = x0; _y = y0; _t = 0; map_set ();
;
	ldy     #$06
	lda     (sp),y
	sta     __x
	ldy     #$04
	lda     (sp),y
	sta     __y
	stx     __t
	jsr     _map_set
;
; gp_gen = (unsigned char *) c_locks;
;
	lda     _c_locks
	sta     _gp_gen
	lda     _c_locks+1
	sta     _gp_gen+1
;
; gpit = c_max_bolts; while (gpit --) {
;
	lda     _c_max_bolts
	sta     _gpit
L0C7B:	lda     _gpit
	pha
	sec
	sbc     #$01
	sta     _gpit
	pla
	tax
	jeq     L0C7C
;
; rda = *gp_gen ++; rdb = *gp_gen ++;
;
	lda     _gp_gen
	ldx     _gp_gen+1
	sta     regsave
	stx     regsave+1
	clc
	adc     #$01
	bcc     L0C80
	inx
L0C80:	sta     _gp_gen
	stx     _gp_gen+1
	ldy     #$00
	lda     (regsave),y
	sta     _rda
	lda     _gp_gen
	ldx     _gp_gen+1
	sta     regsave
	stx     regsave+1
	clc
	adc     #$01
	bcc     L0C83
	inx
L0C83:	sta     _gp_gen
	stx     _gp_gen+1
	lda     (regsave),y
	sta     _rdb
;
; if ((x0 < 16 && n_pant == rda && COORDS (x0, y0) == rdb) ||
;
	ldy     #$07
	lda     (sp),y
	tax
	dey
	lda     (sp),y
	cmp     #$10
	txa
	sbc     #$00
	bvc     L0C87
	eor     #$80
L0C87:	bpl     L17D5
	lda     _rda
	cmp     _n_pant
	bne     L17D5
	iny
	lda     (sp),y
	tax
	dey
	lda     (sp),y
	cmp     #$10
	txa
	sbc     #$00
	bvs     L0C8A
	eor     #$80
L0C8A:	bpl     L0C8B
	lda     (sp),y
	and     #$0F
	sta     ptr1
	dey
	lda     (sp),y
	tax
	dey
	lda     (sp),y
	jsr     aslax4
	ora     ptr1
	clc
	adc     #$C0
	bcc     L0C94
	inx
	jmp     L0C94
L0C8B:	dey
	lda     (sp),y
	tax
	dey
	lda     (sp),y
	jsr     aslax4
	ldy     #$06
	ora     (sp),y
	pha
	txa
	iny
	ora     (sp),y
	tax
	pla
L0C94:	cpx     #$00
	bne     L17D5
	cmp     _rdb
	jeq     L0C85
;
; (x0 > 15 && n_pant + 1 == rda && COORDS (x0 - 16, y0) == rdb)
;
L17D5:	ldy     #$07
	lda     (sp),y
	tax
	dey
	lda     (sp),y
	cmp     #$10
	txa
	sbc     #$00
	bvs     L0C9C
	eor     #$80
L0C9C:	jpl     L0C7B
	ldx     #$00
	lda     _n_pant
	clc
	adc     #$01
	bcc     L0C9E
	inx
L0C9E:	cpx     #$00
	jne     L0C7B
	cmp     _rda
	jne     L0C7B
	iny
	lda     (sp),y
	tax
	dey
	lda     (sp),y
	sec
	sbc     #$10
	bcs     L0CA0
	dex
L0CA0:	cmp     #$10
	txa
	sbc     #$00
	bvs     L0CA1
	eor     #$80
L0CA1:	bpl     L0CA2
	lda     (sp),y
	sec
	sbc     #$10
	and     #$0F
	sta     ptr1
	dey
	lda     (sp),y
	tax
	dey
	lda     (sp),y
	jsr     aslax4
	ora     ptr1
	clc
	adc     #$C0
	bcc     L0CAC
	inx
	jmp     L0CAC
L0CA2:	iny
	lda     (sp),y
	tax
	dey
	lda     (sp),y
	sec
	sbc     #$10
	bcs     L0CB0
	dex
L0CB0:	sta     ptr1
	stx     ptr1+1
	dey
	lda     (sp),y
	tax
	dey
	lda     (sp),y
	jsr     aslax4
	ora     ptr1
	pha
	txa
	ora     ptr1+1
	tax
	pla
L0CAC:	cpx     #$00
	jne     L0C7B
	cmp     _rdb
	jne     L0C7B
;
; lkact [gpit] = 0;
;
L0C85:	ldy     _gpit
	txa
	sta     _lkact,y
;
; }
;
	jmp     L0C7B
;
; -- pkeys;
;
L0C7C:	dec     _pkeys
;
; sfx_play (SFX_TILE, 1);
;
	lda     #$01
	jsr     pusha
	jsr     _sfx_play
;
; }
;
L0C6B:	ldy     #$0A
	jmp     addysp

.endproc

; ---------------------------------------------------------------
; void __near__ fire_bullet (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_fire_bullet: near

.segment	"CODE"

;
; if (b_slots_i == 0) return;
;
	lda     _b_slots_i
	bne     L17E3
;
; }
;
	rts
;
; -- b_slots_i; bi = b_slots [b_slots_i];
;
L17E3:	dec     _b_slots_i
	ldy     _b_slots_i
	lda     _b_slots,y
	sta     _bi
;
; switch (pfacing) {
;
	lda     _pfacing
;
; } 
;
	beq     L0CDC
	cmp     #$08
	bne     L0CC8
;
; bx [bi] = prx - 8;
;
	ldx     #$00
	lda     _bi
	asl     a
	bcc     L17DB
	inx
	clc
L17DB:	adc     #<(_bx)
	sta     ptr1
	txa
	adc     #>(_bx)
	sta     ptr1+1
	lda     _prx
	ldx     _prx+1
	sec
	sbc     #$08
	bcs     L0CCE
	dex
L0CCE:	ldy     #$00
	sta     (ptr1),y
	iny
	txa
	sta     (ptr1),y
;
; bmx [bi] = -PLAYER_BULLET_SPEED;
;
	ldy     _bi
	lda     #$FC
;
; break; 
;
	jmp     L17E2
;
; bx [bi] = prx + 8;
;
L0CDC:	tax
	lda     _bi
	asl     a
	bcc     L17DC
	inx
	clc
L17DC:	adc     #<(_bx)
	sta     ptr1
	txa
	adc     #>(_bx)
	sta     ptr1+1
	lda     _prx
	ldx     _prx+1
	clc
	adc     #$08
	bcc     L0CE0
	inx
L0CE0:	ldy     #$00
	sta     (ptr1),y
	iny
	txa
	sta     (ptr1),y
;
; bmx [bi] = PLAYER_BULLET_SPEED;
;
	ldy     _bi
	lda     #$04
L17E2:	sta     _bmx,y
;
; by [bi] = pry + PLAYER_BULLET_Y_OFFSET;
;
	ldy     _bi
	lda     _pry
	sta     _by,y
;
; bmy [bi] = 0;
;
	ldy     _bi
	lda     #$00
	sta     _bmy,y
;
; b_cy1 [bi] = ((by [bi] + 4 - 16) >> 4);
;
L0CC8:	lda     #<(_b_cy1)
	ldx     #>(_b_cy1)
	clc
	adc     _bi
	bcc     L0CEF
	inx
L0CEF:	sta     ptr1
	stx     ptr1+1
	ldy     _bi
	ldx     #$00
	lda     _by,y
	clc
	adc     #$04
	bcc     L0CF5
	inx
L0CF5:	sec
	sbc     #$10
	bcs     L0CF6
	dex
L0CF6:	jsr     shrax4
	ldy     #$00
	sta     (ptr1),y
;
; sfx_play (SFX_BULLET, 2);
;
	lda     #$09
	jsr     pusha
	lda     #$02
	jsr     _sfx_play
;
; bullets_disable = 1;
;
	lda     #$01
	sta     _bullets_disable
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ bullets_destroy (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_bullets_destroy: near

.segment	"CODE"

;
; by [bi] = 0;
;
	ldy     _bi
	lda     #$00
	sta     _by,y
;
; b_slots [b_slots_i] = bi; ++ b_slots_i;
;
	ldy     _b_slots_i
	lda     _bi
	sta     _b_slots,y
	inc     _b_slots_i
;
; sfx_play (SFX_DUMMY1, 2);
;
	lda     #$05
	jsr     pusha
	lda     #$02
	jmp     _sfx_play

.endproc

; ---------------------------------------------------------------
; void __near__ bullets_move (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_bullets_move: near

.segment	"CODE"

;
; if (bullets_disable) {
;
	lda     _bullets_disable
	beq     L0D0A
;
; bullets_disable = 0; return;
;
	lda     #$00
	sta     _bullets_disable
	rts
;
; for (bi = 0; bi < MAX_BULLETS; ++ bi) {
;
L0D0A:	sta     _bi
L0D0E:	lda     _bi
	cmp     #$04
	bcc     L17EB
;
; }
;
	rts
;
; rde = (bi + half_life) & 1;
;
L17EB:	lda     _bi
	clc
	adc     _half_life
	and     #$01
	sta     _rde
;
; if (by [bi]) {
;
	ldy     _bi
	lda     _by,y
	jeq     L0D10
;
; _bx = bx [bi] + bmx [bi];
;
	ldx     #$00
	lda     _bi
	asl     a
	bcc     L17E8
	inx
	clc
L17E8:	adc     #<(_bx)
	sta     ptr1
	txa
	adc     #>(_bx)
	sta     ptr1+1
	ldy     #$01
	lda     (ptr1),y
	tax
	dey
	lda     (ptr1),y
	jsr     pushax
	lda     #<(_bmx)
	ldx     #>(_bmx)
	clc
	adc     _bi
	bcc     L0D21
	inx
L0D21:	ldy     #$00
	jsr     ldaidx
	jsr     tosaddax
	sta     __bx
	stx     __bx+1
;
; _by = by [bi] + bmy [bi];  
;
	ldy     _bi
	lda     _by,y
	jsr     pusha0
	lda     #<(_bmy)
	ldx     #>(_bmy)
	clc
	adc     _bi
	bcc     L0D27
	inx
L0D27:	ldy     #$00
	jsr     ldaidx
	jsr     tosaddax
	sta     __by
;
; _bx < scroll_x ||
;
	lda     __bx
	cmp     _scroll_x
	lda     __bx+1
	sbc     _scroll_x+1
	bvc     L17E7
	eor     #$80
L17E7:	bmi     L0D29
;
; _bx > scroll_x + 248
;
	lda     __bx
	ldx     __bx+1
	jsr     pushax
	lda     _scroll_x
	ldx     _scroll_x+1
;
; ) {
;
	clc
	adc     #$F8
	bcc     L0D2A
	inx
L0D2A:	jsr     tosicmp
	beq     L0D28
	bmi     L0D28
;
; bullets_destroy ();
;
L0D29:	jsr     _bullets_destroy
;
; continue;
;
	jmp     L0D10
;
; _bx - scroll_x, 
;
L0D28:	jsr     decsp4
	lda     __bx
	sec
	sbc     _scroll_x
	pha
	lda     __bx+1
	sbc     _scroll_x+1
	pla
	ldy     #$03
	sta     (sp),y
;
; SPRITE_ADJUST + _by, 
;
	lda     __by
	clc
	adc     #$07
	dey
	sta     (sp),y
;
; BULLET_PATTERN, BULLET_PALETTE,
;
	lda     #$00
	dey
	sta     (sp),y
	lda     #$03
	dey
	sta     (sp),y
;
; );
;
	lda     _oam_index
	jsr     _oam_spr
	sta     _oam_index
;
; if (rde) {
;
	lda     _rde
	jeq     L0D5A
;
; cx1 = ((_bx + 4) >> 4);
;
	lda     __bx
	ldx     __bx+1
	clc
	adc     #$04
	bcc     L0D3B
	inx
L0D3B:	jsr     asrax4
	sta     _cx1
;
; cy1 = b_cy1 [bi];
;
	ldy     _bi
	lda     _b_cy1,y
	sta     _cy1
;
; rdm = map_attr [COORDS (cx1, cy1)];
;
	lda     _cx1
	cmp     #$10
	bcc     L0D44
	lda     _cx1
	and     #$0F
	sta     ptr1
	ldx     #$00
	lda     _cy1
	jsr     aslax4
	ora     ptr1
	clc
	adc     #$C0
	bcc     L0D4D
	inx
	jmp     L0D4D
L0D44:	ldx     #$00
	lda     _cy1
	jsr     aslax4
	ora     _cx1
L0D4D:	sta     ptr1
	txa
	clc
	adc     #>(_map_attr)
	sta     ptr1+1
	ldy     #<(_map_attr)
	lda     (ptr1),y
	sta     _rdm
;
; if (rdm & 16) {
;
	and     #$10
	beq     L0D53
;
; breakable_break (cx1, cy1);
;
	jsr     decsp2
	lda     _cx1
	ldy     #$01
	sta     (sp),y
	lda     _cy1
	dey
	sta     (sp),y
	jsr     _breakable_break
;
; bullets_destroy ();
;
	jsr     _bullets_destroy
;
; continue;
;
	jmp     L0D10
;
; if (rdm & 8) {
;
L0D53:	lda     _rdm
	and     #$08
	beq     L0D5A
;
; bullets_destroy (); 
;
	jsr     _bullets_destroy
;
; continue;
;
	jmp     L0D10
;
; bx [bi] = _bx;
;
L0D5A:	tax
	lda     _bi
	asl     a
	bcc     L17E9
	inx
	clc
L17E9:	adc     #<(_bx)
	sta     ptr1
	txa
	adc     #>(_bx)
	sta     ptr1+1
	lda     __bx
	ldy     #$00
	sta     (ptr1),y
	iny
	lda     __bx+1
	sta     (ptr1),y
;
; by [bi] = _by;
;
	ldy     _bi
	lda     __by
	sta     _by,y
;
; for (bi = 0; bi < MAX_BULLETS; ++ bi) {
;
L0D10:	inc     _bi
	jmp     L0D0E

.endproc

; ---------------------------------------------------------------
; void __near__ player_move (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_player_move: near

.segment	"CODE"

;
; if (pflickering) -- pflickering;
;
	lda     _pflickering
	beq     L0D65
	dec     _pflickering
;
; if (pbouncing) -- pbouncing;
;
L0D65:	lda     _pbouncing
	beq     L0D68
	dec     _pbouncing
;
; hitv = hith = 0;
;
L0D68:	lda     #$00
	sta     _hith
	sta     _hitv
;
; pcx = prx; pcy = pry;
;
	lda     _prx
	sta     _pcx
	lda     _prx+1
	sta     _pcx+1
	lda     _pry
	sta     _pcy
;
; pnotsafe = 0;
;
	lda     #$00
	sta     _pnotsafe
;
; pice = 0;
;
	sta     _pice
;
; oppossee = ppossee;
;
	lda     _ppossee
	sta     _oppossee
;
; ppossee = 0;
;
	lda     #$00
	sta     _ppossee
;
; if (vertical_engine_type != ENGINE_TYPE_SWIM) {
;
	lda     _vertical_engine_type
	cmp     #$02
	beq     L0D81
;
; if (!pj) {
;
	lda     _pj
	bne     L0D81
;
; pvy += PLAYER_G;
;
	lda     #$10
	clc
	adc     _pvy
	sta     _pvy
	bcc     L0D80
	inc     _pvy+1
;
; if (pvy > PLAYER_VY_FALLING_MAX) pvy = PLAYER_VY_FALLING_MAX; 
;
L0D80:	lda     _pvy
	cmp     #$01
	lda     _pvy+1
	sbc     #$01
	bvs     L0D83
	eor     #$80
L0D83:	bpl     L0D81
	ldx     #$01
	lda     #$00
	sta     _pvy
	stx     _pvy+1
;
; if (pgotten) pvy = 0;   
;
L0D81:	lda     _pgotten
	beq     L0D86
	lda     #$00
	sta     _pvy
	sta     _pvy+1
;
; py += pvy;
;
L0D86:	lda     _pvy
	clc
	adc     _py
	sta     _py
	lda     _pvy+1
	adc     _py+1
	sta     _py+1
;
; if (py < 0) py = 0;
;
	ldx     _py+1
	cpx     #$80
	bcc     L0D8C
	lda     #$00
	sta     _py
	sta     _py+1
;
; pry = py >> FIXBITS;
;
L0D8C:	lda     _py
	ldx     _py+1
	jsr     asrax4
	jsr     asrax2
	sta     _pry
;
; player_to_pixels ();
;
	jsr     _player_to_pixels
;
; cx1 = prx >> 4;
;
	lda     _prx
	ldx     _prx+1
	jsr     shrax4
	sta     _cx1
;
; cx2 = (prx + 7) >> 4;
;
	lda     _prx
	ldx     _prx+1
	clc
	adc     #$07
	bcc     L0D98
	inx
L0D98:	jsr     shrax4
	sta     _cx2
;
; rds16 = pvy + pgtmy;
;
	lda     _pvy
	clc
	adc     _pgtmy
	sta     _rds16
	lda     _pvy+1
	adc     _pgtmy+1
	tax
	stx     _rds16+1
;
; if (rds16 < 0)
;
	cpx     #$80
	jcc     L0D9B
;
; cy1 = cy2 = (pry - PLAYER_COLLISION_VSTRETCH_BG) >> 4;   
;
	lda     _pry
	sec
	sbc     #$FC
	pha
	lda     #$00
	sbc     #$FF
	tax
	pla
	jsr     shrax4
	sta     _cy2
	sta     _cy1
;
; cm_two_points ();
;
	jsr     _cm_two_points
;
; if ((at1 & 8) || (at2 & 8)) {
;
	lda     _at1
	and     #$08
	bne     L0DA3
	lda     _at2
	and     #$08
	beq     L0DA2
;
; pry = ((cy1 + 1) << 4) + PLAYER_COLLISION_VSTRETCH_BG;
;
L0DA3:	ldx     #$00
	lda     _cy1
	clc
	adc     #$01
	bcc     L0DAB
	inx
L0DAB:	jsr     shlax4
	clc
	adc     #$FC
	sta     _pry
	txa
	adc     #$FF
;
; pvy = 0; py = pry << FIXBITS;
;
	ldx     #$00
	txa
	sta     _pvy
	sta     _pvy+1
	lda     _pry
	jsr     aslax4
	jsr     aslax2
	sta     _py
	stx     _py+1
;
; pgotten = 0;
;
	lda     #$00
	sta     _pgotten
;
; pfiring = 1;
;
	lda     #$01
	sta     _pfiring
;
; } else if ((at1 & 1) || (at2 & 1)) {
;
	jmp     L0E38
L0DA2:	lda     _at1
	and     #$01
	bne     L0DB6
	lda     _at2
	and     #$01
	beq     L0DB5
;
; hitv = 1;
;
L0DB6:	lda     #$01
	sta     _hitv
;
; else if ((at1 == 2) || (at2 == 2)) {
;
	jmp     L0E38
L0DB5:	lda     _at1
	cmp     #$02
	beq     L0DBE
	lda     _at2
	cmp     #$02
	jne     L0E38
;
; if (pctj > 2) pj = 0;
;
L0DBE:	lda     _pctj
	cmp     #$03
	jcc     L0E38
	lda     #$00
	sta     _pj
;
; } else if (rds16 > 0)
;
	jmp     L0E38
L0D9B:	lda     _rds16
	cmp     #$01
	lda     _rds16+1
	sbc     #$00
	bvs     L0DC9
	eor     #$80
L0DC9:	jpl     L0E38
;
; cy1 = cy2 = (pry + 16) >> 4; 
;
	ldx     #$00
	lda     _pry
	clc
	adc     #$10
	bcc     L0DCE
	inx
L0DCE:	jsr     shrax4
	sta     _cy2
	sta     _cy1
;
; cm_two_points (); 
;
	jsr     _cm_two_points
;
; pry < ((cy1 - 1) << 4) + 4 && 
;
	lda     _pry
	jsr     pusha0
	lda     _cy1
	sec
	sbc     #$01
	bcs     L0DD4
	ldx     #$FF
L0DD4:	jsr     shlax4
	clc
	adc     #$04
	bcc     L0DD5
	inx
L0DD5:	jsr     tosicmp
	jcs     L0DD0
;
; (at1 & 12) || (at2 & 12)
;
	lda     _at1
	and     #$0C
	bne     L0DD1
	lda     _at2
	and     #$0C
;
; )
;
	jeq     L0DD0
;
; pvy = 0; pry = ((cy1 - 1) << 4);py = pry << FIXBITS;
;
L0DD1:	ldx     #$00
	txa
	sta     _pvy
	sta     _pvy+1
	lda     _cy1
	sec
	sbc     #$01
	asl     a
	asl     a
	asl     a
	asl     a
	sta     _pry
	jsr     aslax4
	jsr     aslax2
	sta     _py
	stx     _py+1
;
; pgotten = 0;
;
	lda     #$00
	sta     _pgotten
;
; pfiring = 1;
;
	lda     #$01
	sta     _pfiring
;
; ppossee = 1;
;
	sta     _ppossee
;
; pice = (at1 & 64) || (at2 & 64);
;
	lda     _at1
	and     #$40
	bne     L0DEC
	lda     _at2
	and     #$40
	beq     L0DEF
L0DEC:	lda     #$01
L0DEF:	sta     _pice
;
; cfx = 0;
;
	lda     #$00
	sta     _cfx
;
; if ((at1 & 40) == 40) { if (at1 & 1) cfx = pgtmx = PLAYER_VX_CONVEYORS; else cfx = pgtmx = -PLAYER_VX_CONVEYORS; pgotten = 1; } 
;
	lda     _at1
	and     #$28
	cmp     #$28
	bne     L0DF2
	lda     _at1
	and     #$01
	beq     L0DF6
	ldx     #$00
	lda     #$40
	jmp     L17F6
L0DF6:	ldx     #$FF
	lda     #$C0
L17F6:	sta     _pgtmx
	stx     _pgtmx+1
	sta     _cfx
	lda     #$01
	sta     _pgotten
;
; if (cx1 != cx2) if ((at2 & 40) == 40) { if (at2 & 1) cfx = pgtmx = PLAYER_VX_CONVEYORS; else cfx = pgtmx = -PLAYER_VX_CONVEYORS; pgotten = 1; } 
;
L0DF2:	lda     _cx2
	cmp     _cx1
	beq     L0E03
	lda     _at2
	and     #$28
	cmp     #$28
	bne     L0E03
	lda     _at2
	and     #$01
	beq     L0E07
	ldx     #$00
	lda     #$40
	jmp     L17F7
L0E07:	ldx     #$FF
	lda     #$C0
L17F7:	sta     _pgtmx
	stx     _pgtmx+1
	sta     _cfx
	lda     #$01
	sta     _pgotten
;
; if (at1 & 16) { breakable_break (cx1, cy1 - 1); pnotsafe = 1; }
;
L0E03:	lda     _at1
	and     #$10
	beq     L0E12
	jsr     decsp2
	lda     _cx1
	ldy     #$01
	sta     (sp),y
	lda     _cy1
	sec
	sbc     #$01
	dey
	sta     (sp),y
	jsr     _breakable_break
	lda     #$01
	sta     _pnotsafe
;
; if (cx1 != cx2 && (at2 & 16)) { breakable_break (cx2, cy1 - 1); pnotsafe = 1; }
;
L0E12:	lda     _cx2
	cmp     _cx1
	beq     L0E1A
	lda     _at2
	and     #$10
	beq     L0E1A
	jsr     decsp2
	lda     _cx2
	ldy     #$01
	sta     (sp),y
	lda     _cy1
	sec
	sbc     #$01
	dey
	sta     (sp),y
	jsr     _breakable_break
	lda     #$01
	sta     _pnotsafe
;
; if ((at1 & 1) || (at2 & 1)) pnotsafe = 1; 
;
L0E1A:	lda     _at1
	and     #$01
	bne     L0E26
	lda     _at2
	and     #$01
	beq     L0E38
L0E26:	lda     #$01
	sta     _pnotsafe
;
; } else if ((at1 & 1) || (at2 & 1)) {
;
	jmp     L0E38
L0DD0:	lda     _at1
	and     #$01
	bne     L0E2E
	lda     _at2
	and     #$01
	beq     L0E2D
;
; if ((pry & 15) > 4) hitv = 1;
;
L0E2E:	lda     _pry
	and     #$0F
	cmp     #$05
	bcc     L0E38
	lda     #$01
	sta     _hitv
;
; else {
;
	jmp     L0E38
;
; if ((at1 == 2) || (at2 == 2)) {
;
L0E2D:	lda     _at1
	cmp     #$02
	beq     L0E39
	lda     _at2
	cmp     #$02
	bne     L0E38
;
; pvy = PLAYER_VY_SINKING;
;
L0E39:	ldx     #$00
	sta     _pvy
	stx     _pvy+1
;
; ppossee = 1;
;
	lda     #$01
	sta     _ppossee
;
; if (vertical_engine_type == ENGINE_TYPE_JUMP) {
;
L0E38:	lda     _vertical_engine_type
	jne     L0E63
;
; && !pj
;
	lda     _a_button
	beq     L0E4A
;
; && (
;
	lda     _pj
	bne     L0E4A
;
; pgotten || ppossee || hitv
;
	lda     _pgotten
	bne     L0E44
	lda     _ppossee
	bne     L0E44
;
; )
;
	lda     _hitv
	beq     L0E4A
;
; jump_start ();
;
L0E44:	jsr     _jump_start
;
; if (!(pgotten || hitv || pnotsafe)) {
;
	lda     _pgotten
	bne     L0E4C
	lda     _hitv
	bne     L0E4C
	lda     _pnotsafe
	beq     L0E4D
L0E4C:	lda     #$01
L0E4D:	jsr     bnega
	beq     L0E4A
;
; player_register_safe_spot ();
;
	jsr     _player_register_safe_spot
;
; if (pad0 & PAD_A) {
;
L0E4A:	lda     _pad0
	and     #$01
	beq     L17F0
;
; if (pj) {
;
	lda     _pj
	beq     L0E63
;
; if (pctj < PLAYER_AY_JUMP) pvy -= (PLAYER_AY_JUMP - (pctj));
;
	lda     _pctj
	cmp     #$0C
	bcs     L0E53
	lda     #$0C
	sec
	sbc     _pctj
	eor     #$FF
	sec
	adc     _pvy
	sta     _pvy
	lda     #$FF
	adc     _pvy+1
	sta     _pvy+1
;
; if (pvy < -PLAYER_VY_JUMP_MAX) pvy = -PLAYER_VY_JUMP_MAX;
;
L0E53:	lda     _pvy
	cmp     #$40
	lda     _pvy+1
	sbc     #$FF
	bvc     L0E5B
	eor     #$80
L0E5B:	bpl     L0E59
	ldx     #$FF
	lda     #$40
	sta     _pvy
	stx     _pvy+1
;
; ++ pctj; if (pctj == 16) pj = 0; 
;
L0E59:	inc     _pctj
	lda     _pctj
	cmp     #$10
	bne     L0E63
	lda     #$00
;
; pj = 0; 
;
L17F0:	sta     _pj
;
; if (!(pad0 & PAD_LEFT || pad0 & PAD_RIGHT)) {
;
L0E63:	lda     _pad0
	and     #$40
	bne     L0E68
	lda     _pad0
	and     #$80
	beq     L0E69
L0E68:	lda     #$01
L0E69:	jsr     bnega
	beq     L0E80
;
; if (pvx > 0) {
;
	lda     _pvx
	cmp     #$01
	lda     _pvx+1
	sbc     #$00
	bvs     L0E6C
	eor     #$80
L0E6C:	bpl     L0E6A
;
; pvx -= pice ? PLAYER_RX_ICE : PLAYER_RX;
;
	lda     _pice
	beq     L0E6F
	lda     #$02
	jmp     L0E71
L0E6F:	lda     #$10
L0E71:	eor     #$FF
	sec
	adc     _pvx
	sta     _pvx
	lda     #$FF
	adc     _pvx+1
	sta     _pvx+1
;
; if (pvx < 0) pvx = 0;
;
	ldx     _pvx+1
	cpx     #$80
	bcc     L0E80
;
; } else if (pvx < 0) {
;
	jmp     L17F8
L0E6A:	ldx     _pvx+1
	cpx     #$80
	bcc     L0E80
;
; pvx += pice ? PLAYER_RX_ICE : PLAYER_RX;
;
	lda     _pice
	beq     L0E7C
	lda     #$02
	jmp     L0E7E
L0E7C:	lda     #$10
L0E7E:	clc
	adc     _pvx
	sta     _pvx
	lda     #$00
	adc     _pvx+1
	sta     _pvx+1
;
; if (pvx > 0) pvx = 0;
;
	lda     _pvx
	cmp     #$01
	lda     _pvx+1
	sbc     #$00
	bvs     L0E82
	eor     #$80
L0E82:	bpl     L0E80
L17F8:	lda     #$00
	sta     _pvx
	sta     _pvx+1
;
; if (pad0 & PAD_LEFT) {
;
L0E80:	lda     _pad0
	and     #$40
	beq     L0E89
;
; pfacing = CELL_FACING_LEFT;  
;
	lda     #$08
	sta     _pfacing
;
; if (pvx > -PLAYER_VX_MAX) {
;
	lda     _pvx
	cmp     #$81
	lda     _pvx+1
	sbc     #$FF
	bvs     L0E8B
	eor     #$80
L0E8B:	bpl     L0E89
;
; pvx -= pice ? PLAYER_AX_ICE : PLAYER_AX;
;
	lda     _pice
	beq     L0E8E
	lda     #$04
	jmp     L0E90
L0E8E:	lda     #$10
L0E90:	eor     #$FF
	sec
	adc     _pvx
	sta     _pvx
	lda     #$FF
	adc     _pvx+1
	sta     _pvx+1
;
; if (pad0 & PAD_RIGHT) {
;
L0E89:	lda     _pad0
	and     #$80
	beq     L0E96
;
; pfacing = CELL_FACING_RIGHT;
;
	lda     #$00
	sta     _pfacing
;
; if (pvx < PLAYER_VX_MAX) {
;
	lda     _pvx
	cmp     #$80
	lda     _pvx+1
	sbc     #$00
	bvc     L0E98
	eor     #$80
L0E98:	bpl     L0E96
;
; pvx += pice ? PLAYER_AX_ICE : PLAYER_AX;
;
	lda     _pice
	beq     L0E9B
	lda     #$04
	jmp     L0E9D
L0E9B:	lda     #$10
L0E9D:	clc
	adc     _pvx
	sta     _pvx
	lda     #$00
	adc     _pvx+1
	sta     _pvx+1
;
; px += pvx;
;
L0E96:	lda     _pvx
	clc
	adc     _px
	sta     _px
	lda     _pvx+1
	adc     _px+1
	sta     _px+1
;
; if (pgotten) px += pgtmx;
;
	lda     _pgotten
	beq     L0EA1
	lda     _pgtmx
	clc
	adc     _px
	sta     _px
	lda     _pgtmx+1
	adc     _px+1
	sta     _px+1
;
; if (px < (4<<FIXBITS)) { px = 4 << FIXBITS; prx = 4;}
;
L0EA1:	ldx     _px+1
	cpx     #$01
	bcs     L0EA5
	ldx     #$01
	lda     #$00
	sta     _px
	stx     _px+1
	dex
	lda     #$04
	sta     _prx
	stx     _prx+1
;
; else if (px > (MAX_PRX << FIXBITS)) { px = MAX_PRX << FIXBITS; prx = MAX_PRX; }
;
	jmp     L0EB4
L0EA5:	lda     _px
	cmp     #$01
	lda     _px+1
	sbc     #$7D
	bcc     L0EAD
	ldx     #$7D
	lda     #$00
	sta     _px
	stx     _px+1
	ldx     #$01
	lda     #$F4
	sta     _prx
	stx     _prx+1
;
; else player_to_pixels ();
;
	jmp     L0EB4
L0EAD:	jsr     _player_to_pixels
;
; cy1 = (pry - PLAYER_COLLISION_VSTRETCH_BG) >> 4;
;
L0EB4:	lda     _pry
	sec
	sbc     #$FC
	pha
	lda     #$00
	sbc     #$FF
	tax
	pla
	jsr     shrax4
	sta     _cy1
;
; cy2 = (pry + 15) >> 4;
;
	ldx     #$00
	lda     _pry
	clc
	adc     #$0F
	bcc     L0EBC
	inx
L0EBC:	jsr     shrax4
	sta     _cy2
;
; rds16 = pvx + pgtmx;
;
	lda     _pvx
	clc
	adc     _pgtmx
	sta     _rds16
	lda     _pvx+1
	adc     _pgtmx+1
	sta     _rds16+1
;
; if (rds16)  {
;
	lda     _rds16
	ora     _rds16+1
	jeq     L0F03
;
; if (rds16 < 0) {
;
	ldx     _rds16+1
	cpx     #$80
	bcc     L0EC1
;
; cx1 = cx2 = prx >> 4; 
;
	lda     _prx
	ldx     _prx+1
	jsr     shrax4
	sta     _cx2
	sta     _cx1
;
; PRXA = (cx1 + 1) << 4;
;
	ldx     #$00
	lda     _cx1
	clc
	adc     #$01
	bcc     L0EC9
	inx
L0EC9:	jsr     shlax4
	sta     _gpint
	stx     _gpint+1
;
; rdm = cx1 - 1;
;
	lda     _cx1
	sec
	sbc     #$01
	bcs     L0EDB
;
; } else {
;
	jmp     L0EDB
;
; cx1 = cx2 = (prx + 8) >> 4;
;
L0EC1:	lda     _prx
	ldx     _prx+1
	clc
	adc     #$08
	bcc     L0ED2
	inx
L0ED2:	jsr     shrax4
	sta     _cx2
	sta     _cx1
;
; PRXA = ((cx1 - 1) << 4) + 8;
;
	ldx     #$00
	lda     _cx1
	sec
	sbc     #$01
	bcs     L0ED7
	dex
L0ED7:	jsr     shlax4
	clc
	adc     #$08
	bcc     L0ED8
	inx
L0ED8:	sta     _gpint
	stx     _gpint+1
;
; rdm = cx1 + 1;
;
	lda     _cx1
	clc
	adc     #$01
L0EDB:	sta     _rdm
;
; cm_two_points ();
;
	jsr     _cm_two_points
;
; if ((at1 & 8) || (at2 & 8)) {
;
	lda     _at1
	and     #$08
	bne     L0EDE
	lda     _at2
	and     #$08
	jeq     L0EDD
;
; pvx = 0; prx = PRXA; px = prx << FIXBITS; pfiring = 1;
;
L0EDE:	lda     #$00
	sta     _pvx
	sta     _pvx+1
	lda     _gpint
	ldx     _gpint+1
	sta     _prx
	stx     _prx+1
	jsr     shlax4
	jsr     shlax2
	sta     _px
	stx     _px+1
	lda     #$01
	sta     _pfiring
;
; if (at1 & 2) player_process_tile (at1, cx1, cy1, rdm, cy1);
;
	lda     _at1
	ldx     #$00
	and     #$02
	beq     L0EEA
	ldy     #$0A
	jsr     subysp
	lda     _at1
	ldy     #$08
	sta     (sp),y
	iny
	lda     #$00
	sta     (sp),y
	lda     _cx1
	ldy     #$06
	sta     (sp),y
	iny
	lda     #$00
	sta     (sp),y
	lda     _cy1
	ldy     #$04
	sta     (sp),y
	iny
	lda     #$00
	sta     (sp),y
	lda     _rdm
	ldy     #$02
	sta     (sp),y
	iny
	lda     #$00
	sta     (sp),y
	lda     _cy1
	ldy     #$00
	sta     (sp),y
	iny
	lda     #$00
	sta     (sp),y
	jsr     _player_process_tile
;
; if (cy1 != cy2) if (at2 & 2) player_process_tile (at2, cx1, cy2, rdm, cy2);
;
L0EEA:	lda     _cy1
	jsr     pusha0
	lda     _cy2
	jsr     tosicmp0
	beq     L0EFC
	lda     _at2
	ldx     #$00
	and     #$02
	beq     L0EFC
	ldy     #$0A
	jsr     subysp
	lda     _at2
	ldy     #$08
	sta     (sp),y
	iny
	lda     #$00
	sta     (sp),y
	lda     _cx1
	ldy     #$06
	sta     (sp),y
	iny
	lda     #$00
	sta     (sp),y
	lda     _cy2
	ldy     #$04
	sta     (sp),y
	iny
	lda     #$00
	sta     (sp),y
	lda     _rdm
	ldy     #$02
	sta     (sp),y
	iny
	lda     #$00
	sta     (sp),y
	lda     _cy2
	ldy     #$00
	sta     (sp),y
	iny
	lda     #$00
	sta     (sp),y
	jsr     _player_process_tile
;
; } else {
;
	jmp     L0EFC
;
; hith = ((at1 & 1) || (at2 & 1));
;
L0EDD:	lda     _at1
	and     #$01
	bne     L0EFF
	lda     _at2
	and     #$01
	beq     L0F02
L0EFF:	lda     #$01
L0F02:	sta     _hith
;
; if (pvy > 0) hith &= ((pry & 15) > 4);
;
L0EFC:	lda     _pvy
	cmp     #$01
	lda     _pvy+1
	sbc     #$00
	bvs     L0F05
	eor     #$80
L0F05:	bpl     L0F03
	lda     _pry
	and     #$0F
	cmp     #$05
	lda     #$00
	rol     a
	and     _hith
	sta     _hith
;
; phit = 0;
;
L0F03:	lda     #$00
	sta     _phit
;
; if (pgotten == 0) {
;
	lda     _pgotten
	jne     L0F64
;
; if (hitv) { phit = 1; pvy = ADD_SIGN (-pvy, PLAYER_V_REBOUND); pry = pcy; py = pry << FIXBITS; } 
;
	lda     _hitv
	beq     L0F0E
	lda     #$01
	sta     _phit
	lda     _pvy
	ldx     _pvy+1
	jsr     negax
	stx     tmp1
	ora     tmp1
	beq     L0F16
	lda     _pvy
	ldx     _pvy+1
	jsr     negax
	cmp     #$01
	txa
	sbc     #$00
	bvs     L0F1B
	eor     #$80
L0F1B:	bpl     L0F1C
	ldx     #$00
	lda     #$E0
	jmp     L0F23
L0F1C:	ldx     #$FF
	lda     #$20
	jmp     L0F23
L0F16:	tax
L0F23:	sta     _pvy
	stx     _pvy+1
	lda     _pcy
	sta     _pry
	ldx     #$00
	lda     _pry
	jsr     aslax4
	jsr     aslax2
	sta     _py
	stx     _py+1
;
; else
;
	jmp     L0F2B
;
; if (hith) { phit = 1; pvx = ADD_SIGN (-pvx, PLAYER_V_REBOUND); prx = pcx; px = prx << FIXBITS; }
;
L0F0E:	lda     _hith
	beq     L0F2B
	lda     #$01
	sta     _phit
	lda     _pvx
	ldx     _pvx+1
	jsr     negax
	stx     tmp1
	ora     tmp1
	beq     L0F33
	lda     _pvx
	ldx     _pvx+1
	jsr     negax
	cmp     #$01
	txa
	sbc     #$00
	bvs     L0F38
	eor     #$80
L0F38:	bpl     L0F39
	ldx     #$00
	lda     #$E0
	jmp     L0F40
L0F39:	ldx     #$FF
	lda     #$20
	jmp     L0F40
L0F33:	tax
L0F40:	sta     _pvx
	stx     _pvx+1
	lda     _pcx
	ldx     _pcx+1
	sta     _prx
	stx     _prx+1
	jsr     shlax4
	jsr     shlax2
	sta     _px
	stx     _px+1
;
; cx1 = cx2 = (prx + 4) >> 4;
;
L0F2B:	lda     _prx
	ldx     _prx+1
	clc
	adc     #$04
	bcc     L0F4B
	inx
L0F4B:	jsr     shrax4
	sta     _cx2
	sta     _cx1
;
; cy1 = (pry - PLAYER_COLLISION_VSTRETCH_BG) >> 4; cy2 = (pry + 15) >> 4;
;
	lda     _pry
	sec
	sbc     #$FC
	pha
	lda     #$00
	sbc     #$FF
	tax
	pla
	jsr     shrax4
	sta     _cy1
	ldx     #$00
	lda     _pry
	clc
	adc     #$0F
	bcc     L0F52
	inx
L0F52:	jsr     shrax4
	sta     _cy2
;
; cm_two_points ();
;
	jsr     _cm_two_points
;
; if ((at1 & 1) || (at2 & 1)) phit = 1;
;
	lda     _at1
	and     #$01
	bne     L0F55
	lda     _at2
	and     #$01
	beq     L0F54
L0F55:	lda     #$01
	sta     _phit
;
; if (!pflickering && !pbouncing) if (phit) { 
;
L0F54:	lda     _pflickering
	bne     L0F64
	lda     _pbouncing
	bne     L0F64
	lda     _phit
	beq     L0F64
;
; player_to_pixels ();
;
	jsr     _player_to_pixels
;
; en_sg_2 = 1;
;
	lda     #$01
	sta     _en_sg_2
;
; if (en_sg_2)
;
	lda     _en_sg_2
	beq     L0F64
;
; pkill = 1; 
;
	lda     #$01
	sta     _pkill
;
; ) {
;
L0F64:	lda     _b_button
	beq     L0F6A
;
; if (b_button) fire_bullet ();
;
	lda     _b_button
	beq     L0F6A
	jsr     _fire_bullet
;
; if (ppossee || pgotten) {
;
L0F6A:	lda     _ppossee
	bne     L0F6E
	lda     _pgotten
	beq     L0F6D
;
; if (pvx > PLAYER_VX_MIN || pvx < -PLAYER_VX_MIN) {
;
L0F6E:	lda     _pvx
	cmp     #$41
	lda     _pvx+1
	sbc     #$00
	bvs     L0F73
	eor     #$80
L0F73:	bmi     L0F71
	lda     _pvx
	cmp     #$C0
	lda     _pvx+1
	sbc     #$FF
	bvc     L0F75
	eor     #$80
L0F75:	bpl     L0F70
;
; psprid = CELL_WALK_CYCLE + ((prx >> 3) & 3);
;
L0F71:	lda     _prx
	ldx     _prx+1
	jsr     shrax3
	and     #$03
	clc
	adc     #$01
	bcc     L17F2
;
; } else {
;
	jmp     L17F2
;
; psprid = CELL_IDLE;
;
L0F70:	lda     #$00
;
; } else {
;
	jmp     L17F2
;
; if (pvy < PLAYER_VY_FALLING_MIN)
;
L0F6D:	lda     _pvy
	cmp     #$40
	lda     _pvy+1
	sbc     #$00
	bvc     L0F82
	eor     #$80
L0F82:	bpl     L0F80
;
; psprid = CELL_ASCENDING;
;
	lda     #$05
;
; else
;
	jmp     L17F2
;
; psprid = CELL_DESCENDING; 
;
L0F80:	lda     #$06
L17F2:	sta     _psprid
;
; psprid += pfacing;
;
	lda     _pfacing
	clc
	adc     _psprid
	sta     _psprid
;
; prx_old = prx;
;
	lda     _prx
	sta     _prx_old
;
; pry_old = pry;
;
	lda     _pry
	sta     _pry_old
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ enems_draw_chac_chac (unsigned char, unsigned char, unsigned char)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_enems_draw_chac_chac: near

.segment	"CODE"

;
; _x = en_x [gpit]; _y = en_y [gpit]    ; _t = a1; map_set ();
;
	ldy     _gpit
	lda     _en_x,y
	sta     __x
	ldy     _gpit
	lda     _en_y,y
	sta     __y
	ldy     #$02
	lda     (sp),y
	sta     __t
	jsr     _map_set
;
; _x = en_x [gpit]; _y = en_y [gpit] + 1; _t = a2; map_set ();
;
	ldy     _gpit
	lda     _en_x,y
	sta     __x
	ldy     _gpit
	lda     _en_y,y
	clc
	adc     #$01
	sta     __y
	ldy     #$01
	lda     (sp),y
	sta     __t
	jsr     _map_set
;
; _x = en_x [gpit]; _y = en_y [gpit] + 2; _t = a3; map_set ();
;
	ldy     _gpit
	lda     _en_x,y
	sta     __x
	ldy     _gpit
	lda     _en_y,y
	clc
	adc     #$02
	sta     __y
	ldy     #$00
	lda     (sp),y
	sta     __t
	jsr     _map_set
;
; }
;
	jmp     incsp3

.endproc

; ---------------------------------------------------------------
; void __near__ enems_update_unsigned_char_arrays (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_enems_update_unsigned_char_arrays: near

.segment	"CODE"

;
; __asm__ ("ldy %v", gpit);
;
	ldy     _gpit
;
; __asm__ ("lda %v", _en_t);
;
	lda     __en_t
;
; __asm__ ("sta %v, y", en_t);
;
	sta     _en_t,y
;
; __asm__ ("lda %v", _en_s);
;
	lda     __en_s
;
; __asm__ ("sta %v, y", en_s);
;
	sta     _en_s,y
;
; __asm__ ("lda %v", _en_x);
;
	lda     __en_x
;
; __asm__ ("sta %v, y", en_x);
;
	sta     _en_x,y
;
; __asm__ ("lda %v", _en_y);
;
	lda     __en_y
;
; __asm__ ("sta %v, y", en_y);
;
	sta     _en_y,y
;
; __asm__ ("lda %v", _en_x1);
;
	lda     __en_x1
;
; __asm__ ("sta %v, y", en_x1);
;
	sta     _en_x1,y
;
; __asm__ ("lda %v", _en_x2);
;
	lda     __en_x2
;
; __asm__ ("sta %v, y", en_x2);
;
	sta     _en_x2,y
;
; __asm__ ("lda %v", _en_y1);
;
	lda     __en_y1
;
; __asm__ ("sta %v, y", en_y1);
;
	sta     _en_y1,y
;
; __asm__ ("lda %v", _en_y2);
;
	lda     __en_y2
;
; __asm__ ("sta %v, y", en_y2);
;
	sta     _en_y2,y
;
; __asm__ ("lda %v", _en_mx);
;
	lda     __en_mx
;
; __asm__ ("sta %v, y", en_mx);
;
	sta     _en_mx,y
;
; __asm__ ("lda %v", _en_my);
;
	lda     __en_my
;
; __asm__ ("sta %v, y", en_my);
;
	sta     _en_my,y
;
; __asm__ ("lda %v", _en_ct);
;
	lda     __en_ct
;
; __asm__ ("sta %v, y", en_ct);
;
	sta     _en_ct,y
;
; __asm__ ("lda %v", _en_facing);
;
	lda     __en_facing
;
; __asm__ ("sta %v, y", en_facing);
;
	sta     _en_facing,y
;
; __asm__ ("lda %v", _en_state);
;
	lda     __en_state
;
; __asm__ ("sta %v, y", en_state);
;
	sta     _en_state,y
;
; enf_x [gpit] = _enf_x; enf_vx [gpit] = _enf_vx;
;
	ldx     #$00
	lda     _gpit
	asl     a
	bcc     L17FD
	inx
	clc
L17FD:	adc     #<(_enf_x)
	sta     ptr1
	txa
	adc     #>(_enf_x)
	sta     ptr1+1
	lda     __enf_x
	ldy     #$00
	sta     (ptr1),y
	iny
	lda     __enf_x+1
	sta     (ptr1),y
	ldx     #$00
	lda     _gpit
	asl     a
	bcc     L17FE
	inx
	clc
L17FE:	adc     #<(_enf_vx)
	sta     ptr1
	txa
	adc     #>(_enf_vx)
	sta     ptr1+1
	lda     __enf_vx
	dey
	sta     (ptr1),y
	iny
	lda     __enf_vx+1
	sta     (ptr1),y
;
; enf_y [gpit] = _enf_y; enf_vy [gpit] = _enf_vy;
;
	ldx     #$00
	lda     _gpit
	asl     a
	bcc     L17FF
	inx
	clc
L17FF:	adc     #<(_enf_y)
	sta     ptr1
	txa
	adc     #>(_enf_y)
	sta     ptr1+1
	lda     __enf_y
	dey
	sta     (ptr1),y
	iny
	lda     __enf_y+1
	sta     (ptr1),y
	ldx     #$00
	lda     _gpit
	asl     a
	bcc     L1800
	inx
	clc
L1800:	adc     #<(_enf_vy)
	sta     ptr1
	txa
	adc     #>(_enf_vy)
	sta     ptr1+1
	lda     __enf_vy
	dey
	sta     (ptr1),y
	iny
	lda     __enf_vy+1
	sta     (ptr1),y
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ enems_facing (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_enems_facing: near

.segment	"CODE"

;
; _en_facing = rda << 2;
;
	lda     _rda
	asl     a
	asl     a
	sta     __en_facing
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ enems_init_fp (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_enems_init_fp: near

.segment	"CODE"

;
; if (gpit > 2) 
;
	lda     _gpit
	cmp     #$03
	bcc     L0FDE
;
; _enf_x = (256 + _en_x) << 6;
;
	lda     __en_x
	ldx     #$01
	jsr     shlax4
	jsr     shlax2
;
; else
;
	jmp     L1802
;
; _enf_x = _en_x << 6;
;
L0FDE:	ldx     #$00
	lda     __en_x
	jsr     aslax4
	jsr     aslax2
L1802:	sta     __enf_x
	stx     __enf_x+1
;
; _enf_y = _en_y << 6;
;
	ldx     #$00
	lda     __en_y
	jsr     aslax4
	jsr     aslax2
	sta     __enf_y
	stx     __enf_y+1
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ enems_boioiong_init (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_enems_boioiong_init: near

.segment	"CODE"

;
; enems_init_fp ();
;
	jsr     _enems_init_fp
;
; _enf_vy = 0; 
;
	ldx     #$00
	txa
	sta     __enf_vy
	sta     __enf_vy+1
;
; _enf_vx = ADD_SIGN2 (_en_x2, _en_x1, rdm << FIXBITS);
;
	lda     __en_x1
	cmp     __en_x2
	bne     L0FF1
	txa
	jmp     L0FFD
L0FF1:	lda     __en_x2
	sec
	sbc     __en_x1
	bcc     L0FFA
	beq     L0FFA
	lda     _rdm
	jsr     aslax4
	jsr     aslax2
	jmp     L0FFD
L0FFA:	lda     _rdm
	jsr     aslax4
	jsr     aslax2
	jsr     negax
L0FFD:	sta     __enf_vx
	stx     __enf_vx+1
;
; _en_ct = 0;
;
	lda     #$00
	sta     __en_ct
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ enems_load (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_enems_load: near

.segment	"CODE"

;
; gp_gen = (unsigned char *) (c_enems + (n_pant << 2) + (n_pant << 3)); // * 12
;
	ldx     #$00
	lda     _n_pant
	jsr     aslax2
	clc
	adc     _c_enems
	sta     ptr1
	txa
	adc     _c_enems+1
	sta     ptr1+1
	ldx     #$00
	lda     _n_pant
	jsr     aslax3
	clc
	adc     ptr1
	sta     _gp_gen
	txa
	adc     ptr1+1
	sta     _gp_gen+1
;
; for (gpit = 0; gpit < NENEMS; gpit ++) {
;
	lda     #$00
L1811:	sta     _gpit
	cmp     #$06
	bcc     L1812
;
; }
;
	rts
;
; SET_FROM_PTR (_en_t, gp_gen); gp_gen ++;
;
L1812:	ldy     #0
	lda     (_gp_gen),y
	sta     __en_t
	lda     _gp_gen
	ldx     _gp_gen+1
	clc
	adc     #$01
	bcc     L1015
	inx
L1015:	sta     _gp_gen
	stx     _gp_gen+1
;
; _en_state = 0;
;
	sty     __en_state
;
; SET_FROM_PTR (rda, gp_gen); gp_gen ++;
;
	lda     (_gp_gen),y
	sta     _rda
	lda     _gp_gen
	ldx     _gp_gen+1
	clc
	adc     #$01
	bcc     L101C
	inx
L101C:	sta     _gp_gen
	stx     _gp_gen+1
;
; _en_y1 = rda & 0xf0;
;
	lda     _rda
	and     #$F0
	sta     __en_y1
;
; _en_x1 = rda << 4;
;
	lda     _rda
	asl     a
	asl     a
	asl     a
	asl     a
	sta     __en_x1
;
; SET_FROM_PTR (rda, gp_gen); gp_gen ++;
;
	lda     (_gp_gen),y
	sta     _rda
	lda     _gp_gen
	ldx     _gp_gen+1
	clc
	adc     #$01
	bcc     L1025
	inx
L1025:	sta     _gp_gen
	stx     _gp_gen+1
;
; _en_y2 = rda & 0xf0;
;
	lda     _rda
	and     #$F0
	sta     __en_y2
;
; _en_x2 = rda << 4;
;
	lda     _rda
	asl     a
	asl     a
	asl     a
	asl     a
	sta     __en_x2
;
; SET_FROM_PTR (rda, gp_gen); gp_gen ++;
;
	lda     (_gp_gen),y
	sta     _rda
	lda     _gp_gen
	ldx     _gp_gen+1
	clc
	adc     #$01
	bcc     L102E
	inx
L102E:	sta     _gp_gen
	stx     _gp_gen+1
;
; rdd = rda & 0xf0;  // Used for respawn speed!
;
	lda     _rda
	and     #$F0
	sta     _rdd
;
; rdm = rda & 0x0f;  // Actual speed.
;
	lda     _rda
	and     #$0F
	sta     _rdm
;
; _en_x = _en_x1;
;
	lda     __en_x1
	sta     __en_x
;
; _en_y = _en_y1;
;
	lda     __en_y1
	sta     __en_y
;
; switch (_en_t & 0x3f) {
;
	lda     __en_t
	and     #$3F
;
; }
;
	cmp     #$01
	beq     L103B
	cmp     #$02
	beq     L103B
	cmp     #$03
	beq     L103B
	cmp     #$04
	beq     L103B
	cmp     #$06
	jeq     L1094
	cmp     #$08
	jeq     L109C
	cmp     #$09
	jeq     L110C
	cmp     #$0A
	jeq     L1117
	cmp     #$0B
	jeq     L1129
	jmp     L1039
;
; _en_ct = 0;   
;
L103B:	sty     __en_ct
;
; _en_s = (_en_t - 1) << 3;
;
	lda     __en_t
	sec
	sbc     #$01
	asl     a
	asl     a
	asl     a
	sta     __en_s
;
; _en_mx = ADD_SIGN2 (_en_x2, _en_x1, rdm);
;
	lda     __en_x1
	cmp     __en_x2
	bne     L104D
	tya
	jmp     L1059
L104D:	ldx     #$00
	lda     __en_x2
	sec
	sbc     __en_x1
	bcc     L1056
	beq     L1056
	lda     _rdm
	jmp     L1059
L1056:	lda     _rdm
	jsr     negax
L1059:	sta     __en_mx
;
; _en_my = ADD_SIGN2 (_en_y2, _en_y1, rdm);
;
	lda     __en_y1
	cmp     __en_y2
	bne     L1062
	tya
	jmp     L106E
L1062:	ldx     #$00
	lda     __en_y2
	sec
	sbc     __en_y1
	bcc     L106B
	beq     L106B
	lda     _rdm
	jmp     L106E
L106B:	lda     _rdm
	jsr     negax
L106E:	sta     __en_my
;
; if (rdm == 1) {
;
	lda     _rdm
	cmp     #$01
	bne     L1072
;
; en_status [gpit] = 1; 
;
	ldy     _gpit
	sta     _en_status,y
;
; } else {
;
	jmp     L1078
;
; en_status [gpit] = 0;
;
L1072:	ldy     _gpit
	lda     #$00
	sta     _en_status,y
;
; _en_mx >>= 1;
;
	tax
	lda     __en_mx
	bpl     L107E
	dex
L107E:	jsr     asrax1
	sta     __en_mx
;
; _en_my >>= 1;
;
	ldx     #$00
	lda     __en_my
	bpl     L1081
	dex
L1081:	jsr     asrax1
	sta     __en_my
;
; if (_en_x1 > _en_x2) { rda = _en_x1; _en_x1 = _en_x2; _en_x2 = rda; }
;
L1078:	lda     __en_x1
	sec
	sbc     __en_x2
	bcc     L1083
	beq     L1083
	lda     __en_x1
	sta     _rda
	lda     __en_x2
	sta     __en_x1
	lda     _rda
	sta     __en_x2
;
; if (_en_y1 > _en_y2) { rda = _en_y1; _en_y1 = _en_y2; _en_y2 = rda; }
;
L1083:	lda     __en_y1
	sec
	sbc     __en_y2
	jcc     L1039
	jeq     L1039
	lda     __en_y1
	sta     _rda
	lda     __en_y2
	sta     __en_y1
	lda     _rda
	sta     __en_y2
;
; break;
;
	jmp     L1039
;
; enems_init_fp ();
;
L1094:	jsr     _enems_init_fp
;
; _enf_vx = _enf_vy = 0;
;
	lda     #$00
	sta     __enf_vy
	sta     __enf_vy+1
	sta     __enf_vx
	sta     __enf_vx+1
;
; _en_s = FANTY_BASE_SPRID;
;
	lda     #$20
;
; break;
;
	jmp     L180B
;
; _en_mx = ADD_SIGN2 (_en_x2, _en_x1, rdm);
;
L109C:	lda     __en_x1
	cmp     __en_x2
	bne     L10A2
	tya
	jmp     L10AE
L10A2:	ldx     #$00
	lda     __en_x2
	sec
	sbc     __en_x1
	bcc     L10AB
	beq     L10AB
	lda     _rdm
	jmp     L10AE
L10AB:	lda     _rdm
	jsr     negax
L10AE:	sta     __en_mx
;
; _en_my = ADD_SIGN2 (_en_y2, _en_y1, rdm);
;
	lda     __en_y1
	cmp     __en_y2
	bne     L10B7
	tya
	jmp     L10C3
L10B7:	ldx     #$00
	lda     __en_y2
	sec
	sbc     __en_y1
	bcc     L10C0
	beq     L10C0
	lda     _rdm
	jmp     L10C3
L10C0:	lda     _rdm
	jsr     negax
L10C3:	sta     __en_my
;
; rda = ABS (_en_mx); if (!rda) rda = ABS (_en_my);
;
	lda     __en_mx
	asl     a
	bcc     L10CC
	ldx     #$00
	lda     __en_mx
	bpl     L10CF
	dex
L10CF:	jsr     negax
L10D4:	cmp     #$80
	bcc     L10D5
	jmp     L10D5
L10CC:	lda     __en_mx
	cmp     #$80
	bcc     L10D4
L10D5:	sta     _rda
	lda     _rda
	bne     L10D6
	lda     __en_my
	asl     a
	bcc     L10DD
	ldx     #$00
	lda     __en_my
	bpl     L10E0
	dex
L10E0:	jsr     negax
L10E5:	cmp     #$80
	bcc     L10E6
	jmp     L10E6
L10DD:	lda     __en_my
	cmp     #$80
	bcc     L10E5
L10E6:	sta     _rda
;
; -- rda;
;
L10D6:	dec     _rda
;
; rdb = (_en_x1 != _en_x2) ? 
;
	lda     __en_x2
	cmp     __en_x1
;
; SGNC (_en_x2, _en_x1, SAW_V_DISPL) :
;
	beq     L10EB
	lda     __en_x2
	cmp     __en_x1
	bcs     L1810
	lda     #$FC
	jmp     L10FE
;
; SGNC (_en_y2, _en_y1, SAW_V_DISPL);
;
L10EB:	lda     __en_y2
	cmp     __en_y1
	bcs     L1810
	lda     #$FC
	jmp     L10FE
L1810:	lda     #$04
L10FE:	sta     _rdb
;
; _en_my = rda; // EMERGING SENSE
;
	lda     _rda
	sta     __en_my
;
; _en_mx = rdb; // MOVING SENSE
;
	lda     _rdb
	sta     __en_mx
;
; _en_state = 1;
;
	lda     #$01
	sta     __en_state
;
; _en_ct = SAW_EMERGING_STEPS;
;
	lda     #$0A
	sta     __en_ct
;
; break;
;
	jmp     L1039
;
; _en_my = PEZON_WAIT + (rda << 3); // Speed in colocador defines idle time! (x8)
;
L110C:	ldx     #$00
	lda     _rda
	jsr     aslax3
	clc
	adc     #$32
	sta     __en_my
;
; _en_mx = _en_my;
;
	sta     __en_mx
;
; _en_s = PEZONS_BASE_SPRID;
;
	lda     #$28
;
; break;
;
	jmp     L180B
;
; _en_my = (rda << 4); // IDLE_1
;
L1117:	lda     _rda
	asl     a
	asl     a
	asl     a
	asl     a
	sta     __en_my
;
; _en_x = _en_x1 >> 4;
;
	ldx     #$00
	lda     __en_x1
	jsr     asrax4
	sta     __en_x
;
; if (gpit > 2) _en_x += 16;
;
	lda     _gpit
	cmp     #$03
	bcc     L111D
	lda     #$10
	clc
	adc     __en_x
	sta     __en_x
;
; _en_y = (_en_y1 >> 4) - 1;
;
L111D:	ldx     #$00
	lda     __en_y1
	jsr     asrax4
	sec
	sbc     #$01
	sta     __en_y
;
; _en_mx = _en_my;
;
	lda     __en_my
	sta     __en_mx
;
; break;
;
	jmp     L1039
;
; _en_state = 0; _en_ct = MONOCOCO_BASE_TIME_HIDDEN - (rand8 () & 0x15);
;
L1129:	sty     __en_state
	lda     #$96
	jsr     pusha0
	jsr     _rand8
	and     #$15
	jsr     tossuba0
	sta     __en_ct
;
; _en_s = MONOCOCO_BASE_SPRID;
;
	lda     #$38
L180B:	sta     __en_s
;
; en_life [gpit] = _en_t == 6 ? FANTY_LIFE_GAUGE : ENEMS_LIFE_GAUGE;
;
L1039:	lda     #<(_en_life)
	ldx     #>(_en_life)
	clc
	adc     _gpit
	bcc     L1133
	inx
L1133:	sta     ptr1
	stx     ptr1+1
	lda     __en_t
	cmp     #$06
	bne     L1135
	lda     #$05
	jmp     L1137
L1135:	lda     #$02
L1137:	ldy     #$00
	sta     (ptr1),y
;
; en_cttouched [gpit] = 0;
;
	ldy     _gpit
	lda     #$00
	sta     _en_cttouched,y
;
; en_flags [gpit] = 0;
;
	ldy     _gpit
	sta     _en_flags,y
;
; enems_update_unsigned_char_arrays ();
;
	jsr     _enems_update_unsigned_char_arrays
;
; for (gpit = 0; gpit < NENEMS; gpit ++) {
;
	lda     _gpit
	clc
	adc     #$01
	jmp     L1811

.endproc

; ---------------------------------------------------------------
; void __near__ enems_kill (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_enems_kill: near

.segment	"CODE"

;
; en_flags [gpit] |= EN_STATE_DEAD;
;
	lda     #<(_en_flags)
	ldx     #>(_en_flags)
	clc
	adc     _gpit
	bcc     L1145
	inx
L1145:	sta     ptr1
	stx     ptr1+1
	ldy     #$00
	lda     (ptr1),y
	ora     #$01
	sta     (ptr1),y
;
; ++ pkilled;
;
	inc     _pkilled
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ enems_hit (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_enems_hit: near

.segment	"CODE"

;
; _en_facing = ((_en_x < prx) ? 0 : 4);
;
	lda     __en_x
	cmp     _prx
	lda     #$00
	sbc     _prx+1
	bcs     L114D
	lda     #$00
	jmp     L114F
L114D:	lda     #$04
L114F:	sta     __en_facing
;
; en_cttouched [gpit] = ENEMS_TOUCHED_FRAMES;
;
	ldy     _gpit
	lda     #$10
	sta     _en_cttouched,y
;
; -- en_life [gpit]; 
;
	lda     #<(_en_life)
	ldx     #>(_en_life)
	clc
	adc     _gpit
	bcc     L1157
	inx
L1157:	sta     ptr1
	stx     ptr1+1
	ldy     #$00
	lda     (ptr1),y
	sec
	sbc     #$01
	sta     (ptr1),y
;
; if (en_life [gpit] == 0) 
;
	ldy     _gpit
	lda     _en_life,y
;
; enems_kill ();
;
	jeq     _enems_kill
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ enems_move (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_enems_move: near

.segment	"CODE"

;
; pgotten = pgtmx = pgtmy = 0;
;
	lda     #$00
	sta     _pgtmy
	sta     _pgtmy+1
	sta     _pgtmx
	sta     _pgtmx+1
	sta     _pgotten
;
; touched = 0;
;
	sta     _touched
;
; ++ en_initial; if (en_initial >= NENEMS) en_initial = 0;
;
	inc     _en_initial
	lda     _en_initial
	cmp     #$06
	bcc     L1165
	lda     #$00
	sta     _en_initial
;
; gpit = en_initial;
;
L1165:	lda     _en_initial
	sta     _gpit
;
; gpjt = NENEMS; while (gpjt --) {
;
	lda     #$06
	sta     _gpjt
L116D:	lda     _gpjt
	pha
	sec
	sbc     #$01
	sta     _gpjt
	pla
	tax
	bne     L1857
;
; }
;
	rts
;
; gpit += NENEMS-1; if (gpit > NENEMS-1) gpit -=NENEMS;
;
L1857:	lda     #$05
	clc
	adc     _gpit
	sta     _gpit
	cmp     #$06
	bcc     L1172
	lda     _gpit
	sec
	sbc     #$06
	sta     _gpit
;
; en_x_offs = (gpit < 3 ? 0 : 256);
;
L1172:	lda     _gpit
	cmp     #$03
	bcs     L1179
	ldx     #$00
	jmp     L1833
L1179:	ldx     #$01
L1833:	lda     #$00
	sta     _en_x_offs
	stx     _en_x_offs+1
;
; __asm__ ("ldy %v", gpit);
;
	ldy     _gpit
;
; __asm__ ("lda %v, y", en_t);
;
	lda     _en_t,y
;
; __asm__ ("sta %v", _en_t);
;
	sta     __en_t
;
; __asm__ ("lda %v, y", en_s);
;
	lda     _en_s,y
;
; __asm__ ("sta %v", _en_s);
;
	sta     __en_s
;
; __asm__ ("lda %v, y", en_x);
;
	lda     _en_x,y
;
; __asm__ ("sta %v", _en_x);
;
	sta     __en_x
;
; __asm__ ("lda %v, y", en_y);
;
	lda     _en_y,y
;
; __asm__ ("sta %v", _en_y);
;
	sta     __en_y
;
; __asm__ ("lda %v, y", en_x1);
;
	lda     _en_x1,y
;
; __asm__ ("sta %v", _en_x1);
;
	sta     __en_x1
;
; __asm__ ("lda %v, y", en_x2);
;
	lda     _en_x2,y
;
; __asm__ ("sta %v", _en_x2);
;
	sta     __en_x2
;
; __asm__ ("lda %v, y", en_y1);
;
	lda     _en_y1,y
;
; __asm__ ("sta %v", _en_y1);
;
	sta     __en_y1
;
; __asm__ ("lda %v, y", en_y2);
;
	lda     _en_y2,y
;
; __asm__ ("sta %v", _en_y2);
;
	sta     __en_y2
;
; __asm__ ("lda %v, y", en_mx);
;
	lda     _en_mx,y
;
; __asm__ ("sta %v", _en_mx);
;
	sta     __en_mx
;
; __asm__ ("lda %v, y", en_my);
;
	lda     _en_my,y
;
; __asm__ ("sta %v", _en_my);
;
	sta     __en_my
;
; __asm__ ("lda %v, y", en_ct);
;
	lda     _en_ct,y
;
; __asm__ ("sta %v", _en_ct);
;
	sta     __en_ct
;
; __asm__ ("lda %v, y", en_facing);
;
	lda     _en_facing,y
;
; __asm__ ("sta %v", _en_facing);
;
	sta     __en_facing
;
; __asm__ ("lda %v, y", en_state);
;
	lda     _en_state,y
;
; __asm__ ("sta %v", _en_state);
;
	sta     __en_state
;
; _enf_x = enf_x [gpit]; _enf_vx = enf_vx [gpit];
;
	ldx     #$00
	lda     _gpit
	asl     a
	bcc     L183C
	inx
	clc
L183C:	adc     #<(_enf_x)
	sta     ptr1
	txa
	adc     #>(_enf_x)
	sta     ptr1+1
	ldy     #$01
	lda     (ptr1),y
	sta     __enf_x+1
	dey
	lda     (ptr1),y
	sta     __enf_x
	ldx     #$00
	lda     _gpit
	asl     a
	bcc     L183D
	inx
	clc
L183D:	adc     #<(_enf_vx)
	sta     ptr1
	txa
	adc     #>(_enf_vx)
	sta     ptr1+1
	iny
	lda     (ptr1),y
	sta     __enf_vx+1
	dey
	lda     (ptr1),y
	sta     __enf_vx
;
; _enf_y = enf_y [gpit]; _enf_vy = enf_vy [gpit];
;
	ldx     #$00
	lda     _gpit
	asl     a
	bcc     L183E
	inx
	clc
L183E:	adc     #<(_enf_y)
	sta     ptr1
	txa
	adc     #>(_enf_y)
	sta     ptr1+1
	iny
	lda     (ptr1),y
	sta     __enf_y+1
	dey
	lda     (ptr1),y
	sta     __enf_y
	ldx     #$00
	lda     _gpit
	asl     a
	bcc     L183F
	inx
	clc
L183F:	adc     #<(_enf_vy)
	sta     ptr1
	txa
	adc     #>(_enf_vy)
	sta     ptr1+1
	iny
	lda     (ptr1),y
	sta     __enf_vy+1
	dey
	lda     (ptr1),y
	sta     __enf_vy
;
; if (_en_t == 0) continue;
;
	lda     __en_t
	jeq     L116D
;
; en_is_alive = !(en_flags [gpit] & EN_STATE_DEAD);
;
	ldy     _gpit
	lda     _en_flags,y
	and     #$01
	jsr     bnega
	sta     _en_is_alive
;
; en_spr = 0xff;
;
	lda     #$FF
	sta     _en_spr
;
; en_spr_x_mod = 0;
;
	lda     #$00
	sta     _en_spr_x_mod
;
; calc_en_x_absolute ();
;
	jsr     _calc_en_x_absolute
;
; if (en_cttouched [gpit]) {
;
	ldy     _gpit
	lda     _en_cttouched,y
	jeq     L11B0
;
; -- en_cttouched [gpit];
;
	lda     #<(_en_cttouched)
	ldx     #>(_en_cttouched)
	clc
	adc     _gpit
	bcc     L11B6
	inx
L11B6:	sta     ptr1
	stx     ptr1+1
	ldy     #$00
	lda     (ptr1),y
	sec
	sbc     #$01
	sta     (ptr1),y
;
; rda = frame_counter & 0xf;
;
	lda     _frame_counter
	and     #$0F
	sta     _rda
;
; if (on_screen)
;
	lda     _on_screen
	beq     L11B9
;
; EN_X_ABSOLUTE + jitter [rda] - scroll_x,
;
	jsr     decsp3
	ldy     _rda
	lda     _jitter,y
	clc
	adc     _rdaa
	ldx     _rdaa+1
	bcc     L1821
	inx
L1821:	sec
	sbc     _scroll_x
	pha
	txa
	sbc     _scroll_x+1
	pla
	ldy     #$02
	sta     (sp),y
;
; _en_y + jitter [15 - rda] + SPRITE_ADJUST, 
;
	lda     #$0F
	sec
	sbc     _rda
	sta     ptr1
	lda     #$00
	clc
	adc     #>(_jitter)
	sta     ptr1+1
	ldy     #<(_jitter)
	lda     (ptr1),y
	clc
	adc     __en_y
	bcc     L1855
	clc
L1855:	adc     #$20
	sec
	sbc     #$08
	bcs     L1840
	sec
L1840:	sbc     #$10
	bcs     L1841
	sec
L1841:	sbc     #$01
	ldy     #$01
	sta     (sp),y
;
; oam_index, 
;
	lda     _oam_index
	dey
	sta     (sp),y
;
; spr_enems [ENEMS_EXPLODING_CELL]
;
	lda     _spr_enems
;
; );
;
	sta     ptr1
;
; spr_enems [ENEMS_EXPLODING_CELL]
;
	lda     _spr_enems+1
;
; );
;
	sta     ptr1+1
	ldy     #$93
	lda     (ptr1),y
	tax
	dey
	lda     (ptr1),y
	jsr     _oam_meta_spr
	sta     _oam_index
;
; if (!on_screen) goto skipall;
;
L11B9:	lda     _on_screen
	jne     L149F
	jmp     L14BA
;
; if (en_is_alive) {
;
L11B0:	lda     _en_is_alive
	jeq     L149F
;
; pregotten = (prx + 7 >= EN_X_ABSOLUTE && prx <= EN_X_ABSOLUTE + 15);
;
	lda     _prx
	ldx     _prx+1
	clc
	adc     #$07
	bcc     L11D2
	inx
L11D2:	cmp     _rdaa
	txa
	sbc     _rdaa+1
	bcc     L11D3
	lda     _prx
	ldx     _prx+1
	jsr     pushax
	lda     _rdaa
	ldx     _rdaa+1
	clc
	adc     #$0F
	bcc     L11D4
	inx
L11D4:	jsr     tosicmp
	bcc     L11D1
	beq     L11D1
L11D3:	lda     #$00
	jmp     L11D5
L11D1:	lda     #$01
L11D5:	sta     _pregotten
;
; en_fr = ((((_en_mx) ? _en_x : _en_y) + 4) >> 3) & 1;
;
	lda     __en_mx
	beq     L11DC
	lda     __en_x
	jmp     L1834
L11DC:	lda     __en_y
L1834:	ldx     #$00
	clc
	adc     #$04
	bcc     L11E0
	inx
L11E0:	jsr     shrax3
	and     #$01
	sta     _en_fr
;
; switch (_en_t & 63) {
;
	lda     __en_t
	and     #$3F
;
; }
;
	cmp     #$01
	beq     L11EB
	cmp     #$02
	beq     L11EB
	cmp     #$03
	beq     L11EB
	cmp     #$04
	beq     L11EB
	cmp     #$06
	jeq     L1211
	cmp     #$08
	jeq     L1313
	cmp     #$09
	jeq     L1388
	cmp     #$0A
	jeq     L13C7
	cmp     #$0B
	jeq     L13FC
	jmp     L11E3
;
; if (!en_status [gpit] || half_life) {
;
L11EB:	ldy     _gpit
	lda     _en_status,y
	beq     L11ED
	lda     _half_life
	beq     L11FD
;
; _en_x += _en_mx;
;
L11ED:	lda     __en_mx
	clc
	adc     __en_x
	sta     __en_x
;
; _en_y += _en_my;
;
	lda     __en_my
	clc
	adc     __en_y
	sta     __en_y
;
; if (_en_x == _en_x1 || _en_x == _en_x2) _en_mx = -_en_mx;
;
	lda     __en_x1
	cmp     __en_x
	beq     L11F8
	lda     __en_x2
	cmp     __en_x
	bne     L11F7
L11F8:	ldx     #$00
	lda     __en_mx
	bpl     L11FC
	dex
L11FC:	jsr     negax
	sta     __en_mx
;
; if (_en_y == _en_y1 || _en_y == _en_y2) _en_my = -_en_my;      
;
L11F7:	lda     __en_y1
	cmp     __en_y
	beq     L11FE
	lda     __en_y2
	cmp     __en_y
	bne     L11FD
L11FE:	ldx     #$00
	lda     __en_my
	bpl     L1202
	dex
L1202:	jsr     negax
	sta     __en_my
;
; rda = _en_mx ? (_en_mx < 0) : (_en_my < 0); enems_facing ();
;
L11FD:	lda     __en_mx
	beq     L1205
	lda     __en_mx
	jmp     L1853
L1205:	lda     __en_my
L1853:	asl     a
	lda     #$00
	rol     a
	sta     _rda
	jsr     _enems_facing
;
; en_spr = _en_s + en_fr + _en_facing;
;
	lda     __en_s
	clc
	adc     _en_fr
	bcc     L1842
	clc
L1842:	adc     __en_facing
;
; break;
;
	jmp     L184F
;
; rdx = EN_X_ABSOLUTE; rdy = _en_y; rdt = distance ();
;
L1211:	lda     _rdaa
	sta     _rdx
	lda     __en_y
	sta     _rdy
	jsr     _distance
	sta     _rdt
;
; switch (_en_state) {
;
	lda     __en_state
;
; }
;
	beq     L121C
	cmp     #$01
	jeq     L124C
	jmp     L121A
;
; _enf_vx = ADD_SIGN2 (en_x_offs + _en_x1, EN_X_ABSOLUTE, FANTY_V_RETREAT);
;
L121C:	lda     _en_x_offs
	ldx     _en_x_offs+1
	clc
	adc     __en_x1
	bcc     L1815
	inx
L1815:	cpx     _rdaa+1
	bne     L1222
	cmp     _rdaa
	bne     L1222
	ldx     #$00
	txa
	jmp     L122E
L1222:	lda     _en_x_offs
	ldx     _en_x_offs+1
	clc
	adc     __en_x1
	bcc     L1816
	inx
L1816:	sec
	sbc     _rdaa
	sta     tmp1
	txa
	sbc     _rdaa+1
	ora     tmp1
	bcc     L122B
	beq     L122B
	ldx     #$00
	lda     #$10
	jmp     L122E
L122B:	ldx     #$FF
	lda     #$F0
L122E:	sta     __enf_vx
	stx     __enf_vx+1
;
; _enf_vy = ADD_SIGN2 (_en_y1, _en_y, FANTY_V_RETREAT);
;
	lda     __en_y
	cmp     __en_y1
	bne     L1237
	ldx     #$00
	txa
	jmp     L1243
L1237:	ldx     #$00
	lda     __en_y1
	sec
	sbc     __en_y
	bcc     L1240
	beq     L1240
	lda     #$10
	jmp     L1243
L1240:	dex
	lda     #$F0
L1243:	sta     __enf_vy
	stx     __enf_vy+1
;
; if (rdt < FANTY_DISTANCE) _en_state = 1;
;
	lda     _rdt
	cmp     #$50
	jcs     L121A
	lda     #$01
;
; break;
;
	jmp     L1836
;
; if (px < _enf_x) {
;
L124C:	lda     _px
	cmp     __enf_x
	lda     _px+1
	sbc     __enf_x+1
	bcs     L124D
;
; _enf_vx -= FANTY_A; if (_enf_vx < -FANTY_MAXV) _enf_vx = -FANTY_MAXV;
;
	lda     __enf_vx
	sec
	sbc     #$04
	sta     __enf_vx
	bcs     L1251
	dec     __enf_vx+1
L1251:	lda     __enf_vx
	cmp     #$D0
	lda     __enf_vx+1
	sbc     #$FF
	bvc     L1254
	eor     #$80
L1254:	bpl     L125B
	ldx     #$FF
	lda     #$D0
;
; } else {
;
	jmp     L1850
;
; _enf_vx += FANTY_A; if (_enf_vx > FANTY_MAXV) _enf_vx = FANTY_MAXV;
;
L124D:	lda     #$04
	clc
	adc     __enf_vx
	sta     __enf_vx
	bcc     L125A
	inc     __enf_vx+1
L125A:	lda     __enf_vx
	cmp     #$31
	lda     __enf_vx+1
	sbc     #$00
	bvs     L125D
	eor     #$80
L125D:	bpl     L125B
	ldx     #$00
	lda     #$30
L1850:	sta     __enf_vx
	stx     __enf_vx+1
;
; if (py < _enf_y) {
;
L125B:	lda     _py
	cmp     __enf_y
	lda     _py+1
	sbc     __enf_y+1
	bvc     L1828
	eor     #$80
L1828:	bpl     L1260
;
; _enf_vy -= FANTY_A; if (_enf_vy < -FANTY_MAXV) _enf_vy = -FANTY_MAXV;
;
	lda     __enf_vy
	sec
	sbc     #$04
	sta     __enf_vy
	bcs     L1264
	dec     __enf_vy+1
L1264:	lda     __enf_vy
	cmp     #$D0
	lda     __enf_vy+1
	sbc     #$FF
	bvc     L1267
	eor     #$80
L1267:	bpl     L126E
	ldx     #$FF
	lda     #$D0
;
; } else {
;
	jmp     L1851
;
; _enf_vy += FANTY_A; if (_enf_vy > FANTY_MAXV) _enf_vy = FANTY_MAXV;
;
L1260:	lda     #$04
	clc
	adc     __enf_vy
	sta     __enf_vy
	bcc     L126D
	inc     __enf_vy+1
L126D:	lda     __enf_vy
	cmp     #$31
	lda     __enf_vy+1
	sbc     #$00
	bvs     L1270
	eor     #$80
L1270:	bpl     L126E
	ldx     #$00
	lda     #$30
L1851:	sta     __enf_vy
	stx     __enf_vy+1
;
; if (rdt > FANTY_DISTANCE) {
;
L126E:	lda     _rdt
	cmp     #$51
	bcc     L121A
;
; _enf_x = EN_X_ABSOLUTE << FIXBITS;
;
	lda     _rdaa
	ldx     _rdaa+1
	jsr     aslax4
	jsr     aslax2
	sta     __enf_x
	stx     __enf_x+1
;
; _enf_y = _en_y << FIXBITS;
;
	ldx     #$00
	lda     __en_y
	jsr     aslax4
	jsr     aslax2
	sta     __enf_y
	stx     __enf_y+1
;
; _en_state = 0;
;
	lda     #$00
L1836:	sta     __en_state
;
; _enf_x += _enf_vx; 
;
L121A:	lda     __enf_vx
	clc
	adc     __enf_x
	sta     __enf_x
	lda     __enf_vx+1
	adc     __enf_x+1
	sta     __enf_x+1
;
; if (_enf_x < 0) _enf_x = 0;
;
	ldx     __enf_x+1
	cpx     #$80
	bcc     L127D
	lda     #$00
	sta     __enf_x
	sta     __enf_x+1
;
; if (_enf_x > MAX_ENX<<FIXBITS) _enf_x = MAX_ENX<<FIXBITS;
;
L127D:	lda     __enf_x
	cmp     #$01
	lda     __enf_x+1
	sbc     #$7C
	bvs     L1283
	eor     #$80
L1283:	bpl     L1281
	ldx     #$7C
	lda     #$00
	sta     __enf_x
	stx     __enf_x+1
;
; EN_X_ABSOLUTE = _enf_x >> 6;
;
L1281:	lda     __enf_x
	ldx     __enf_x+1
	jsr     asrax4
	jsr     asrax2
	sta     _rdaa
	stx     _rdaa+1
;
; if (_enf_vx) {
;
	lda     __enf_vx
	ora     __enf_vx+1
	jeq     L12AD
;
; cy1 = (_en_y + 4) >> 4;
;
	ldx     #$00
	lda     __en_y
	clc
	adc     #$04
	bcc     L128D
	inx
L128D:	jsr     shrax4
	sta     _cy1
;
; cy2 = (_en_y + 11) >> 4;
;
	ldx     #$00
	lda     __en_y
	clc
	adc     #$0B
	bcc     L1291
	inx
L1291:	jsr     shrax4
	sta     _cy2
;
; if (_enf_vx > 0) {
;
	lda     __enf_vx
	cmp     #$01
	lda     __enf_vx+1
	sbc     #$00
	bvs     L1294
	eor     #$80
L1294:	bpl     L1292
;
; cx1 = cx2 = (EN_X_ABSOLUTE + 11) >> 4;
;
	lda     _rdaa
	ldx     _rdaa+1
	clc
	adc     #$0B
	bcc     L1299
	inx
L1299:	jsr     asrax4
	sta     _cx2
	sta     _cx1
;
; rda = ((cx2 - 1) << 4) + 4;
;
	ldx     #$00
	lda     _cx2
	sec
	sbc     #$01
	bcs     L129E
	dex
L129E:	jsr     shlax4
	clc
	adc     #$04
;
; } else {
;
	jmp     L1839
;
; cx1 = cx2 = (EN_X_ABSOLUTE + 4) >> 4;
;
L1292:	lda     _rdaa
	ldx     _rdaa+1
	clc
	adc     #$04
	bcc     L12A5
	inx
L12A5:	jsr     asrax4
	sta     _cx2
	sta     _cx1
;
; rda = ((cx1 + 1) << 4) - 4;
;
	ldx     #$00
	lda     _cx1
	clc
	adc     #$01
	bcc     L12AA
	inx
L12AA:	jsr     shlax4
	sec
	sbc     #$04
L1839:	sta     _rda
;
; cm_two_points ();
;
	jsr     _cm_two_points
;
; if ((at1 & 8) || (at2 & 8)) {
;
	lda     _at1
	and     #$08
	bne     L12AE
	lda     _at2
	and     #$08
	beq     L12AD
;
; _enf_vx = -_enf_vx;
;
L12AE:	lda     __enf_vx
	ldx     __enf_vx+1
	jsr     negax
	sta     __enf_vx
	stx     __enf_vx+1
;
; EN_X_ABSOLUTE = rda; 
;
	lda     _rda
	sta     _rdaa
	lda     #$00
	sta     _rdaa+1
;
; _enf_x = rda << FIXBITS;
;
	tax
	lda     _rda
	jsr     aslax4
	jsr     aslax2
	sta     __enf_x
	stx     __enf_x+1
;
; _enf_y += _enf_vy; 
;
L12AD:	lda     __enf_vy
	clc
	adc     __enf_y
	sta     __enf_y
	lda     __enf_vy+1
	adc     __enf_y+1
	sta     __enf_y+1
;
; if (_enf_y < 0) _enf_y = 0;
;
	ldx     __enf_y+1
	cpx     #$80
	bcc     L12BA
	lda     #$00
	sta     __enf_y
	sta     __enf_y+1
;
; if (_enf_y > 11264) _enf_y = 11264;
;
L12BA:	lda     __enf_y
	cmp     #$01
	lda     __enf_y+1
	sbc     #$2C
	bvs     L12C0
	eor     #$80
L12C0:	bpl     L12BE
	ldx     #$2C
	lda     #$00
	sta     __enf_y
	stx     __enf_y+1
;
; _en_y = _enf_y >> 6;
;
L12BE:	lda     __enf_y
	ldx     __enf_y+1
	jsr     asrax4
	jsr     asrax2
	sta     __en_y
;
; if (_enf_vy) {
;
	lda     __enf_vy
	ora     __enf_vy+1
	jeq     L12EE
;
; cx1 = (EN_X_ABSOLUTE + 4) >> 4;
;
	lda     _rdaa
	ldx     _rdaa+1
	clc
	adc     #$04
	bcc     L12CA
	inx
L12CA:	jsr     asrax4
	sta     _cx1
;
; cx2 = (EN_X_ABSOLUTE + 11) >> 4;
;
	lda     _rdaa
	ldx     _rdaa+1
	clc
	adc     #$0B
	bcc     L12CE
	inx
L12CE:	jsr     asrax4
	sta     _cx2
;
; if (_enf_vy > 0) {
;
	lda     __enf_vy
	cmp     #$01
	lda     __enf_vy+1
	sbc     #$00
	bvs     L12D1
	eor     #$80
L12D1:	bpl     L12CF
;
; rdb = 12;
;
	lda     #$0C
	sta     _rdb
;
; cy1 = cy2 = (_en_y + 11) >> 4;
;
	ldx     #$00
	lda     __en_y
	clc
	adc     #$0B
	bcc     L12D8
	inx
L12D8:	jsr     shrax4
	sta     _cy2
	sta     _cy1
;
; rda = ((cy2 - 1) << 4) + 4;
;
	ldx     #$00
	lda     _cy2
	sec
	sbc     #$01
	bcs     L12DD
	dex
L12DD:	jsr     shlax4
	clc
	adc     #$04
;
; } else {
;
	jmp     L183A
;
; rdb = 8;
;
L12CF:	lda     #$08
	sta     _rdb
;
; cy1 = cy2 = (_en_y + 4) >> 4;
;
	ldx     #$00
	lda     __en_y
	clc
	adc     #$04
	bcc     L12E6
	inx
L12E6:	jsr     shrax4
	sta     _cy2
	sta     _cy1
;
; rda = ((cy1 + 1) << 4) - 4;
;
	ldx     #$00
	lda     _cy1
	clc
	adc     #$01
	bcc     L12EB
	inx
L12EB:	jsr     shlax4
	sec
	sbc     #$04
L183A:	sta     _rda
;
; cm_two_points ();
;
	jsr     _cm_two_points
;
; if ((at1 & rdb) || (at2 & rdb)) {
;
	lda     _rdb
	and     _at1
	pha
	pla
	bne     L12EF
	lda     _rdb
	and     _at2
	pha
	pla
	beq     L12EE
;
; _enf_vy = -_enf_vy;
;
L12EF:	lda     __enf_vy
	ldx     __enf_vy+1
	jsr     negax
	sta     __enf_vy
	stx     __enf_vy+1
;
; _en_y = rda;
;
	lda     _rda
	sta     __en_y
;
; _enf_y = rda << FIXBITS;
;
	ldx     #$00
	lda     _rda
	jsr     aslax4
	jsr     aslax2
	sta     __enf_y
	stx     __enf_y+1
;
; cx1 = (EN_X_ABSOLUTE + 8) >> 4;
;
L12EE:	lda     _rdaa
	ldx     _rdaa+1
	clc
	adc     #$08
	bcc     L12FC
	inx
L12FC:	jsr     asrax4
	sta     _cx1
;
; cy1 = (_en_y + 8) >> 4;
;
	ldx     #$00
	lda     __en_y
	clc
	adc     #$08
	bcc     L1300
	inx
L1300:	jsr     shrax4
	sta     _cy1
;
; cm_two_points ();
;
	jsr     _cm_two_points
;
; if (at1 & 1) {
;
	lda     _at1
	and     #$01
	beq     L1302
;
; en_cttouched [gpit] = 8;
;
	ldy     _gpit
	lda     #$08
	sta     _en_cttouched,y
;
; enems_kill ();
;
	jsr     _enems_kill
;
; en_fr = (EN_X_ABSOLUTE >> 3) & 1;
;
L1302:	lda     _rdaa
	ldx     _rdaa+1
	jsr     asrax3
	and     #$01
	sta     _en_fr
;
; rda = (prx < EN_X_ABSOLUTE); enems_facing ();
;
	lda     _prx
	cmp     _rdaa
	lda     _prx+1
	sbc     _rdaa+1
	jsr     boolult
	sta     _rda
	jsr     _enems_facing
;
; en_spr = _en_s + en_fr + _en_facing;
;
	lda     __en_s
	clc
	adc     _en_fr
	bcc     L1843
	clc
L1843:	adc     __en_facing
;
; break;
;
	jmp     L184F
;
; rda = (_en_x1 == _en_x2);
;
L1313:	lda     __en_x2
	cmp     __en_x1
	jsr     booleq
	sta     _rda
;
; switch (_en_state) {
;
	lda     __en_state
;
; }
;
	beq     L131B
	cmp     #$01
	beq     L1332
	cmp     #$02
	jeq     L1344
	cmp     #$03
	jeq     L135B
	jmp     L1319
;
; if (rda) {
;
L131B:	lda     _rda
	beq     L131C
;
; _en_y -= _en_mx;
;
	lda     __en_mx
	eor     #$FF
	sec
	adc     __en_y
	sta     __en_y
;
; if (_en_y == _en_y1) {
;
	lda     __en_y1
	cmp     __en_y
	jne     L1319
;
; _en_state = 1;
;
	lda     #$01
	sta     __en_state
;
; _en_ct = SAW_EMERGING_STEPS;
;
	lda     #$0A
	sta     __en_ct
;
; } else {
;
	jmp     L1319
;
; _en_x -= _en_mx;
;
L131C:	lda     __en_mx
	eor     #$FF
	sec
	adc     __en_x
	sta     __en_x
;
; if (_en_x == _en_x1) {
;
	lda     __en_x1
	cmp     __en_x
	jne     L1319
;
; _en_state = 1;
;
	lda     #$01
	sta     __en_state
;
; _en_ct = SAW_EMERGING_STEPS;
;
	lda     #$0A
	sta     __en_ct
;
; break;
;
	jmp     L1319
;
; if (half_life) {
;
L1332:	lda     _half_life
	jeq     L1319
;
; if (_en_ct --) {
;
	lda     __en_ct
	pha
	sec
	sbc     #$01
	sta     __en_ct
	pla
	tax
	beq     L1335
;
; if (rda) {
;
	lda     _rda
	beq     L1337
;
; _en_x += _en_my;
;
	lda     __en_my
	clc
	adc     __en_x
	sta     __en_x
;
; } else {
;
	jmp     L1319
;
; _en_y += _en_my;
;
L1337:	lda     __en_my
	clc
	adc     __en_y
	sta     __en_y
;
; } else {
;
	jmp     L1319
;
; _en_state = 2;
;
L1335:	lda     #$02
;
; break;
;
	jmp     L135E
;
; if (rda) {
;
L1344:	lda     _rda
	beq     L1345
;
; _en_y += _en_mx;
;
	lda     __en_mx
	clc
	adc     __en_y
	sta     __en_y
;
; if (_en_y == _en_y2) {
;
	lda     __en_y2
	cmp     __en_y
	bne     L1319
;
; _en_state = 3;
;
	lda     #$03
	sta     __en_state
;
; _en_ct = SAW_EMERGING_STEPS;
;
	lda     #$0A
	sta     __en_ct
;
; } else {
;
	jmp     L1319
;
; _en_x += _en_mx;
;
L1345:	lda     __en_mx
	clc
	adc     __en_x
	sta     __en_x
;
; if (_en_x == _en_x2) {
;
	lda     __en_x2
	cmp     __en_x
	bne     L1319
;
; _en_state = 3;
;
	lda     #$03
	sta     __en_state
;
; _en_ct = SAW_EMERGING_STEPS;
;
	lda     #$0A
	sta     __en_ct
;
; break;
;
	jmp     L1319
;
; if (half_life) {
;
L135B:	lda     _half_life
	beq     L1319
;
; if (_en_ct --) {
;
	lda     __en_ct
	pha
	sec
	sbc     #$01
	sta     __en_ct
	pla
	tax
	beq     L135E
;
; if (rda) {
;
	lda     _rda
	beq     L1360
;
; _en_x -= _en_my;
;
	lda     __en_my
	eor     #$FF
	sec
	adc     __en_x
	sta     __en_x
;
; } else {
;
	jmp     L1319
;
; _en_y -= _en_my;
;
L1360:	lda     __en_my
	eor     #$FF
	sec
	adc     __en_y
	sta     __en_y
;
; } else {
;
	jmp     L1319
;
; _en_state = 0;
;
L135E:	sta     __en_state
;
; if (rda) {
;
L1319:	lda     _rda
	beq     L136C
;
; rdx = _en_x1; rdy = _en_y;
;
	lda     __en_x1
	sta     _rdx
	lda     __en_y
;
; } else {
;
	jmp     L183B
;
; rdx = _en_x; rdy = _en_y1;
;
L136C:	lda     __en_x
	sta     _rdx
	lda     __en_y1
L183B:	sta     _rdy
;
; rdx, rdy + SPRITE_ADJUST,
;
	jsr     decsp3
	lda     _rdx
	ldy     #$02
	sta     (sp),y
	lda     _rdy
	clc
	adc     #$20
	sec
	sbc     #$08
	bcs     L1844
	sec
L1844:	sbc     #$10
	bcs     L1845
	sec
L1845:	sbc     #$01
	dey
	sta     (sp),y
;
; oam_index,
;
	lda     _oam_index
	dey
	sta     (sp),y
;
; spr_enems [ENEMS_OCCLUDING_CELL]
;
	lda     _spr_enems
;
; );
;
	sta     ptr1
;
; spr_enems [ENEMS_OCCLUDING_CELL]
;
	lda     _spr_enems+1
;
; );
;
	sta     ptr1+1
	ldy     #$91
	lda     (ptr1),y
	tax
	dey
	lda     (ptr1),y
	jsr     _oam_meta_spr
	sta     _oam_index
;
; en_spr = SAW_BASE_SPRID + half_life;
;
	lda     _half_life
	clc
	adc     #$30
	sta     _en_spr
;
; _en_facing = 0;
;
	lda     #$00
	sta     __en_facing
;
; break;
;
	jmp     L11E3
;
; if (on_screen) 
;
L1388:	lda     _on_screen
	jeq     L11E3
;
; _en_x1, _en_y1 + SPRITE_ADJUST, 
;
	jsr     decsp3
	lda     __en_x1
	ldy     #$02
	sta     (sp),y
	lda     __en_y1
	clc
	adc     #$20
	sec
	sbc     #$08
	bcs     L1846
	sec
L1846:	sbc     #$10
	bcs     L1847
	sec
L1847:	sbc     #$01
	dey
	sta     (sp),y
;
; oam_index, 
;
	lda     _oam_index
	dey
	sta     (sp),y
;
; spr_enems [ENEMS_OCCLUDING_CELL]
;
	lda     _spr_enems
;
; );
;
	sta     ptr1
;
; spr_enems [ENEMS_OCCLUDING_CELL]
;
	lda     _spr_enems+1
;
; );
;
	sta     ptr1+1
	ldy     #$91
	lda     (ptr1),y
	tax
	dey
	lda     (ptr1),y
	jsr     _oam_meta_spr
	sta     _oam_index
;
; switch (_en_state) {
;
	lda     __en_state
;
; }
;
	beq     L139A
	cmp     #$01
	beq     L13AA
	jmp     L1398
;
; if (_en_mx) {
;
L139A:	lda     __en_mx
	beq     L139B
;
; -- _en_mx;
;
	dec     __en_mx
	lda     __en_mx
	jpl     L1398
;
; } else {
;
	jmp     L1398
;
; _en_state = 1;
;
L139B:	lda     #$01
	sta     __en_state
;
; _enf_y = _en_y1 << 6;
;
	ldx     #$00
	lda     __en_y1
	jsr     aslax4
	jsr     aslax2
	sta     __enf_y
	stx     __enf_y+1
;
; _enf_vy = -PEZON_THRUST;
;
	ldx     #$FE
	lda     #$80
	sta     __enf_vy
	stx     __enf_vy+1
;
; sfx_play (SFX_FLOAT, 1);
;
	lda     #$10
	jsr     pusha
	lda     #$01
	jsr     _sfx_play
;
; break;
;
	jmp     L1398
;
; _enf_vy += PEZON_G;
;
L13AA:	lda     #$10
	clc
	adc     __enf_vy
	sta     __enf_vy
	bcc     L13AD
	inc     __enf_vy+1
;
; if (_enf_vy > PEZON_VY_FALLING_MAX) _enf_vy = PEZON_VY_FALLING_MAX;
;
L13AD:	lda     __enf_vy
	cmp     #$01
	lda     __enf_vy+1
	sbc     #$01
	bvs     L13B0
	eor     #$80
L13B0:	bpl     L13AE
	ldx     #$01
	lda     #$00
	sta     __enf_vy
	stx     __enf_vy+1
;
; _enf_y += _enf_vy;
;
L13AE:	lda     __enf_vy
	clc
	adc     __enf_y
	sta     __enf_y
	lda     __enf_vy+1
	adc     __enf_y+1
	sta     __enf_y+1
;
; _en_y = _enf_y >> 6;
;
	lda     __enf_y
	ldx     __enf_y+1
	jsr     asrax4
	jsr     asrax2
	sta     __en_y
;
; if (_en_y >= _en_y1) {
;
	cmp     __en_y1
	bcc     L13B7
;
; _en_state = 0;
;
	lda     #$00
	sta     __en_state
;
; _en_mx = _en_my;
;
	lda     __en_my
	sta     __en_mx
;
; } else {
;
	jmp     L1398
;
; en_spr = PEZONS_BASE_SPRID + (_enf_vy >= -64);
;
L13B7:	lda     __enf_vy
	cmp     #$C0
	lda     __enf_vy+1
	sbc     #$FF
	bvs     L13C2
	eor     #$80
L13C2:	asl     a
	lda     #$00
	rol     a
	clc
	adc     #$28
	sta     _en_spr
;
; _en_facing = 0;
;
L1398:	lda     #$00
	sta     __en_facing
;
; break;
;
	jmp     L11E3
;
; if (on_screen)
;
L13C7:	lda     _on_screen
	jeq     L11E3
;
; if (_en_mx) --_en_mx; else {
;
	lda     __en_mx
	beq     L13CA
	dec     __en_mx
	lda     __en_mx
	jpl     L11E3
	jmp     L11E3
;
; ++ _en_state;
;
L13CA:	inc     __en_state
;
; if (_en_state == 6) _en_state = 0;
;
	lda     __en_state
	cmp     #$06
	bne     L13D0
	lda     #$00
	sta     __en_state
;
; chac_chacs_times [_en_state] : _en_my;
;
L13D0:	lda     __en_state
	beq     L13D6
	ldy     __en_state
	lda     _chac_chacs_times,y
	jmp     L13DA
L13D6:	lda     __en_my
	cmp     #$80
L13DA:	sta     __en_mx
;
; _x = _en_x; _y = _en_y    ; _t = chac_chacs_t1 [_en_state]; map_set ();
;
	lda     __en_x
	sta     __x
	lda     __en_y
	sta     __y
	ldy     __en_state
	lda     _chac_chacs_t1,y
	sta     __t
	jsr     _map_set
;
; _x = _en_x; _y = _en_y + 1; _t = chac_chacs_t2 [_en_state]; map_set ();
;
	lda     __en_x
	sta     __x
	lda     __en_y
	clc
	adc     #$01
	sta     __y
	ldy     __en_state
	lda     _chac_chacs_t2,y
	sta     __t
	jsr     _map_set
;
; _x = _en_x; _y = _en_y + 2; _t = chac_chacs_t3 [_en_state]; map_set ();
;
	lda     __en_x
	sta     __x
	lda     __en_y
	clc
	adc     #$02
	sta     __y
	ldy     __en_state
	lda     _chac_chacs_t3,y
	sta     __t
	jsr     _map_set
;
; break;
;
	jmp     L11E3
;
; if (on_screen) 
;
L13FC:	lda     _on_screen
	jeq     L11E3
;
; -- _en_ct; if (!_en_ct) {
;
	dec     __en_ct
	lda     __en_ct
	bne     L1400
;
; _en_state = (_en_state + 1) & 3; _en_ct = monococo_state_times [_en_state] - (rand8 () & 0x15);
;
	lda     __en_state
	clc
	adc     #$01
	and     #$03
	sta     __en_state
	ldy     __en_state
	lda     _monococo_state_times,y
	jsr     pusha0
	jsr     _rand8
	and     #$15
	jsr     tossuba0
	sta     __en_ct
;
; if (_en_state == 2 && _en_ct == MONOCOCO_FIRE_COCO_AT) {
;
L1400:	lda     __en_state
	cmp     #$02
	bne     L140B
	lda     __en_ct
	cmp     #$19
	bne     L140B
;
; COCO_RDX = EN_X_ABSOLUTE + 4; rdy = _en_y + 4; cocos_shoot_aimed ();
;
	lda     _rdaa
	ldx     _rdaa+1
	clc
	adc     #$04
	bcc     L1411
	inx
L1411:	sta     _rdbb
	stx     _rdbb+1
	lda     __en_y
	clc
	adc     #$04
	sta     _rdy
	jsr     _cocos_shoot_aimed
;
; rda = (prx < rdx); enems_facing ();
;
L140B:	lda     _prx
	cmp     _rdx
	lda     _prx+1
	sbc     #$00
	jsr     boolult
	sta     _rda
	jsr     _enems_facing
;
; en_spr = MONOCOCO_BASE_SPRID + _en_facing;
;
	lda     __en_facing
	clc
	adc     #$38
	sta     _en_spr
;
; switch (_en_state) {
;
	lda     __en_state
;
; }
;
	beq     L1421
	cmp     #$01
	beq     L1425
	cmp     #$02
	beq     L142B
	cmp     #$03
	beq     L1425
	jmp     L11E3
;
; en_spr += 9;
;
L1421:	lda     #$09
;
; break;
;
	jmp     L1856
;
; en_spr += 8;
;
L1425:	lda     #$08
;
; break;
;
	jmp     L1856
;
; en_spr += ((frame_counter >> 5) & 1);
;
L142B:	ldx     #$00
	lda     _frame_counter
	jsr     asrax4
	jsr     asrax1
	and     #$01
L1856:	clc
	adc     _en_spr
L184F:	sta     _en_spr
;
; en_spr_id [gpit] = en_spr;
;
L11E3:	ldy     _gpit
	lda     _en_spr
	sta     _en_spr_id,y
;
; calc_en_x_absolute ();
;
	jsr     _calc_en_x_absolute
;
; if (!on_screen) goto skipall;
;
	lda     _on_screen
	jeq     L14BA
;
; if (_en_t == 4 && pregotten && !pgotten && !pj) {
;
	lda     __en_t
	cmp     #$04
	jne     L1451
	lda     _pregotten
	jeq     L1451
	lda     _pgotten
	jne     L1451
	lda     _pj
	jne     L1451
;
; if (_en_mx) {
;
	lda     __en_mx
	beq     L143D
;
; if (pry + 16 >= _en_y && pry + 12 <= _en_y) {
;
	ldx     #$00
	lda     _pry
	clc
	adc     #$10
	bcc     L143F
	inx
L143F:	cmp     __en_y
	txa
	sbc     #$00
	bcc     L143D
	ldx     #$00
	lda     _pry
	clc
	adc     #$0C
	bcc     L1441
	inx
L1441:	sec
	sbc     __en_y
	sta     tmp1
	txa
	sbc     #$00
	ora     tmp1
	bcc     L143E
	bne     L143D
;
; pgotten = 1;
;
L143E:	lda     #$01
	sta     _pgotten
;
; pgtmx = _en_mx << (6 - en_status [gpit]);
;
	ldx     #$00
	lda     __en_mx
	bpl     L1447
	dex
L1447:	jsr     pushax
	lda     #$06
	jsr     pusha0
	ldy     _gpit
	lda     _en_status,y
	jsr     tossuba0
	jsr     tosaslax
	sta     _pgtmx
	stx     _pgtmx+1
;
; py = (_en_y - 16) << 6; pry = py >> 6;
;
	ldx     #$00
	lda     __en_y
	sec
	sbc     #$10
	bcs     L144E
	dex
L144E:	jsr     shlax4
	jsr     shlax2
	sta     _py
	stx     _py+1
	jsr     asrax4
	jsr     asrax2
	sta     _pry
;
; (_en_my < 0 && pry + 17 >= _en_y && pry + 12 <= _en_y) ||
;
L143D:	lda     __en_my
	asl     a
	bcc     L182E
	ldx     #$00
	lda     _pry
	clc
	adc     #$11
	bcc     L1456
	inx
L1456:	cmp     __en_y
	txa
	sbc     #$00
	bcc     L182E
	ldx     #$00
	lda     _pry
	clc
	adc     #$0C
	bcc     L1457
	inx
L1457:	sec
	sbc     __en_y
	sta     tmp1
	txa
	sbc     #$00
	ora     tmp1
	bcc     L1452
	beq     L1452
;
; (_en_my > 0 && pry + 16 + _en_my >= _en_y && pry + 12 <= _en_y)
;
L182E:	lda     __en_my
	sec
	sbc     #$01
	bvs     L145B
	eor     #$80
L145B:	jpl     L1451
	ldx     #$00
	lda     _pry
	clc
	adc     #$10
	bcc     L145D
	inx
L145D:	sta     ptr1
	stx     ptr1+1
	ldx     #$00
	lda     __en_my
	bpl     L145E
	dex
L145E:	clc
	adc     ptr1
	pha
	txa
	adc     ptr1+1
	tax
	pla
	cmp     __en_y
	txa
	sbc     #$00
	bcc     L1451
	ldx     #$00
	lda     _pry
	clc
	adc     #$0C
	bcc     L145F
	inx
L145F:	sec
	sbc     __en_y
	sta     tmp1
	txa
	sbc     #$00
	ora     tmp1
	bcc     L1452
	bne     L1451
;
; pgotten = 1;
;
L1452:	lda     #$01
	sta     _pgotten
;
; pgtmy = _en_my << (6 - en_status [gpit]);
;
	ldx     #$00
	lda     __en_my
	bpl     L1466
	dex
L1466:	jsr     pushax
	lda     #$06
	jsr     pusha0
	ldy     _gpit
	lda     _en_status,y
	jsr     tossuba0
	jsr     tosaslax
	sta     _pgtmy
	stx     _pgtmy+1
;
; py = (_en_y - 16) << 6; pry = py >> 6;
;
	ldx     #$00
	lda     __en_y
	sec
	sbc     #$10
	bcs     L146D
	dex
L146D:	jsr     shlax4
	jsr     shlax2
	sta     _py
	stx     _py+1
	jsr     asrax4
	jsr     asrax2
	sta     _pry
;
; pvy = 0;
;
	lda     #$00
	sta     _pvy
	sta     _pvy+1
;
; if ((prx & 0x100) != (EN_X_ABSOLUTE & 0x100)) goto killdo;
;
L1451:	lda     _prx+1
	and     #$01
	tax
	lda     #$00
	jsr     pushax
	lda     _rdaa+1
	and     #$01
	tax
	lda     #$00
	jsr     tosicmp
	jne     L1487
;
; en_is_alive == 0 // General condition.
;
	lda     _en_is_alive
;
; || en_cttouched [gpit]
;
	jeq     L149F
	ldy     _gpit
	lda     _en_cttouched,y
;
; || _en_t == 4
;
	jne     L149F
	lda     __en_t
;
; || (_en_t == 8 && _en_state != 2)
;
	cmp     #$04
	jeq     L149F
	lda     __en_t
	cmp     #$08
	bne     L1830
	lda     __en_state
	cmp     #$02
	jne     L149F
;
; || (_en_t == 9 && _en_state == 0)
;
L1830:	lda     __en_t
	cmp     #$09
	bne     L1831
	lda     __en_state
	jeq     L149F
;
; || _en_t == 10
;
L1831:	lda     __en_t
;
; || (_en_t == 11 && _en_mx != 2)
;
	cmp     #$0A
	jeq     L149F
	lda     __en_t
	cmp     #$0B
	bne     L1477
	lda     __en_mx
	cmp     #$02
	jne     L149F
;
; touched == 0 &&
;
L1477:	lda     _touched
	bne     L1487
;
; ) {
;
	jsr     _collide
	tax
	beq     L1487
;
; en_sg_1 = 0;
;
	lda     #$00
	sta     _en_sg_1
;
; en_sg_2 = (pflickering == 0);
;
	lda     _pflickering
	jsr     booleq
	sta     _en_sg_2
;
; if (en_sg_1) enems_hit ();
;
	lda     _en_sg_1
	beq     L1490
	jsr     _enems_hit
;
; if (en_sg_2) { 
;
L1490:	lda     _en_sg_2
	beq     L1493
;
; pkill = 1; 
;
	lda     #$01
	sta     _pkill
;
; touched = 1; 
;
L1493:	lda     #$01
	sta     _touched
;
; || _en_t == 8
;
L1487:	lda     _touched
	jne     L149F
	lda     __en_t
;
; ) goto skipdo;
;
	cmp     #$08
	jeq     L149F
;
; bi = MAX_BULLETS; while (bi --) if (by [bi]) {
;
	lda     #$04
	sta     _bi
L149E:	lda     _bi
	pha
	sec
	sbc     #$01
	sta     _bi
	pla
	tax
	jeq     L149F
	ldy     _bi
	lda     _by,y
	beq     L149E
;
; bx [bi] + 3 >= EN_X_ABSOLUTE &&
;
	ldx     #$00
	lda     _bi
	asl     a
	bcc     L1848
	inx
	clc
L1848:	adc     #<(_bx)
	sta     ptr1
	txa
	adc     #>(_bx)
	sta     ptr1+1
	ldy     #$01
	lda     (ptr1),y
	tax
	dey
	lda     (ptr1),y
	clc
	adc     #$03
	bcc     L14A8
	inx
L14A8:	cmp     _rdaa
	txa
	sbc     _rdaa+1
	bcc     L149E
;
; bx [bi] <= EN_X_ABSOLUTE + 12 &&
;
	ldx     #$00
	lda     _bi
	asl     a
	bcc     L1849
	inx
	clc
L1849:	adc     #<(_bx)
	sta     ptr1
	txa
	adc     #>(_bx)
	sta     ptr1+1
	iny
	lda     (ptr1),y
	tax
	dey
	lda     (ptr1),y
	jsr     pushax
	lda     _rdaa
	ldx     _rdaa+1
	clc
	adc     #$0C
	bcc     L14AB
	inx
L14AB:	jsr     tosicmp
	beq     L184D
	bcs     L149E
;
; by [bi] + 3 >= _en_y && 
;
L184D:	ldy     _bi
	ldx     #$00
	lda     _by,y
	clc
	adc     #$03
	bcc     L14AE
	inx
L14AE:	cmp     __en_y
	txa
	sbc     #$00
	jcc     L149E
;
; by [bi] <= _en_y + 12
;
	ldy     _bi
	lda     _by,y
	jsr     pusha0
	lda     __en_y
;
; ) {
;
	clc
	adc     #$0C
	bcc     L14B1
	ldx     #$01
L14B1:	jsr     tosicmp
	bcc     L14A6
	jne     L149E
;
; sfx_play (SFX_ENHIT, 1);
;
L14A6:	lda     #$06
	jsr     pusha
	lda     #$01
	jsr     _sfx_play
;
; if (_en_t >= PLAYER_BULLETS_MIN_KILLABLE)
;
	lda     __en_t
	cmp     #$01
	bcc     L14B6
;
; enems_hit ();
;
	jsr     _enems_hit
;
; bullets_destroy ();
;
L14B6:	jsr     _bullets_destroy
;
; if (en_spr != 0xff) {
;
L149F:	lda     _en_spr
	cmp     #$FF
	beq     L14BA
;
; EN_X_ABSOLUTE + en_spr_x_mod - scroll_x,
;
	jsr     decsp3
	lda     _rdaa
	ldx     _rdaa+1
	clc
	adc     _en_spr_x_mod
	bcc     L1819
	inx
L1819:	sec
	sbc     _scroll_x
	pha
	txa
	sbc     _scroll_x+1
	pla
	ldy     #$02
	sta     (sp),y
;
; _en_y + SPRITE_ADJUST, 
;
	lda     __en_y
	clc
	adc     #$20
	sec
	sbc     #$08
	bcs     L184A
	sec
L184A:	sbc     #$10
	bcs     L184B
	sec
L184B:	sbc     #$01
	dey
	sta     (sp),y
;
; oam_index, 
;
	lda     _oam_index
	dey
	sta     (sp),y
;
; spr_enems [en_spr]
;
	ldx     #$00
	lda     _en_spr
	asl     a
	bcc     L184C
	inx
	clc
L184C:	adc     _spr_enems
;
; );
;
	sta     ptr1
;
; spr_enems [en_spr]
;
	txa
	adc     _spr_enems+1
;
; );
;
	sta     ptr1+1
	iny
	lda     (ptr1),y
	tax
	dey
	lda     (ptr1),y
	jsr     _oam_meta_spr
	sta     _oam_index
;
; enems_update_unsigned_char_arrays ();
;
L14BA:	jsr     _enems_update_unsigned_char_arrays
;
; } 
;
	jmp     L116D

.endproc

; ---------------------------------------------------------------
; void __near__ draw_game_frame (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_draw_game_frame: near

.segment	"CODE"

;
; _x = 2; _y = 3;  pr_str ("LIFE:00   ITEM:      KEYS:00");
;
	lda     #$02
	sta     __x
	lda     #$03
	sta     __y
	lda     #<(L0001)
	ldx     #>(L0001)
	jsr     pushax
	jsr     _pr_str
;
; _y = 28; pr_str ("SUPPATESTR - THE MOJON TWINS");
;
	lda     #$1C
	sta     __y
	lda     #<(L0001+29)
	ldx     #>(L0001+29)
	jsr     pushax
	jmp     _pr_str

.endproc

; ---------------------------------------------------------------
; void __near__ hud_update (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_hud_update: near

.segment	"CODE"

;
; if (okeys != pkeys) {
;
	lda     _pkeys
	cmp     _okeys
	beq     L14D4
;
; okeys = pkeys;
;
	lda     _pkeys
	sta     _okeys
;
; _x = KEYS_X; _y = KEYS_Y; _n = pkeys; p_t ();
;
	lda     #$1C
	sta     __x
	lda     #$03
	sta     __y
	lda     _pkeys
	sta     __n
	jsr     _p_t
;
; if (olife != plife) {
;
L14D4:	lda     _plife
	cmp     _olife
	beq     L14DF
;
; olife = plife;
;
	lda     _plife
	sta     _olife
;
; _x = LIFE_X; _y = LIFE_Y; _n = plife; p_t ();
;
	lda     #$07
	sta     __x
	lda     #$03
	sta     __y
	lda     _plife
	sta     __n
	jsr     _p_t
;
; HS_INV_X, HS_INV_Y,
;
L14DF:	jsr     decsp3
	lda     #$88
	ldy     #$02
	sta     (sp),y
	lda     #$0B
	dey
	sta     (sp),y
;
; oam_index,
;
	lda     _oam_index
	dey
	sta     (sp),y
;
; spr_hs [pinv]
;
	ldx     #$00
	lda     _pinv
	asl     a
	bcc     L185B
	inx
	clc
L185B:	adc     #<(_spr_hs)
;
; );
;
	sta     ptr1
;
; spr_hs [pinv]
;
	txa
	adc     #>(_spr_hs)
;
; );
;
	sta     ptr1+1
	iny
	lda     (ptr1),y
	tax
	dey
	lda     (ptr1),y
	jsr     _oam_meta_spr
	sta     _oam_index
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ flickscreen_do_horizontal (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_flickscreen_do_horizontal: near

.segment	"CODE"

;
; if (prx == 4 && 
;
	lda     _prx+1
	bne     L14F2
	lda     _prx
	cmp     #$04
	bne     L14F2
;
; (cfx + pvx) < 0
;
	ldx     #$00
	lda     _cfx
	bpl     L14F7
	dex
L14F7:	clc
	adc     _pvx
	txa
	adc     _pvx+1
	tax
;
; ) {
;
	cpx     #$80
	bcc     L14F2
;
; n_pant -= 2;
;
	lda     _n_pant
	sec
	sbc     #$02
	sta     _n_pant
;
; px = MAX_PRX << FIXBITS;
;
	ldx     #$7D
;
; } else if (prx == MAX_PRX && 
;
	jmp     L185E
L14F2:	lda     _prx+1
	cmp     #$01
	bne     L1501
	lda     _prx
	cmp     #$F4
	bne     L1501
;
; (cfx + pvx) > 0
;
	ldx     #$00
	lda     _cfx
	bpl     L1503
	dex
L1503:	clc
	adc     _pvx
	pha
	txa
	adc     _pvx+1
	tax
	pla
;
; ) {
;
	cmp     #$01
	txa
	sbc     #$00
	bvs     L1504
	eor     #$80
L1504:	bmi     L14FF
L1501:	rts
;
; n_pant += 2;
;
L14FF:	lda     #$02
	clc
	adc     _n_pant
	sta     _n_pant
;
; px = 4 << FIXBITS;
;
	ldx     #$01
L185E:	lda     #$00
	sta     _px
	stx     _px+1
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ flickscreen_do_vertical (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_flickscreen_do_vertical: near

.segment	"CODE"

;
; if (pry == 0 && pvy < 0 && n_pant >= c_map_w) {
;
	lda     _pry
	bne     L150B
	ldx     _pvy+1
	cpx     #$80
	bcc     L150B
	lda     _n_pant
	cmp     _c_map_w
	bcc     L150B
;
; n_pant -= c_map_w;
;
	lda     _c_map_w
	eor     #$FF
	sec
	adc     _n_pant
	sta     _n_pant
;
; py = 192 << FIXBITS;
;
	ldx     #$30
	lda     #$00
	sta     _py
	stx     _py+1
;
; if (pvy > -PLAYER_VY_JUMP_MAX) pvy = -PLAYER_VY_JUMP_MAX;
;
	lda     _pvy
	cmp     #$41
	lda     _pvy+1
	sbc     #$FF
	bvs     L1515
	eor     #$80
L1515:	bpl     L1519
	ldx     #$FF
	lda     #$40
	sta     _pvy
	stx     _pvy+1
;
; } else if (pry >= 192 && pvy > 0 && n_pant < c_map_size - c_map_w) {
;
	rts
L150B:	lda     _pry
	cmp     #$C0
	bcc     L151B
	lda     _pvy
	cmp     #$01
	lda     _pvy+1
	sbc     #$00
	bvs     L151C
	eor     #$80
L151C:	bpl     L151B
	lda     _n_pant
	jsr     pusha0
	lda     _c_map_size
	sec
	sbc     _c_map_w
	jsr     tosicmp0
	bcc     L151A
L151B:	rts
;
; n_pant += c_map_w;
;
L151A:	lda     _c_map_w
	clc
	adc     _n_pant
	sta     _n_pant
;
; py = 0;
;
	lda     #$00
	sta     _py
	sta     _py+1
;
; }
;
L1519:	rts

.endproc

; ---------------------------------------------------------------
; void __near__ game_init (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_game_init: near

.segment	"CODE"

;
; win_level = game_over = 0;
;
	lda     #$00
	sta     _game_over
	sta     _win_level
;
; c_pal_bg =   palts0;
;
	lda     #<(_palts0)
	sta     _c_pal_bg
	lda     #>(_palts0)
	sta     _c_pal_bg+1
;
; c_pal_fg =   palss0;
;
	lda     #<(_palss0)
	sta     _c_pal_fg
	lda     #>(_palss0)
	sta     _c_pal_fg+1
;
; c_ts_tmaps =  ts0_tmaps;
;
	lda     #<(_ts0_tmaps)
	sta     _c_ts_tmaps
	lda     #>(_ts0_tmaps)
	sta     _c_ts_tmaps+1
;
; c_ts_pals =  ts0_pals;
;
	lda     #<(_ts0_pals)
	sta     _c_ts_pals
	lda     #>(_ts0_pals)
	sta     _c_ts_pals+1
;
; c_behs =   behs0;
;
	lda     #<(_behs0)
	sta     _c_behs
	lda     #>(_behs0)
	sta     _c_behs+1
;
; spr_enems =  spr_enems0;
;
	lda     #<(_spr_enems0)
	sta     _spr_enems
	lda     #>(_spr_enems0)
	sta     _spr_enems+1
;
; c_map =  map_0;
;
	lda     #<(_map_0)
	sta     _c_map
	lda     #>(_map_0)
	sta     _c_map+1
;
; c_locks =  map_0_locks;
;
	lda     #<(_map_0_locks)
	sta     _c_locks
	lda     #>(_map_0_locks)
	sta     _c_locks+1
;
; N_BOLTS_0;
;
	lda     #$01
	sta     _c_max_bolts
;
; c_enems =   enems_0;
;
	lda     #<(_enems_0)
	sta     _c_enems
	lda     #>(_enems_0)
	sta     _c_enems+1
;
; c_hotspots =  hotspots_0;
;
	lda     #<(_hotspots_0)
	sta     _c_hotspots
	lda     #>(_hotspots_0)
	sta     _c_hotspots+1
;
; c_max_enems =  99;
;
	lda     #$63
	sta     _c_max_enems
;
; c_map_w = MAP_W;
;
	lda     #$04
	sta     _c_map_w
;
; c_map_h = MAP_H;
;
	lda     #$02
	sta     _c_map_h
;
; rda = c_map_h; c_map_size = 0; while (rda --) c_map_size += c_map_w;
;
	sta     _rda
	lda     #$00
L185F:	sta     _c_map_size
	lda     _rda
	pha
	sec
	sbc     #$01
	sta     _rda
	pla
	tax
	beq     L1547
	lda     _c_map_w
	clc
	adc     _c_map_size
	jmp     L185F
;
; pal_bg (c_pal_bg);
;
L1547:	lda     _c_pal_bg
	ldx     _c_pal_bg+1
	jsr     _pal_bg
;
; pal_spr (c_pal_fg);
;
	lda     _c_pal_fg
	ldx     _c_pal_fg+1
	jsr     _pal_spr
;
; cls ();
;
	jsr     _cls
;
; draw_game_frame ();
;
	jsr     _draw_game_frame
;
; hotspots_load ();
;
	jsr     _hotspots_load
;
; memfill (lkact, 1, c_max_bolts);
;
	jsr     decsp3
	lda     #<(_lkact)
	ldy     #$01
	sta     (sp),y
	iny
	lda     #>(_lkact)
	sta     (sp),y
	lda     #$01
	ldy     #$00
	sta     (sp),y
	lda     _c_max_bolts
	ldx     #$00
	jsr     _memfill
;
; if (!warp_to_level) {
;
	lda     _warp_to_level
	bne     L1556
;
; n_pant = SCR_INI;
;
	sta     _n_pant
;
; px = (4 + (PLAYER_INI_X << 4)) << FIXBITS;
;
	ldx     #$05
	sta     _px
	stx     _px+1
;
; py = (PLAYER_INI_Y << 4) << FIXBITS;
;
	ldx     #$0C
	sta     _py
	stx     _py+1
;
; player_to_pixels ();
;
L1556:	jsr     _player_to_pixels
;
; player_init ();
;
	jsr     _player_init
;
; pobjs = 0;
;
	lda     #$00
	sta     _pobjs
;
; pkeys = 0;
;
	sta     _pkeys
;
; half_life = 0;
;
	sta     _half_life
;
; frame_counter = 0;
;
	sta     _frame_counter
;
; olife = oammo = oobjs = okeys = 0xff;
;
	lda     #$FF
	sta     _okeys
	sta     _oobjs
	sta     _oammo
	sta     _olife
;
; okilled = 0xff;
;
	sta     _okilled
;
; pkeys=1;
;
	lda     #$01
	sta     _pkeys
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ prepare_scr (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_prepare_scr: near

.segment	"CODE"

;
; if (!ft) {
;
	lda     _ft
	bne     L1575
;
; fade_out (); 
;
	jsr     _fade_out
;
; } else {
;
	jmp     L1866
;
; ft = 0;
;
L1575:	lda     #$00
	sta     _ft
;
; ppu_off ();
;
L1866:	jsr     _ppu_off
;
; clear_update_list ();
;
	jsr     _clear_update_list
;
; enems_load ();
;
	jsr     _enems_load
;
; for (gpit = 0; gpit < 2; gpit ++) {
;
	lda     #$00
L186E:	sta     _gpit
	cmp     #$02
	jcs     L1580
;
; hotspots_create ();
;
	jsr     _hotspots_create
;
; hrx &= 0x00ff;
;
	lda     _hrx
	sta     _hrx
	lda     #$00
	sta     _hrx+1
;
; if (gpit) hrx |= 0x0100;
;
	lda     _gpit
	beq     L158A
	lda     _hrx
	sta     _hrx
	lda     _hrx+1
	ora     #$01
	sta     _hrx+1
;
; d_hrx [gpit] = hrx;
;
L158A:	ldx     #$00
	lda     _gpit
	asl     a
	bcc     L1867
	inx
	clc
L1867:	adc     #<(_d_hrx)
	sta     ptr1
	txa
	adc     #>(_d_hrx)
	sta     ptr1+1
	lda     _hrx
	ldy     #$00
	sta     (ptr1),y
	iny
	lda     _hrx+1
	sta     (ptr1),y
;
; d_hry [gpit] = hry;
;
	ldy     _gpit
	lda     _hry
	sta     _d_hry,y
;
; d_hrt [gpit] = hrt;
;
	ldy     _gpit
	lda     _hrt
	sta     _d_hrt,y
;
; *((unsigned char *) 0xfc + gpit*2) = MSB(d_hrx [gpit]);
;
	ldx     #$00
	lda     _gpit
	asl     a
	bcc     L1868
	inx
	clc
L1868:	adc     #$FC
	bcc     L159B
	inx
L159B:	jsr     pushax
	ldx     #$00
	lda     _gpit
	asl     a
	bcc     L1869
	inx
	clc
L1869:	adc     #<(_d_hrx)
	sta     ptr1
	txa
	adc     #>(_d_hrx)
	sta     ptr1+1
	ldy     #$01
	lda     (ptr1),y
	tax
	dey
	txa
	jsr     staspidx
;
; *((unsigned char *) 0xfd + gpit*2) = LSB(d_hrx [gpit]);
;
	ldx     #$00
	lda     _gpit
	asl     a
	bcc     L186A
	inx
	clc
L186A:	adc     #$FD
	bcc     L15A3
	inx
L15A3:	sta     sreg
	stx     sreg+1
	ldx     #$00
	lda     _gpit
	asl     a
	bcc     L186B
	inx
	clc
L186B:	adc     #<(_d_hrx)
	sta     ptr1
	txa
	adc     #>(_d_hrx)
	sta     ptr1+1
	ldy     #$00
	lda     (ptr1),y
	sta     (sreg),y
;
; for (gpit = 0; gpit < 2; gpit ++) {
;
	lda     _gpit
	clc
	adc     #$01
	jmp     L186E
;
; cocos_init ();
;
L1580:	jsr     _cocos_init
;
; draw_scr ();
;
	jsr     _draw_scr
;
; do_process_breakable = 0;
;
	lda     #$00
	sta     _do_process_breakable
;
; gpit = BREAKABLE_MAX; while (gpit --) brkf [gpit] = 0;
;
	lda     #$04
	sta     _gpit
L15AF:	lda     _gpit
	pha
	sec
	sbc     #$01
	sta     _gpit
	pla
	tax
	beq     L15B0
	ldy     _gpit
	lda     #$00
	sta     _brkf,y
	jmp     L15AF
;
; for (gpit = 0; gpit < MAX_BULLETS; gpit ++) {
;
L15B0:	sta     _gpit
	cmp     #$04
	bcs     L15B7
;
; b_slots [gpit] = gpit; by [gpit] = 0;
;
	ldy     _gpit
	lda     _gpit
	sta     _b_slots,y
	ldy     _gpit
	lda     #$00
	sta     _by,y
;
; for (gpit = 0; gpit < MAX_BULLETS; gpit ++) {
;
	lda     _gpit
	clc
	adc     #$01
	jmp     L15B0
;
; b_slots_i = MAX_BULLETS;
;
L15B7:	lda     #$04
	sta     _b_slots_i
;
; ppu_on_all ();
;
	jsr     _ppu_on_all
;
; gpit = 3; while (gpit --) en_spr_id [gpit] = en_s [gpit];
;
	lda     #$03
	sta     _gpit
L15CB:	lda     _gpit
	pha
	sec
	sbc     #$01
	sta     _gpit
	pla
	tax
	beq     L15CC
	lda     #<(_en_spr_id)
	ldx     #>(_en_spr_id)
	clc
	adc     _gpit
	bcc     L15D0
	inx
L15D0:	sta     ptr1
	stx     ptr1+1
	ldy     _gpit
	lda     _en_s,y
	ldy     #$00
	sta     (ptr1),y
	jmp     L15CB
;
; oam_index = 4;
;
L15CC:	lda     #$04
	sta     _oam_index
;
; prx = px >> FIXBITS; pry = py >> FIXBITS;
;
	lda     _px
	ldx     _px+1
	jsr     shrax4
	jsr     shrax2
	sta     _prx
	stx     _prx+1
	lda     _py
	ldx     _py+1
	jsr     asrax4
	jsr     asrax2
	sta     _pry
;
; player_move ();
;
	jsr     _player_move
;
; calc_scroll_pos ();
;
	jsr     _calc_scroll_pos
;
; enems_move ();
;
	jsr     _enems_move
;
; for (gpit = 0; gpit < 2; gpit ++)  {
;
	lda     #$00
L186F:	sta     _gpit
	cmp     #$02
	bcs     L15DE
;
; hrx = d_hrx [gpit];
;
	ldx     #$00
	lda     _gpit
	asl     a
	bcc     L186C
	inx
	clc
L186C:	adc     #<(_d_hrx)
	sta     ptr1
	txa
	adc     #>(_d_hrx)
	sta     ptr1+1
	ldy     #$01
	lda     (ptr1),y
	sta     _hrx+1
	dey
	lda     (ptr1),y
	sta     _hrx
;
; hrt = d_hrt [gpit];
;
	ldy     _gpit
	lda     _d_hrt,y
	sta     _hrt
;
; if (hrx < scroll_x || hrx > scroll_x + 240 || hrt == 0) continue;
;
	lda     _hrx
	cmp     _scroll_x
	lda     _hrx+1
	sbc     _scroll_x+1
	bcc     L15DF
	lda     _hrx
	ldx     _hrx+1
	jsr     pushax
	lda     _scroll_x
	ldx     _scroll_x+1
	clc
	adc     #$F0
	bcc     L15EE
	inx
L15EE:	jsr     tosicmp
	beq     L186D
	bcs     L15DF
L186D:	lda     _hrt
	beq     L15DF
;
; hry = d_hry [gpit];
;
	ldy     _gpit
	lda     _d_hry,y
	sta     _hry
;
; hotspots_paint ();
;
	jsr     _hotspots_paint
;
; for (gpit = 0; gpit < 2; gpit ++)  {
;
L15DF:	lda     _gpit
	clc
	adc     #$01
	jmp     L186F
;
; hud_update ();
;
L15DE:	jsr     _hud_update
;
; update_cycle ();
;
	jsr     _update_cycle
;
; fade_in ();
;
	jmp     _fade_in

.endproc

; ---------------------------------------------------------------
; void __near__ game_loop (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_game_loop: near

.segment	"CODE"

;
; music_play (MUSIC_INGAME);
;
	lda     #$00
	jsr     _music_play
;
; clear_update_list ();
;
	jsr     _clear_update_list
;
; set_vram_update (UPDATE_LIST_SIZE, update_list);
;
	lda     #$20
	jsr     pusha
	lda     #<(_update_list)
	ldx     #>(_update_list)
	jsr     _set_vram_update
;
; on_pant = 99; ft = 1; fade_delay = 1;
;
	lda     #$63
	sta     _on_pant
	lda     #$01
	sta     _ft
	sta     _fade_delay
;
; pal_bright (0);
;
	lda     #$00
	jsr     _pal_bright
;
; ppu_on_all ();
;
	jsr     _ppu_on_all
;
; ntsc_frame = level_reset = warp_to_level = 0; 
;
	lda     #$00
	sta     _warp_to_level
	sta     _level_reset
	sta     _ntsc_frame
;
; oam_index = 4; ticker = 50;
;
	lda     #$04
	sta     _oam_index
	lda     #$32
	sta     _ticker
;
; hud_update ();
;
L1610:	jsr     _hud_update
;
; if (pkill) player_kill ();
;
	lda     _pkill
	beq     L1614
	jsr     _player_kill
;
; if (game_over || level_reset) break;   
;
L1614:	lda     _game_over
	jne     L1611
	lda     _level_reset
	jne     L1611
;
; flick_override = 0;
;
	sta     _flick_override
;
; if (flick_override == 0) {
;
	lda     _flick_override
	bne     L161C
;
; flickscreen_do_horizontal ();
;
	jsr     _flickscreen_do_horizontal
;
; flickscreen_do_vertical ();
;
	jsr     _flickscreen_do_vertical
;
; if (on_pant != n_pant) {
;
L161C:	lda     _n_pant
	cmp     _on_pant
	beq     L1620
;
; prepare_scr ();
;
	jsr     _prepare_scr
;
; on_pant = n_pant;
;
	lda     _n_pant
	sta     _on_pant
;
; if (pmayneedrelocation) {
;
L1620:	lda     _pmayneedrelocation
	jeq     L1625
;
; pmayneedrelocation = 0;
;
	lda     #$00
	sta     _pmayneedrelocation
;
; gpit = 16;
;
	lda     #$10
	sta     _gpit
;
; while (gpit --) {
;
L162B:	lda     _gpit
	pha
	sec
	sbc     #$01
	sta     _gpit
	pla
	tax
	beq     L162C
;
; cx1 = prx >> 4; cx2 = (prx + 7) >> 4;
;
	lda     _prx
	ldx     _prx+1
	jsr     shrax4
	sta     _cx1
	lda     _prx
	ldx     _prx+1
	clc
	adc     #$07
	bcc     L1633
	inx
L1633:	jsr     shrax4
	sta     _cx2
;
; cy1 = cy2 = (pry + 15) >> 4;
;
	ldx     #$00
	lda     _pry
	clc
	adc     #$0F
	bcc     L1638
	inx
L1638:	jsr     shrax4
	sta     _cy2
	sta     _cy1
;
; cm_two_points ();
;
	jsr     _cm_two_points
;
; if ((at1 & 8) == 0 && (at2 & 8) == 0) break;
;
	lda     _at1
	and     #$08
	bne     L163A
	lda     _at2
	and     #$08
	beq     L162C
;
; prx += 16; // Try next cell
;
L163A:	lda     #$10
	clc
	adc     _prx
	sta     _prx
	bcc     L162B
	inc     _prx+1
;
; }
;
	jmp     L162B
;
; px = prx << FIXBITS;
;
L162C:	lda     _prx
	ldx     _prx+1
	jsr     shlax4
	jsr     shlax2
	sta     _px
	stx     _px+1
;
; if (shaker_ct) {
;
L1625:	lda     _shaker_ct
	beq     L1651
;
; -- shaker_ct;
;
	dec     _shaker_ct
;
; scroll (254 + (rand8 () & 3), SCROLL_Y - 2 + (rand8 () & 3));
;
	jsr     _rand8
	ldx     #$00
	and     #$03
	clc
	adc     #$FE
	bcc     L164D
	inx
L164D:	jsr     pushax
	jsr     _rand8
	ldx     #$00
	and     #$03
	clc
	adc     #$06
	bcc     L1650
	inx
L1650:	jsr     _scroll
;
; if (shaker_ct == 0) scroll (0, SCROLL_Y);
;
	lda     _shaker_ct
	bne     L1651
	jsr     push0
	lda     #$08
	jsr     _scroll
;
; update_cycle ();
;
L1651:	jsr     _update_cycle
;
; pad_read ();
;
	jsr     _pad_read
;
; a_button = (pad_this_frame & PAD_A);
;
	lda     _pad_this_frame
	and     #$01
	sta     _a_button
;
; b_button = (pad_this_frame & PAD_B);
;
	lda     _pad_this_frame
	and     #$02
	sta     _b_button
;
; ntsc_frame ++; if (ntsc_frame == 6) ntsc_frame = 0;
;
	lda     _ntsc_frame
	clc
	adc     #$01
	sta     _ntsc_frame
	cmp     #$06
	bne     L165F
	lda     #$00
	sta     _ntsc_frame
;
; if (paused == 0 && (ntsc == 0 || ntsc_frame)) {
;
L165F:	lda     _paused
	jne     L1720
	lda     _ntsc
	beq     L1664
	lda     _ntsc_frame
	jeq     L1720
;
; if (ticker) -- ticker; else ticker = 50;
;
L1664:	lda     _ticker
	beq     L1669
	dec     _ticker
	jmp     L166C
L1669:	lda     #$32
	sta     _ticker
;
; half_life ^= 1;
;
L166C:	lda     _half_life
	eor     #$01
	sta     _half_life
;
; ++ frame_counter;
;
	inc     _frame_counter
;
; for (gpit = 0; gpit < 2; gpit ++)  {
;
	lda     #$00
L1880:	sta     _gpit
	cmp     #$02
	jcs     L1673
;
; hrx = d_hrx [gpit];
;
	ldx     #$00
	lda     _gpit
	asl     a
	bcc     L1879
	inx
	clc
L1879:	adc     #<(_d_hrx)
	sta     ptr1
	txa
	adc     #>(_d_hrx)
	sta     ptr1+1
	ldy     #$01
	lda     (ptr1),y
	sta     _hrx+1
	dey
	lda     (ptr1),y
	sta     _hrx
;
; hrt = d_hrt [gpit];
;
	ldy     _gpit
	lda     _d_hrt,y
	sta     _hrt
;
; if (hrx < scroll_x || hrx > scroll_x + 240 || hrt == 0) continue;
;
	lda     _hrx
	cmp     _scroll_x
	lda     _hrx+1
	sbc     _scroll_x+1
	jcc     L1674
	lda     _hrx
	ldx     _hrx+1
	jsr     pushax
	lda     _scroll_x
	ldx     _scroll_x+1
	clc
	adc     #$F0
	bcc     L1683
	inx
L1683:	jsr     tosicmp
	beq     L187E
	jcs     L1674
L187E:	lda     _hrt
	jeq     L1674
;
; hry = d_hry [gpit];
;
	ldy     _gpit
	lda     _d_hry,y
	sta     _hry
;
; if (hrt) {
;
	lda     _hrt
	jeq     L1704
;
; prx + 4 >= hrx && 
;
	lda     _prx
	ldx     _prx+1
	clc
	adc     #$04
	bcc     L168D
	inx
L168D:	cmp     _hrx
	txa
	sbc     _hrx+1
	jcc     L1704
;
; prx <= hrx + 11 &&
;
	lda     _prx
	ldx     _prx+1
	jsr     pushax
	lda     _hrx
	ldx     _hrx+1
	clc
	adc     #$0B
	bcc     L168F
	inx
L168F:	jsr     tosicmp
	beq     L187F
	jcs     L1704
;
; pry + 8 >= hry && 
;
L187F:	ldx     #$00
	lda     _pry
	clc
	adc     #$08
	bcc     L1690
	inx
L1690:	cmp     _hry
	txa
	sbc     #$00
	jcc     L1704
;
; pry <= hry + 7
;
	lda     _pry
	jsr     pusha0
	lda     _hry
;
; ) {
;
	clc
	adc     #$07
	bcc     L1691
	ldx     #$01
L1691:	jsr     tosicmp
	bcc     L168C
	jne     L1704
;
; opinv = pinv;
;
L168C:	lda     _pinv
	sta     _opinv
;
; if (hrt == HS_OBJ_EMPTY) {
;
	lda     _hrt
	cmp     #$04
	bne     L1695
;
; if (b_button) 
;
	lda     _b_button
	jeq     L16F9
;
; hrt = ht [HS_CUR_PANT] = pinv;
;
	ldx     #$00
	lda     _n_pant
	clc
	adc     _gpit
	bcc     L187A
	inx
	clc
L187A:	adc     #<(_ht)
	sta     ptr1
	txa
	adc     #>(_ht)
	sta     ptr1+1
	lda     _pinv
	ldy     #$00
	sta     (ptr1),y
	sta     _hrt
;
; pinv = HS_OBJ_EMPTY;
;
	lda     #$04
	sta     _pinv
;
; b_button = 0;
;
	sty     _b_button
;
; sfx_play (SFX_TILE, 1);
;
	lda     #$01
	jsr     pusha
	jsr     _sfx_play
;
; } else if (hrt >= HS_OBJ_MIN && hrt <= HS_OBJ_MAX) {
;
	jmp     L16F9
L1695:	lda     _hrt
	cmp     #$05
	bcc     L16A6
	lda     _hrt
	cmp     #$07
	bcs     L16A6
;
; if (b_button) 
;
	lda     _b_button
	jeq     L16F9
;
; rda = hrt;
;
	lda     _hrt
	sta     _rda
;
; hrt = ht [HS_CUR_PANT] = pinv;
;
	ldx     #$00
	lda     _n_pant
	clc
	adc     _gpit
	bcc     L187B
	inx
	clc
L187B:	adc     #<(_ht)
	sta     ptr1
	txa
	adc     #>(_ht)
	sta     ptr1+1
	lda     _pinv
	ldy     #$00
	sta     (ptr1),y
	sta     _hrt
;
; pinv = rda;
;
	lda     _rda
	sta     _pinv
;
; b_button = 0;
;
	sty     _b_button
;
; sfx_play (SFX_OBJECT, 1);
;
	lda     #$02
	jsr     pusha
	lda     #$01
	jsr     _sfx_play
;
; } else if (hrt >= HS_OBJ_MIN + HS_USE_OFFS && hrt <= HS_OBJ_MAX + HS_USE_OFFS) {
;
	jmp     L16F9
L16A6:	lda     _hrt
	cmp     #$07
	jcc     L16BB
	lda     _hrt
	cmp     #$09
	bcs     L16BB
;
; if (b_button) 
;
	lda     _b_button
	jeq     L16F9
;
; if (pinv == hrt - HS_USE_OFFS) {
;
	ldx     #$00
	lda     _hrt
	sec
	sbc     #$02
	bcs     L16C3
	dex
L16C3:	cpx     #$00
	jne     L16F9
	cmp     _pinv
	jne     L16F9
;
; rda = pinv;
;
	lda     _pinv
	sta     _rda
;
; rdb = hrt;
;
	lda     _hrt
	sta     _rdb
;
; hrt = ht [HS_CUR_PANT] = pinv + 2*HS_USE_OFFS;
;
	lda     _n_pant
	clc
	adc     _gpit
	bcc     L187C
	inx
	clc
L187C:	adc     #<(_ht)
	sta     ptr1
	txa
	adc     #>(_ht)
	sta     ptr1+1
	lda     _pinv
	clc
	adc     #$04
	ldy     #$00
	sta     (ptr1),y
	sta     _hrt
;
; pinv = HS_OBJ_EMPTY;
;
	lda     #$04
	sta     _pinv
;
; ht [4] == 5 + 2*HS_USE_OFFS && 
;
	lda     _ht+4
	cmp     #$09
	bne     L16D4
;
; ht [5] == 6 + 2*HS_USE_OFFS
;
	lda     _ht+5
;
; );
;
	cmp     #$0A
	beq     L16D2
L16D4:	tya
	jmp     L16D6
L16D2:	lda     #$01
L16D6:	sta     _win_level
;
; b_button = 0;
;
	sty     _b_button
;
; sfx_play (SFX_USE, 1);
;
	lda     #$03
	jsr     pusha
	lda     #$01
	jsr     _sfx_play
;
; else if (hrt >= HS_OBJ_MIN + 2*HS_USE_OFFS && hrt <= HS_OBJ_MAX + 2*HS_USE_OFFS) {
;
	jmp     L16F9
L16BB:	lda     _hrt
	cmp     #$09
	bcc     L16DD
	lda     _hrt
	cmp     #$0B
	bcs     L16DD
;
; if (b_button) 
;
	lda     _b_button
	beq     L16F9
;
; else
;
	jmp     L16F9
;
; rda = 0;
;
L16DD:	lda     #$00
	sta     _rda
;
; switch (hrt) {
;
	lda     _hrt
;
; }
;
	cmp     #$01
	beq     L16EA
	cmp     #$02
	beq     L16EF
	cmp     #$03
	beq     L16F4
	jmp     L16E8
;
; ++ pobjs;
;
L16EA:	inc     _pobjs
;
; rda = SFX_OBJECT;
;
	lda     #$02
;
; break;
;
	jmp     L1878
;
; ++ pkeys;
;
L16EF:	inc     _pkeys
;
; break;
;
	jmp     L1878
;
; plife += PLAYER_REFILL;
;
L16F4:	inc     _plife
;
; rda = SFX_USE;
;
L1878:	sta     _rda
;
; if (rda) {
;
L16E8:	lda     _rda
	beq     L16F9
;
; sfx_play (rda, 1);
;
	lda     _rda
	jsr     pusha
	lda     #$01
	jsr     _sfx_play
;
; hrt = 0;
;
	lda     #$00
	sta     _hrt
;
; hact [HS_CUR_PANT] = 0;
;
	tax
	lda     _n_pant
	clc
	adc     _gpit
	bcc     L187D
	inx
	clc
L187D:	adc     #<(_hact)
	sta     ptr1
	txa
	adc     #>(_hact)
	sta     ptr1+1
	lda     #$00
	tay
	sta     (ptr1),y
;
; if (opinv != pinv) {
;
L16F9:	lda     _pinv
	cmp     _opinv
	jsr     boolne
;
; hotspots_paint ();
;
L1704:	jsr     _hotspots_paint
;
; d_hrt [gpit] = hrt;
;
	ldy     _gpit
	lda     _hrt
	sta     _d_hrt,y
;
; for (gpit = 0; gpit < 2; gpit ++)  {
;
L1674:	lda     _gpit
	clc
	adc     #$01
	jmp     L1880
;
; if (!warp_to_level) {
;
L1673:	lda     _warp_to_level
	bne     L170B
;
; player_move ();
;
	jsr     _player_move
;
; calc_scroll_pos ();
;
L170B:	jsr     _calc_scroll_pos
;
; ) {
;
	lda     _win_level
	beq     L170F
;
; music_stop ();
;
	jsr     _music_stop
;
; delay (50);
;
	lda     #$32
	jsr     _delay
;
; break;
;
	jmp     L1611
;
; bullets_move ();
;
L170F:	jsr     _bullets_move
;
; oam_index_player = oam_index; 
;
	lda     _oam_index
	sta     _oam_index_player
;
; if (!warp_to_level) player_render ();
;
	lda     _warp_to_level
	bne     L1717
	jsr     _player_render
;
; enems_move ();
;
L1717:	jsr     _enems_move
;
; cocos_do ();
;
	jsr     _cocos_do
;
; if (warp_to_level) {
;
	lda     _warp_to_level
	beq     L171C
;
; update_cycle (); music_stop (); break;
;
	jsr     _update_cycle
	jsr     _music_stop
	jmp     L1611
;
; if (do_process_breakable) breakable_do_anim ();
;
L171C:	lda     _do_process_breakable
	beq     L1720
	jsr     _breakable_do_anim
;
; if ((pad0 & (PAD_B|PAD_SELECT|PAD_UP)) == (PAD_B|PAD_SELECT|PAD_UP)) break;
;
L1720:	lda     _pad0
	and     #$16
	cmp     #$16
	beq     L1611
;
; if (pad_this_frame & PAD_START) {
;
	lda     _pad_this_frame
	and     #$08
	jeq     L1610
;
; paused ^= 1;
;
	lda     _paused
	eor     #$01
	sta     _paused
;
; pal_bright (4 - paused);
;
	lda     #$04
	sec
	sbc     _paused
	jsr     _pal_bright
;
; music_pause (paused);
;
	lda     _paused
	jsr     _music_pause
;
; }
;
	jmp     L1610
;
; fade_delay = 4;
;
L1611:	lda     #$04
	sta     _fade_delay
;
; music_stop ();
;
	jsr     _music_stop
;
; fade_out ();
;
	jsr     _fade_out
;
; set_vram_update (0, 0);
;
	lda     #$00
	jsr     pusha
	tax
	jsr     _set_vram_update
;
; ppu_off ();
;
	jsr     _ppu_off
;
; oam_clear ();
;
	jmp     _oam_clear

.endproc

; ---------------------------------------------------------------
; void __near__ main (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_main: near

.segment	"CODE"

;
; bank_spr (1);
;
	lda     #$01
	jsr     _bank_spr
;
; bank_bg (0);
;
	lda     #$00
	jsr     _bank_bg
;
; ppu_off ();
;
	jsr     _ppu_off
;
; first_game = 1;
;
	lda     #$01
	sta     _first_game
;
; ntsc = ppu_system ();
;
	jsr     _ppu_system
	sta     _ntsc
;
; plife = PLAYER_LIFE;
;
L1744:	lda     #$05
	sta     _plife
;
; scroll (0, SCROLL_Y);
;
	jsr     push0
	lda     #$08
	jsr     _scroll
;
; game_init (); 
;
	jsr     _game_init
;
; game_loop ();
;
	jsr     _game_loop
;
; first_game = 0;
;
	lda     #$00
	sta     _first_game
;
; }
;
	jmp     L1744

.endproc

